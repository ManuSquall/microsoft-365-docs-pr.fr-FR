---
title: Faire pivoter ou faire pivoter une clé client ou une clé de disponibilité
ms.author: krowley
author: kccross
manager: laurawi
ms.date: 02/05/2020
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.collection:
- M365-security-compliance
description: Découvrez comment déployer les clés racines du client stockées dans le coffre-fort de clés Azure qui sont utilisées avec la clé client Office 365. Les services incluent les fichiers Exchange Online, Skype entreprise, SharePoint Online, OneDrive entreprise et Teams.
ms.openlocfilehash: 9699960666eaa9aa62bb027d3a4549cb50cd52e3
ms.sourcegitcommit: 5ff1dc62e8855be155cb2de45cf4ee5a02c321fd
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/06/2020
ms.locfileid: "41804784"
---
# <a name="roll-or-rotate-a-customer-key-or-an-availability-key"></a><span data-ttu-id="24a78-104">Faire pivoter ou faire pivoter une clé client ou une clé de disponibilité</span><span class="sxs-lookup"><span data-stu-id="24a78-104">Roll or rotate a Customer Key or an availability key</span></span>

> [!CAUTION]
> <span data-ttu-id="24a78-105">Ne faites appel qu’à une clé de chiffrement que vous utilisez avec la clé client lorsque vos exigences en matière de sécurité ou de conformité vous obligent à lancer la clé.</span><span class="sxs-lookup"><span data-stu-id="24a78-105">Only roll an encryption key that you use with Customer Key when your security or compliance requirements dictate that you must roll the key.</span></span> <span data-ttu-id="24a78-106">En outre, ne supprimez pas de clés qui sont ou n’ont pas été associées à des stratégies.</span><span class="sxs-lookup"><span data-stu-id="24a78-106">In addition, do not delete any keys that are or were associated with policies.</span></span> <span data-ttu-id="24a78-107">Lorsque vous restaurez vos clés, le contenu est chiffré avec les clés précédentes.</span><span class="sxs-lookup"><span data-stu-id="24a78-107">When you roll your keys, there will be content encrypted with the previous keys.</span></span> <span data-ttu-id="24a78-108">Par exemple, bien que les boîtes aux lettres actives soient rechiffrées fréquemment, les boîtes aux lettres inactives, déconnectées et désactivées peuvent toujours être chiffrées avec les clés précédentes.</span><span class="sxs-lookup"><span data-stu-id="24a78-108">For example, while active mailboxes will be re-encrypted frequently, inactive, disconnected, and disabled mailboxes may still be encrypted with the previous keys.</span></span> <span data-ttu-id="24a78-109">SharePoint Online effectue des sauvegardes de contenu à des fins de restauration et de récupération, de sorte qu’il peut toujours y avoir un archivage de contenu à l’aide de clés plus anciennes.</span><span class="sxs-lookup"><span data-stu-id="24a78-109">SharePoint Online performs backup of content for restore and recovery purposes, so there may still be archived content using older keys.</span></span>

## <a name="about-rolling-the-availability-key"></a><span data-ttu-id="24a78-110">À propos du déroulement de la clé de disponibilité</span><span class="sxs-lookup"><span data-stu-id="24a78-110">About rolling the availability key</span></span>

<span data-ttu-id="24a78-111">Microsoft n’expose pas le contrôle direct de la clé de disponibilité aux clients.</span><span class="sxs-lookup"><span data-stu-id="24a78-111">Microsoft does not expose direct control of the availability key to customers.</span></span> <span data-ttu-id="24a78-112">Par exemple, vous pouvez uniquement faire pivoter les touches dont vous êtes propriétaire dans le coffre de clés Azure.</span><span class="sxs-lookup"><span data-stu-id="24a78-112">For example, you can only roll (rotate) the keys that you own in Azure Key Vault.</span></span> <span data-ttu-id="24a78-113">Office 365 annule les clés de disponibilité selon un planning défini en interne.</span><span class="sxs-lookup"><span data-stu-id="24a78-113">Office 365 rolls the availability keys on an internally-defined schedule.</span></span> <span data-ttu-id="24a78-114">Il n’existe aucun contrat de niveau de service (SLA) orienté vers le client pour ces rouleaux clés.</span><span class="sxs-lookup"><span data-stu-id="24a78-114">There is no customer-facing, service-level agreement (SLA) for these key rolls.</span></span> <span data-ttu-id="24a78-115">Office 365 fait pivoter la clé de disponibilité à l’aide du code de service Office 365 dans un processus automatisé, non manuel.</span><span class="sxs-lookup"><span data-stu-id="24a78-115">Office 365 rotates the availability key using Office 365 service code in an automated, non-manual process.</span></span> <span data-ttu-id="24a78-116">Les administrateurs Microsoft peuvent lancer le processus de déploiement.</span><span class="sxs-lookup"><span data-stu-id="24a78-116">Microsoft administrators may initiate the roll process.</span></span> <span data-ttu-id="24a78-117">La clé est déployée à l’aide de mécanismes automatisés sans accès direct au magasin de clés.</span><span class="sxs-lookup"><span data-stu-id="24a78-117">The key is rolled using automated mechanisms without direct access to the key store.</span></span> <span data-ttu-id="24a78-118">L’accès au magasin secret clé de disponibilité n’est pas approvisionné aux administrateurs Microsoft.</span><span class="sxs-lookup"><span data-stu-id="24a78-118">Access to the availability key secret store is not provisioned to Microsoft administrators.</span></span> <span data-ttu-id="24a78-119">Le laminage de clé de disponibilité exploite le même mécanisme que celui utilisé pour générer initialement la clé.</span><span class="sxs-lookup"><span data-stu-id="24a78-119">Availability key rolling leverages the same mechanism used to initially generate the key.</span></span> <span data-ttu-id="24a78-120">Pour plus d’informations sur la clé de disponibilité, voir [comprendre la clé de disponibilité](customer-key-availability-key-understand.md).</span><span class="sxs-lookup"><span data-stu-id="24a78-120">For more information about the availability key, see [Understand the availability key](customer-key-availability-key-understand.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="24a78-121">Les clés de disponibilité Exchange Online et Skype entreprise peuvent être déployées de manière efficace par les clients qui créent une nouvelle DEP, étant donné qu’une clé de disponibilité unique est générée pour chaque DEP que vous créez.</span><span class="sxs-lookup"><span data-stu-id="24a78-121">Exchange Online and Skype for Business availability keys can be effectively rolled by customers creating a new DEP, since a unique availability key is generated for each DEP you create.</span></span> <span data-ttu-id="24a78-122">Les clés de disponibilité pour SharePoint Online, OneDrive entreprise et les fichiers teams existent au niveau de la forêt et sont partagées entre DEPs et les clients, ce qui signifie que le déploiement se produit uniquement sur une planification définie de manière interne par Microsoft.</span><span class="sxs-lookup"><span data-stu-id="24a78-122">Availability keys for SharePoint Online, OneDrive for Business, and Teams files exist at the forest level and are shared across DEPs and customers, which means rolling only occurs at a Microsoft internally defined schedule.</span></span> <span data-ttu-id="24a78-123">Pour limiter les risques de non-déploiement de la clé de disponibilité chaque fois qu’une nouvelle DEP est créée, SharePoint, OneDrive et teams retournent la clé intermédiaire client (TIK), la clé incluse dans les clés racines du client et la clé de disponibilité, chaque fois qu’une nouvelle DEP est créée.</span><span class="sxs-lookup"><span data-stu-id="24a78-123">To mitigate the risk of not rolling the availability key each time a new DEP is created, SharePoint, OneDrive, and Teams roll the tenant intermediate key (TIK), the key wrapped by the customer root keys and availability key, each time a new DEP is created.</span></span>

## <a name="request-a-new-version-of-each-existing-root-key-you-want-to-roll"></a><span data-ttu-id="24a78-124">Demander une nouvelle version de chaque clé racine existante à effectuer</span><span class="sxs-lookup"><span data-stu-id="24a78-124">Request a new version of each existing root key you want to roll</span></span>

<span data-ttu-id="24a78-125">Lorsque vous restaurez une clé, vous demandez une nouvelle version d’une clé existante.</span><span class="sxs-lookup"><span data-stu-id="24a78-125">When you roll a key, you request a new version of an existing key.</span></span> <span data-ttu-id="24a78-126">Pour demander une nouvelle version d’une clé existante, vous utilisez la même cmdlet, [Add-AzKeyVaultKey](https://docs.microsoft.com/powershell/module/az.keyvault/add-azkeyvaultkey), avec la même syntaxe que celle que vous avez utilisée pour créer la clé.</span><span class="sxs-lookup"><span data-stu-id="24a78-126">To request a new version of an existing key, you use the same cmdlet, [Add-AzKeyVaultKey](https://docs.microsoft.com/powershell/module/az.keyvault/add-azkeyvaultkey), with the same syntax that you used to create the key in the first place.</span></span> <span data-ttu-id="24a78-127">Une fois que vous avez terminé de lancer une clé associée à une stratégie de chiffrement de données (DEP), vous exécutez une autre cmdlet pour vous assurer que la clé client commence à utiliser la nouvelle clé.</span><span class="sxs-lookup"><span data-stu-id="24a78-127">After you’ve finished rolling any key associated with a Data Encryption Policy (DEP), you run another cmdlet to ensure that Customer Key begins using the new key.</span></span> <span data-ttu-id="24a78-128">Effectuez cette étape dans chaque coffre-fort de clés Azure (AKV).</span><span class="sxs-lookup"><span data-stu-id="24a78-128">Do this step in each Azure Key Vault (AKV).</span></span>

<span data-ttu-id="24a78-129">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="24a78-129">For example:</span></span>

1. <span data-ttu-id="24a78-130">Connectez-vous à votre abonnement Azure avec Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="24a78-130">Sign in to your Azure subscription with Azure PowerShell.</span></span> <span data-ttu-id="24a78-131">Pour obtenir des instructions, consultez la rubrique [se connecter avec Azure PowerShell](https://docs.microsoft.com/powershell/azure/authenticate-azureps).</span><span class="sxs-lookup"><span data-stu-id="24a78-131">For instructions, see [Sign in with Azure PowerShell](https://docs.microsoft.com/powershell/azure/authenticate-azureps).</span></span>

2. <span data-ttu-id="24a78-132">Exécutez l’applet de commande Add-AzKeyVaultKey comme indiqué dans l’exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="24a78-132">Run the Add-AzKeyVaultKey cmdlet as shown in the following example:</span></span>

   ```powershell
   Add-AzKeyVaultKey -VaultName Contoso-O365EX-NA-VaultA1 -Name Contoso-O365EX-NA-VaultA1-Key001 -Destination HSM -KeyOps @('wrapKey','unwrapKey') -NotBefore (Get-Date -Date "12/27/2016 12:01 AM")
   ```

   <span data-ttu-id="24a78-133">Dans cet exemple, étant donné qu’une clé nommée **contoso-O365EX-na-VaultA1-Key001** existe dans la chambre forte de **contoso-O365EX-na-VaultA1** , l’applet de commande crée une nouvelle version de la clé.</span><span class="sxs-lookup"><span data-stu-id="24a78-133">In this example, since a key named **Contoso-O365EX-NA-VaultA1-Key001** exists in the **Contoso-O365EX-NA-VaultA1** vault, the cmdlet creates a new version of the key.</span></span> <span data-ttu-id="24a78-134">Cette opération conserve les versions de clés précédentes dans l’historique des versions de la clé.</span><span class="sxs-lookup"><span data-stu-id="24a78-134">This operation preserves the previous key versions in the version history for the key.</span></span> <span data-ttu-id="24a78-135">Vous avez besoin de la version précédente de la clé pour déchiffrer les données qu’elle chiffre encore.</span><span class="sxs-lookup"><span data-stu-id="24a78-135">You need the previous key version to decrypt the data that it still encrypts.</span></span> <span data-ttu-id="24a78-136">Une fois que vous avez terminé le lancement de n’importe quelle clé associée à une DEP, exécutez une applet de commande supplémentaire afin de vous assurer que la clé client commence à utiliser la nouvelle clé.</span><span class="sxs-lookup"><span data-stu-id="24a78-136">Once you complete rolling any key associated with a DEP,  run an extra cmdlet to ensure that Customer Key begins using the new key.</span></span> <span data-ttu-id="24a78-137">Les sections suivantes décrivent les applets de commande plus en détail.</span><span class="sxs-lookup"><span data-stu-id="24a78-137">The following sections describe the cmdlets in more detail.</span></span>
  
## <a name="update-the-customer-key-for-exchange-online-and-skype-for-business"></a><span data-ttu-id="24a78-138">Mettre à jour la clé client pour Exchange Online et Skype entreprise</span><span class="sxs-lookup"><span data-stu-id="24a78-138">Update the Customer Key for Exchange Online and Skype for Business</span></span>

<span data-ttu-id="24a78-139">Lorsque vous déployez l’une des clés Azure Key Vault associées à une DEP utilisée avec Exchange Online et Skype entreprise, vous devez mettre à jour la DEP pour qu’elle pointe vers la nouvelle clé.</span><span class="sxs-lookup"><span data-stu-id="24a78-139">When you roll either of the Azure Key Vault keys associated with a DEP used with Exchange Online and Skype for Business, you must update the DEP to point to the new key.</span></span> <span data-ttu-id="24a78-140">Cette opération ne fait pas pivoter la clé de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="24a78-140">This does not rotate the availability key.</span></span>

<span data-ttu-id="24a78-141">Pour indiquer à la clé du client d’utiliser la nouvelle clé pour chiffrer les boîtes aux lettres dans Office 365 exécutez la cmdlet Set-DataEncryptionPolicy comme suit :</span><span class="sxs-lookup"><span data-stu-id="24a78-141">To instruct Customer Key to use the new key to encrypt mailboxes in Office 365 run the Set-DataEncryptionPolicy cmdlet as follows:</span></span>

1. <span data-ttu-id="24a78-142">Exécutez la cmdlet Set-DataEncryptionPolicy dans Azure PowerShell :</span><span class="sxs-lookup"><span data-stu-id="24a78-142">Run the Set-DataEncryptionPolicy cmdlet in Azure PowerShell:</span></span>
  
   ```powershell
   Set-DataEncryptionPolicy -Identity <DataEncryptionPolicyID> -Refresh
   ```

   <span data-ttu-id="24a78-143">Dans les 72 heures, les boîtes aux lettres actives associées à cette DEP deviennent chiffrées à l’aide de la nouvelle clé.</span><span class="sxs-lookup"><span data-stu-id="24a78-143">Within 72 hours, the active mailboxes associated with this DEP become encrypted with the new key.</span></span>

2. <span data-ttu-id="24a78-144">Pour vérifier la valeur de la propriété DataEncryptionPolicyID de la boîte aux lettres, suivez les étapes décrites dans la procédure [déterminer la DEP attribuée à une boîte aux lettres](customer-key-manage.md#determine-the-dep-assigned-to-a-mailbox).</span><span class="sxs-lookup"><span data-stu-id="24a78-144">To check the value for the DataEncryptionPolicyID property for the mailbox, use the steps in [Determine the DEP assigned to a mailbox](customer-key-manage.md#determine-the-dep-assigned-to-a-mailbox).</span></span> <span data-ttu-id="24a78-145">La valeur de cette propriété change une fois que le service applique la clé mise à jour.</span><span class="sxs-lookup"><span data-stu-id="24a78-145">The value for this property changes once the service applies the updated key.</span></span>
  
## <a name="update-the-customer-key-for-sharepointonlineonedriveforbusinessandteamsfiles"></a><span data-ttu-id="24a78-146">Mettre à jour la clé client pour les fichiers SharePoint Online, OneDrive entreprise et Teams</span><span class="sxs-lookup"><span data-stu-id="24a78-146">Update the Customer Key for SharePoint Online, OneDrive for Business, and Teams files</span></span>

<span data-ttu-id="24a78-147">SharePoint Online ne vous permet d’appliquer qu’une seule touche à la fois.</span><span class="sxs-lookup"><span data-stu-id="24a78-147">SharePoint Online only allows you to roll one key at a time.</span></span> <span data-ttu-id="24a78-148">Si vous souhaitez exécuter les deux clés dans un coffre-fort de clés, attendez que la première opération se termine.</span><span class="sxs-lookup"><span data-stu-id="24a78-148">If you want to roll both keys in a key vault, wait for the first operation to complete.</span></span> <span data-ttu-id="24a78-149">Microsoft vous recommande d’échelonner vos opérations pour éviter ce problème.</span><span class="sxs-lookup"><span data-stu-id="24a78-149">Microsoft recommends that you stagger your operations to avoid this issue.</span></span> <span data-ttu-id="24a78-150">Lorsque vous déployez l’une des clés Azure Key Vault associées à une DEP utilisée avec SharePoint Online et OneDrive entreprise, vous devez mettre à jour la DEP pour qu’elle pointe vers la nouvelle clé.</span><span class="sxs-lookup"><span data-stu-id="24a78-150">When you roll either of the Azure Key Vault keys associated with a DEP used with SharePoint Online and OneDrive for Business, you must update the DEP to point to the new key.</span></span> <span data-ttu-id="24a78-151">Cette opération ne fait pas pivoter la clé de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="24a78-151">This does not rotate the availability key.</span></span>

1. <span data-ttu-id="24a78-152">Exécutez la cmdlet Update-SPODataEncryptionPolicy comme suit :</span><span class="sxs-lookup"><span data-stu-id="24a78-152">Run the Update-SPODataEncryptionPolicy cmdlet as follows:</span></span>
  
   ```powershell
   Update-SPODataEncryptionPolicy -Identity <SPOAdminSiteUrl> -KeyVaultName <ReplacementKeyVaultName> -KeyName <ReplacementKeyName> -KeyVersion <ReplacementKeyVersion> -KeyType <Primary | Secondary>
   ```

   <span data-ttu-id="24a78-153">Bien que cette applet de commande démarre l’opération de roulis clés pour SharePoint Online et OneDrive entreprise, l’action ne s’exécute pas immédiatement.</span><span class="sxs-lookup"><span data-stu-id="24a78-153">While this cmdlet starts the key roll operation for SharePoint Online and OneDrive for Business, the action doesn't complete immediately.</span></span>

2. <span data-ttu-id="24a78-154">Pour voir la progression de l’opération de la séquence de touches, exécutez la cmdlet Get-SPODataEncryptionPolicy comme suit :</span><span class="sxs-lookup"><span data-stu-id="24a78-154">To see the progress of the key roll operation, run the Get-SPODataEncryptionPolicy cmdlet as follows:</span></span>

   ```powershell
   Get-SPODataEncryptionPolicy -Identity <SPOAdminSiteUrl>
   ```

## <a name="related-articles"></a><span data-ttu-id="24a78-155">Articles connexes</span><span class="sxs-lookup"><span data-stu-id="24a78-155">Related articles</span></span>

- [<span data-ttu-id="24a78-156">Chiffrement de service avec la clé client pour Office 365</span><span class="sxs-lookup"><span data-stu-id="24a78-156">Service encryption with Customer Key for Office 365</span></span>](customer-key-overview.md)

- [<span data-ttu-id="24a78-157">Configurer la clé client pour Office 365</span><span class="sxs-lookup"><span data-stu-id="24a78-157">Set up Customer Key for Office 365</span></span>](customer-key-set-up.md)

- [<span data-ttu-id="24a78-158">Gérer la clé client pour Office 365</span><span class="sxs-lookup"><span data-stu-id="24a78-158">Manage Customer Key for Office 365</span></span>](customer-key-manage.md)

- [<span data-ttu-id="24a78-159">En savoir plus sur la clé de disponibilité</span><span class="sxs-lookup"><span data-stu-id="24a78-159">Learn about the availability key</span></span>](customer-key-availability-key-understand.md)
