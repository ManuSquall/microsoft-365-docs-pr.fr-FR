---
title: Configuration de stratégies anti-programme malveillant
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.assetid: b0cfc21f-e3c6-41b6-8670-feb2b2e252e5
ms.collection:
- M365-security-compliance
- m365initiative-defender-office365
description: Les administrateurs peuvent apprendre à afficher, créer, modifier et supprimer des stratégies de protection contre les programmes malveillants dans Exchange Online Protection (EOP).
ms.custom: seo-marvel-apr2020
ms.openlocfilehash: 1b96b2832af894ee943028fd7460c5eb17e8cc43
ms.sourcegitcommit: d81c7cea85af6ad5fef81d3c930514a51464368c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/04/2020
ms.locfileid: "49572548"
---
# <a name="configure-anti-malware-policies-in-eop"></a>Configurer des stratégies anti-programmes malveillants dans EOP

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]


Dans les organisations Microsoft 365 avec des boîtes aux lettres dans Exchange Online ou des organisations Exchange Online Protection (EOP) autonomes sans boîtes aux lettres Exchange Online, les messages électroniques sont automatiquement protégés contre les programmes malveillants par EOP. EOP utilise des stratégies anti-programme malveillant pour les paramètres de protection contre les programmes malveillants. Pour plus d’informations, consultez la rubrique [protection contre les programmes malveillants](anti-malware-protection.md).

Les administrateurs peuvent afficher, modifier et configurer (mais pas supprimer) la stratégie de protection contre les programmes malveillants par défaut pour répondre aux besoins de leur organisation. Pour une granularité accrue, vous pouvez également créer des stratégies anti-programmes malveillants personnalisées qui s’appliquent à des utilisateurs, des groupes ou des domaines spécifiques de votre organisation. Les stratégies personnalisées priment toujours sur la stratégie par défaut. Vous pouvez cependant modifier la priorité (l'ordre d'exécution) de vos stratégies personnalisées.

Vous pouvez configurer des stratégies de protection contre les programmes malveillants dans le centre de sécurité & conformité ou dans PowerShell (Exchange Online PowerShell pour les organisations Microsoft 365 avec des boîtes aux lettres dans Exchange Online ; environnement de ligne de commande Exchange autonome EOP pour les organisations sans boîtes aux lettres Exchange Online).

## <a name="what-do-you-need-to-know-before-you-begin"></a>Ce qu'il faut savoir avant de commencer

- Vous ouvrez le Centre de conformité et sécurité sur <https://protection.office.com/>. Pour accéder directement à la page **anti-programme malveillant** , utilisez <https://protection.office.com/antimalware> .

- Pour vous connecter à Exchange Online PowerShell, voir [Connexion à Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell). Pour vous connecter à un service Exchange Online Protection PowerShell autonome, voir [Se connecter à Exchange Online Protection PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).

- Avant de pouvoir effectuer les procédures décrites dans cet article, vous devez disposer d’autorisations dans le centre de sécurité & Compliance Center :
  - Pour ajouter, modifier et supprimer des stratégies de protection contre les programmes malveillants, vous devez être membre des groupes de rôles de gestion de l' **organisation** ou d' **administrateur de sécurité** .
  - Pour un accès en lecture seule aux stratégies de protection contre les programmes malveillants, vous devez être membre des groupes de rôles **lecteur global** ou **lecteur de sécurité** .

  Pour en savoir plus, consultez [Autorisations dans le Centre de sécurité et de conformité](permissions-in-the-security-and-compliance-center.md).

  **Remarques**:

  - L’ajout d’utilisateurs au rôle Azure Active Directory correspondant dans le centre d’administration 365 de Microsoft donne aux utilisateurs les autorisations requises dans le centre de sécurité & conformité _et_ des autorisations pour d’autres fonctionnalités de Microsoft 365. Si vous souhaitez en savoir plus, veuillez consulter la page [À propos des rôles d’administrateur](https://docs.microsoft.com/microsoft-365/admin/add-users/about-admin-roles).
  - Le groupe de rôles gestion de l' **Organisation en affichage seul** dans [Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/permissions-exo#role-groups) offre également un accès en lecture seule à la fonctionnalité.

- Pour connaître les paramètres recommandés pour les stratégies de protection contre les programmes malveillants, consultez la rubrique [EOP anti-malware Policy Settings](recommended-settings-for-eop-and-office365-atp.md#eop-anti-malware-policy-settings).

## <a name="use-the-security--compliance-center-to-create-anti-malware-policies"></a>Utiliser le centre de sécurité & conformité pour créer des stratégies de protection contre les programmes malveillants

La création d’une stratégie anti-programme malveillant personnalisée dans le centre de sécurité & conformité crée la règle de filtrage des programmes malveillants et la stratégie de filtrage des programmes malveillants associée en même temps en utilisant le même nom pour les deux.

1. Dans le centre de sécurité & conformité, accédez **à** \> **Policy** \> **protection contre les programmes malveillants**, puis cliquez sur **nouvelle** ![ icône Ajouter ](../../media/ITPro-EAC-AddIcon.png) .

2. Dans la page **nouvelle stratégie anti-programme malveillant** qui s’ouvre, configurez les paramètres suivants :

   - **Nom** Entrez un nom unique et descriptif pour la stratégie.

   - **Description** Entrez une description facultative pour la stratégie.

   - **Réponse de détection de programmes malveillants**: sélectionnez l’une de ces valeurs pour le paramètre **voulez-vous avertir les destinataires si leurs messages sont mis en quarantaine ?** .

     - **Non**: le message est mis en quarantaine sans notification aux destinataires prévus. Il s’agit de la valeur par défaut.

     - **Oui et utiliser le texte de notification par défaut**: le message est mis en quarantaine. Une copie du message est remise aux destinataires, mais *toutes* les pièces jointes (et pas seulement celles qui ont été détectées) sont remplacées par un fichier texte unique nommé **alerte anti-programme malveillant Text.txt** qui contient le texte par défaut. Pour le texte par défaut, consultez la rubrique [anti-malware Policies](anti-malware-protection.md#anti-malware-policies).

     - **Oui et utiliser le texte de notification personnalisé**: le message est mis en quarantaine. Une copie du message est remise aux destinataires, mais *toutes* les pièces jointes (et pas uniquement celles détectées) sont remplacées par un seul fichier texte nommé **alerte par programme malveillant Text.txt** contient le texte personnalisé que vous spécifiez dans la zone de **texte alerte personnalisée** .

   - **Filtre de types de pièces jointes courantes**: sélectionnez l’une de ces valeurs pour **bloquer les types de pièces jointes susceptibles de nuire à votre ordinateur**:

     - **Désactivé**

     - **Activé**: les messages dont les pièces jointes sont spécifiées sont traités comme des détections de programmes malveillants et sont automatiquement mis en quarantaine. Vous pouvez modifier la liste bu en cliquant sur les boutons **Ajouter**  et **supprimer** .

   - Protection **automatique contre les menaces à l’heure : le** programme malveillant zap met en quarantaine les messages qui ont déjà été remis. Pour plus d’informations, reportez-vous à la rubrique [vidage automatique des heures zéro (ZAP) dans Exchange Online](zero-hour-auto-purge.md). Sélectionnez l’une des valeurs suivantes :

     - **Désactivé**

     - **Activé (recommandé)**

   - **Notification**: les paramètres de cette section contrôlent les notifications de l’expéditeur et de l’administrateur lorsqu’un programme malveillant est détecté dans un message.

     - **Notifications** de l’expéditeur : sélectionnez l’une des options suivantes ou les deux :

       - **Notifier les expéditeurs internes**: un expéditeur interne se trouve à l’intérieur de l’organisation.

       - **Notifier les expéditeurs externes**: un expéditeur externe se trouve à l’extérieur de l’organisation.

     - **Notifications** de l’administrateur : sélectionnez l’une des options suivantes ou les deux :

       - **Notifier l’administrateur concernant les messages non remis provenant d’expéditeurs internes**: Si vous sélectionnez cette option, entrez une adresse de messagerie de notification dans la zone **adresse de messagerie** de l’administrateur.

       - **Informer l’administrateur sur les messages non remis provenant d’expéditeurs externes**: Si vous sélectionnez cette option, entrez une adresse de messagerie de notification dans la zone **adresse de messagerie** de l’administrateur.

     - **Personnaliser les notifications**: ces paramètres remplacent le texte de notification par défaut utilisé par les expéditeurs ou les administrateurs. Pour plus d’informations sur les valeurs par défaut, consultez la rubrique [anti-malware Policies](anti-malware-protection.md#anti-malware-policies).

       - **Utiliser le texte de notification personnalisé**: Si vous sélectionnez cette option, vous devez utiliser les cases **du nom** et de l' **adresse** de pour spécifier le nom et l’adresse de messagerie de l’expéditeur utilisés dans le message de notification personnalisé.

       - **Messages provenant d’expéditeurs internes**: Si vous avez choisi d’informer les expéditeurs ou les administrateurs concernant les messages non remis provenant d’expéditeurs internes, vous devez utiliser l' **objet** et les zones de **message** pour spécifier l’objet et le corps du message de notification personnalisé.

       - **Messages provenant d’expéditeurs externes**: Si vous avez choisi d’avertir les expéditeurs ou les administrateurs des messages non remis provenant d’expéditeurs externes, vous devez utiliser l' **objet** et les zones de **message** pour spécifier l’objet et le corps du message de notification personnalisé.

   - **Appliqué à**: les paramètres de cette section identifient les destinataires internes auxquels la stratégie s’applique.

     - **Si**: cliquez sur la liste déroulante **Sélectionner une** , puis sélectionnez les conditions de la règle :

       - **Le destinataire est**: spécifie une ou plusieurs boîtes aux lettres, utilisateurs de messagerie ou contacts de messagerie dans votre organisation. Dans la boîte de dialogue **Sélectionner les membres** qui s'affiche, sélectionnez un ou plusieurs destinataires dans la liste, puis cliquez sur **Ajouter -\>**. Dans la zone **vérifier les noms** , vous pouvez utiliser des caractères génériques pour plusieurs adresses de messagerie (par exemple : \* @fabrikam. com). Lorsque vous avez terminé, cliquez sur **OK**.

       - **Le domaine du destinataire est**: spécifie les destinataires d’un ou de plusieurs domaines acceptés configurés dans votre organisation. Dans la boîte de dialogue qui s'affiche, sélectionnez un ou plusieurs domaines, puis cliquez sur **Ajouter -\>**. Lorsque vous avez terminé, cliquez sur **OK**.

       - **Le destinataire est membre de**: spécifie un ou plusieurs groupes dans votre organisation. Dans la boîte de dialogue **Sélectionner des membres** qui s'affiche, sélectionnez un ou plusieurs groupes dans la liste, puis cliquez sur **Ajouter -\>**. Lorsque vous avez terminé, cliquez sur **OK**.

     Vous ne pouvez utiliser une condition qu’une seule fois, mais vous pouvez spécifier plusieurs valeurs pour la condition. Plusieurs valeurs de la même condition utilisent ou logique (par exemple, _\<recipient1\>_ ou _\<recipient2\>_ ). Conditions d’utilisation et logique différentes (par exemple, _\<recipient1\>_ and _\<member of group 1\>_ ). Pour ajouter plusieurs conditions, cliquez sur **Ajouter une condition** et sélectionnez une condition parmi les options restantes.

     - **Sauf si**: pour ajouter des exceptions à la règle, cliquez sur **Ajouter une exception**, cliquez sur la liste déroulante **Sélectionner un** et configurez les exceptions. Les paramètres et le comportement sont exactement comme les conditions.

3. Lorsque vous avez terminé, cliquez sur **Enregistrer**.

## <a name="use-the-security--compliance-center-to-view-anti-malware-policies"></a>Utiliser le centre de sécurité & conformité pour afficher les stratégies de protection contre les programmes malveillants

1. Dans le centre de sécurité & conformité, accédez **Threat management** à \> **Policy** \> **protection contre les programmes malveillants** pour la stratégie de gestion des menaces.

2. Lorsque vous sélectionnez une stratégie, les informations associées sont affichées dans le volet d'informations. Pour plus d’informations sur la stratégie, cliquez sur **modifier** l' ![ icône modifier ](../../media/ITPro-EAC-EditIcon.png) .

   - La valeur de la propriété **Enabled**, la valeur de la propriété **Priority** et les paramètres de l'onglet **Appliqué à** sont dans la règle de filtrage des programmes malveillants.

   - Les paramètres des onglets **Général** et **Paramètres** sont dans la stratégie de filtrage des programmes malveillants.

## <a name="use-the-security--compliance-center-to-modify-anti-malware-policies"></a>Utiliser le centre de sécurité & conformité pour modifier des stratégies de protection contre les programmes malveillants

1. Dans le centre de sécurité & conformité, accédez **Threat management** à \> **Policy** \> **protection contre les programmes malveillants** pour la stratégie de gestion des menaces.

2. Sélectionnez la stratégie, puis cliquez sur **modifier** l' ![ icône modifier ](../../media/ITPro-EAC-EditIcon.png) . Pour plus d’informations sur les paramètres, reportez-vous à la section [utiliser le centre de sécurité & conformité pour créer des stratégies de protection contre les programmes malveillants](#use-the-security--compliance-center-to-create-anti-malware-policies) dans cette rubrique.

   **Remarques**:

   - Au lieu d'être tous affichés sur une seule page, les paramètres sont divisés entre les onglets **Général**, **Paramètres** et **Appliqué à**. L’onglet **appliqué à** n’est pas disponible dans la stratégie par défaut nommée par défaut (qui est automatiquement appliquée à tout le monde).

   - Vous ne pouvez pas renommer la stratégie par défaut.

## <a name="use-the-security--compliance-center-to-enable-or-disable-anti-malware-policies"></a>Utiliser le centre de sécurité & conformité pour activer ou désactiver les stratégies anti-programme malveillant

1. Dans le centre de sécurité & conformité, accédez **Threat management** à \> **Policy** \> **protection contre les programmes malveillants** pour la stratégie de gestion des menaces.

2. Sélectionnez la stratégie dans la liste, puis configurez les paramètres suivants :

   - **Désactiver la stratégie**: désactivez la case à cocher dans la colonne **activé** . Par défaut, les stratégies de protection contre les programmes malveillants sont activées lorsque vous les créez dans le centre de sécurité & conformité.

   - **Activer la stratégie**: activez la case à cocher dans la colonne **activé** .

## <a name="use-the-security--compliance-center-to-set-the-priority-of-custom-anti-malware-policies"></a>Utiliser le centre de sécurité & conformité pour définir la priorité des stratégies anti-programmes malveillants personnalisées

Par défaut, les stratégies de protection contre les programmes malveillants reçoivent une priorité basée sur l’ordre dans lequel elles ont été créées (les stratégies plus récentes sont moins prioritaires que les stratégies plus anciennes). Un numéro de priorité peu élevé indique une plus grande priorité, et les stratégies sont traitées par ordre de priorité (les stratégies à haute priorité sont traitées avant les stratégies de moindre priorité). Aucune stratégie ne peut avoir la même priorité, et le traitement de stratégie s’arrête une fois la première stratégie appliquée.

 **Remarques**:

- Dans le centre de sécurité & conformité, vous pouvez uniquement modifier la priorité de la stratégie anti-programme malveillant une fois que vous l’avez créée. Dans PowerShell, vous pouvez remplacer la priorité par défaut lorsque vous créez la règle de filtrage des programmes malveillants (ce qui peut avoir une incidence sur la priorité des règles existantes).

- Dans le centre de sécurité & conformité, les stratégies de protection contre les programmes malveillants sont traitées dans l’ordre dans lequel elles sont affichées (la première stratégie a la valeur de **priorité** 0). La stratégie anti-programme malveillant par défaut nommée Default a la valeur Priority la **plus faible** et vous ne pouvez pas la modifier.

Pour modifier la priorité d’une stratégie, déplacez-la vers le haut ou vers le bas de la liste (vous ne pouvez pas modifier directement le numéro de **priorité** dans le Centre de sécurité & conformité).

1. Dans le centre de sécurité & conformité, accédez **Threat management** à \> **Policy** \> **protection contre les programmes malveillants** pour la stratégie de gestion des menaces.

2. Sélectionnez une stratégie, **puis cliquez sur** ![ icône de flèche vers ](../../media/ITPro-EAC-UpArrowIcon.png) le haut ou sur flèche vers **le bas** ![ ](../../media/ITPro-EAC-DownArrowIcon.png) pour déplacer la règle vers le haut ou vers le bas de la liste.

## <a name="use-the-security--compliance-center-to-remove-anti-malware-policies"></a>Utiliser le centre de sécurité & conformité pour supprimer des stratégies de protection contre les programmes malveillants

Lorsque vous utilisez le centre de sécurité & conformité pour supprimer une stratégie de blocage des programmes malveillants, la règle de filtrage des programmes malveillants et la stratégie de filtrage des programmes malveillants correspondante sont toutes deux supprimées.

1. Dans le centre de sécurité & conformité, accédez **Threat management** à \> **Policy** \> **protection contre les programmes malveillants** pour la stratégie de gestion des menaces.

2. Sélectionnez la stratégie anti-programmes malveillants que vous souhaitez supprimer de la liste, puis cliquez sur **supprimer** l' ![ icône Supprimer ](../../media/ITPro-EAC-DeleteIcon.png) .

## <a name="use-exchange-online-powershell-or-standalone-eop-powershell-to-configure-anti-malware-policies"></a>Utiliser Exchange Online PowerShell ou l’environnement de ligne de commande Exchange EOP PowerShell autonome pour configurer les stratégies anti-programme malveillant

### <a name="use-powershell-to-create-anti-malware-policies"></a>Utiliser PowerShell pour créer des stratégies de protection contre les programmes malveillants

La création d’une stratégie anti-programme malveillant dans PowerShell est un processus en deux étapes :

1. Créer la stratégie de filtrage des programmes malveillants.

2. Créer la règle de filtrage des programmes malveillants qui détermine la stratégie de filtrage des programmes malveillants qui s'applique la règle.

 **Remarques**:

- Vous pouvez créer une nouvelle règle de filtrage des programmes malveillants et lui affecter une stratégie de filtrage des programmes malveillants existante non associée. Une règle de filtrage des programmes malveillants ne peut pas être associée à plusieurs stratégies de filtrage des programmes malveillants.

- Il existe deux paramètres que vous pouvez configurer sur les nouvelles stratégies de protection contre les programmes malveillants dans PowerShell qui ne sont pas disponibles dans le centre de sécurité & de sécurité tant que vous n’avez pas créé la stratégie :

  - Créez la nouvelle stratégie comme désactivé (_activé_ `$false` sur la cmdlet **New-MalwareFilterRule** ).

  - Définir la priorité de la stratégie lors de la création (_priorité_ _\<Number\>_ ) sur la cmdlet **New-MalwareFilterRule** ).

- Une nouvelle stratégie de filtrage des programmes malveillants que vous créez dans PowerShell n’est pas visible dans le centre de sécurité &, tant que vous n’avez pas affecté la stratégie à une règle de filtrage des programmes malveillants.

#### <a name="step-1-use-powershell-to-create-a-malware-filter-policy"></a>Étape 1 : utiliser PowerShell pour créer une stratégie de filtrage des programmes malveillants

**Remarque**: dans EOP, les valeurs des paramètres d' _action_ `DeleteMessage` , `DeleteAttachmentAndUseDefaultAlert` et `DeleteAttachmentAndUseCustomAlert` ne suppriment pas les messages. Au lieu de cela, les messages sont mis en quarantaine. Pour plus d’informations sur la récupération des messages mis en quarantaine, consultez la rubrique [gestion des messages et des fichiers mis en quarantaine en tant qu’administrateur dans EOP](manage-quarantined-messages-and-files.md).

Pour créer une stratégie de filtrage des programmes malveillants, utilisez la syntaxe suivante :

```PowerShell
New-MalwareFilterPolicy -Name "<PolicyName>" [-Action <DeleteMessage | DeleteAttachmentAndUseDefaultAlert | DeleteAttachmentAndUseCustomAlert>] [-AdminDisplayName "<OptionalComments>"] [-CustomNotifications <$true | $false>] [<Inbound notification options>] [<Outbound notification options>]
```

Cet exemple crée une nouvelle stratégie de filtrage des programmes malveillants nommée Stratégie de filtrage des programmes malveillants Contoso avec les paramètres suivants :

- Mise en quarantaine des messages contenant des programmes malveillants sans notification aux destinataires (nous n’utilisons pas le paramètre _action_ , et la valeur par défaut est `DeleteMessage` ).

- Ne pas avertir l’expéditeur du message lorsqu’un programme malveillant est détecté dans le message (nous n’utilisons pas les paramètres _paramètre enableexternalsendernotifications_ ou _EnableInternalSenderNotifications_ , et la valeur par défaut pour les deux est `$false` ).

- Aviser l'administrateur admin@contoso.com lorsqu'un programme malveillant est détecté dans un message envoyé par un expéditeur interne.

```PowerShell
New-MalwareFilterPolicy -Name "Contoso Malware Filter Policy" -EnableInternalSenderAdminNotifications $true -InternalSenderAdminAddress admin@contoso.com
```

Pour obtenir des informations détaillées sur la syntaxe et les paramètres, consultez la rubrique [New-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/new-malwarefilterpolicy).

#### <a name="step-2-use-powershell-to-create-a-malware-filter-rule"></a>Étape 2 : utiliser PowerShell pour créer une règle de filtrage des programmes malveillants

Pour créer une règle de filtrage des programmes malveillants, utilisez la syntaxe suivante :

```PowerShell
New-MalwareFilterRule -Name "<RuleName>" -MalwareFilterPolicy "<PolicyName>" <Recipient filters> [<Recipient filter exceptions>] [-Comments "<OptionalComments>"]
```

Cet exemple crée une règle de filtrage des programmes malveillants nommée Destinataires Contoso avec les paramètres suivants :

- La stratégie de filtrage des programmes malveillants nommée Stratégie de filtrage des programmes malveillants Contoso est associée à la règle.

- La règle s'applique aux destinataires dans le domaine contoso.com.

```PowerShell
New-MalwareFilterRule -Name "Contoso Recipients" -MalwareFilterPolicy "Contoso Malware Filter Policy" -RecipientDomainIs contoso.com
```

Pour obtenir des informations détaillées sur la syntaxe et les paramètres, consultez la rubrique [New-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/new-malwarefilterrule).

### <a name="use-powershell-to-view-malware-filter-policies"></a>Utiliser PowerShell pour afficher les stratégies de filtrage des programmes malveillants

Pour renvoyer une liste récapitulative des stratégies de filtrage des programmes malveillants, exécutez la commande suivante :

```PowerShell
Get-MalwareFilterPolicy
```

Pour renvoyer des informations détaillées sur une stratégie de filtrage des programmes malveillants spécifique, utilisez la syntaxe suivante :

```PowerShell
Get-MalwareFilterPolicy -Identity "<PolicyName>" | Format-List [<Specific properties to view>]
```

Cet exemple renvoie toutes les valeurs de propriété pour la stratégie de filtrage des programmes malveillants nommée Executives.

```PowerShell
Get-MalwareFilterPolicy -Identity "Executives" | Format-List
```

Cet exemple renvoie uniquement les propriétés spécifiées pour la même stratégie.

```PowerShell
Get-MalwareFilterPolicy -Identity "Executives" | Format-List Action,AdminDisplayName,CustomNotifications,Enable*Notifications
```

Pour obtenir des informations détaillées sur la syntaxe et les paramètres, consultez la rubrique [Get-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/get-malwarefilterpolicy).

### <a name="use-powershell-to-view-malware-filter-rules"></a>Utiliser PowerShell pour afficher les règles de filtrage des programmes malveillants

Pour renvoyer une liste récapitulative des règles de filtrage des programmes malveillants, exécutez la commande suivante :

```PowerShell
Get-MalwareFilterRule
```

Pour filtrer la liste par règles activées ou désactivées, exécutez les commandes suivantes :

```PowerShell
Get-HostedContentFilterRule -State Disabled
```

```PowerShell
Get-HostedContentFilterRule -State Enabled
```

Pour renvoyer des informations détaillées sur une règle spécifique de filtrage des programmes malveillants spécifique, utilisez la syntaxe suivante :

```PowerShell
Get-MalwareFilterRule -Identity "<RuleName>" | Format-List [<Specific properties to view>]
```

Cet exemple renvoie toutes les valeurs de propriété pour la règle de filtrage des programmes malveillants nommée Executives.

```PowerShell
Get-MalwareFilterRule -Identity "Executives" | Format-List
```

Cet exemple renvoie uniquement les propriétés spécifiées pour la même règle.

```PowerShell
Get-MalwareFilterRule -Identity "Executives" | Format-List Name,Priority,State,MalwareFilterPolicy,*Is,*SentTo,*MemberOf
```

Pour obtenir des informations détaillées sur la syntaxe et les paramètres, consultez la rubrique [Get-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/get-malwarefilterrule).

### <a name="use-powershell-to-modify-malware-filter-policies"></a>Utiliser PowerShell pour modifier des stratégies de filtrage des programmes malveillants

À l’exception des éléments suivants, les mêmes paramètres sont disponibles lorsque vous modifiez une stratégie de filtrage des programmes malveillants dans PowerShell comme lorsque vous créez la stratégie, comme décrit dans la section [étape 1 : utiliser PowerShell pour créer une stratégie de filtrage des programmes malveillants](#step-1-use-powershell-to-create-a-malware-filter-policy) , plus haut dans cette rubrique.

- Le commutateur _MakeDefault_ qui convertit la stratégie spécifiée en stratégie par défaut (appliqué à tout le monde, non modifiable à la priorité la **plus basse** , et vous ne pouvez pas le supprimer) n’est disponible que lorsque vous modifiez une stratégie de filtrage des programmes malveillants dans PowerShell.

- Vous ne pouvez pas renommer une stratégie de filtrage des programmes malveillants (l’applet de commande **Set-MalwareFilterPolicy** n’a pas de paramètre _Name_ ). Lorsque vous renommez une stratégie anti-programme malveillant dans le centre de sécurité & conformité, vous renommez uniquement la _règle_ de filtrage des programmes malveillants.

Pour modifier une stratégie de filtrage des programmes malveillants, utilisez la syntaxe suivante :

```PowerShell
Set-MalwareFilterPolicy -Identity "<PolicyName>" <Settings>
```

Pour obtenir des informations détaillées sur la syntaxe et les paramètres, consultez la rubrique [Set-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/set-malwarefilterpolicy).

### <a name="use-powershell-to-modify-malware-filter-rules"></a>Utiliser PowerShell pour modifier les règles de filtrage des programmes malveillants

Le seul paramètre qui n’est pas disponible lorsque vous modifiez une règle de filtrage des programmes malveillants dans PowerShell est le paramètre _activé_ qui vous permet de créer une règle désactivée. Pour activer ou désactiver les règles de filtrage des programmes malveillants existantes, consultez la section suivante.

Dans le cas contraire, aucun paramètre supplémentaire n’est disponible lorsque vous modifiez une règle de filtrage des programmes malveillants dans PowerShell. Les mêmes paramètres sont disponibles lorsque vous créez une règle, comme décrit dans la section [étape 2 : utiliser PowerShell pour créer une règle de filtrage des programmes malveillants](#step-2-use-powershell-to-create-a-malware-filter-rule) plus haut dans cette rubrique.

Pour modifier une règle de filtrage des programmes malveillants, utilisez la syntaxe suivante :

```PowerShell
Set-MalwareFilterRule -Identity "<RuleName>" <Settings>
```

Pour obtenir des informations détaillées sur la syntaxe et les paramètres, consultez la rubrique [Set-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/set-malwarefilterrule).

### <a name="use-powershell-to-enable-or-disable-malware-filter-rules"></a>Utiliser PowerShell pour activer ou désactiver les règles de filtrage des programmes malveillants

L’activation ou la désactivation d’une règle de filtrage des programmes malveillants dans PowerShell active ou désactive l’ensemble de la stratégie anti-programme malveillant (la règle de filtrage des programmes malveillants et la stratégie de filtrage des programmes malveillants affectés). Vous ne pouvez pas activer ou désactiver la stratégie anti-programme malveillant par défaut (elle est toujours appliquée à tous les destinataires).

Pour activer ou désactiver une règle de filtrage des programmes malveillants dans PowerShell, utilisez la syntaxe suivante :

```PowerShell
<Enable-MalwareFilterRule | Disable-MalwareFilterRule> -Identity "<RuleName>"
```

Cet exemple désactive la règle de filtrage des programmes malveillants nommée Marketing Department.

```PowerShell
Disable-MalwareFilterRule -Identity "Marketing Department"
```

Cet exemple montre comment activer la même règle.

```PowerShell
Enable-MalwareFilterRule -Identity "Marketing Department"
```

Pour obtenir des informations détaillées sur la syntaxe et les paramètres, voir [Enable-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/enable-malwarefilterrule) et [Disable-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/disable-malwarefilterrule).

### <a name="use-powershell-to-set-the-priority-of-malware-filter-rules"></a>Utiliser PowerShell pour définir la priorité des règles de filtrage des programmes malveillants

La valeur 0 est la priorité la plus élevée que vous pouvez définir sur une règle. La valeur la plus basse que vous pouvez définir dépend du nombre de règles. Par exemple, si vous avez cinq règles, vous pouvez utiliser les valeurs de priorité 0 à 4. Tout changement de priorité d’une règle existante peut avoir un effet en cascade sur les autres règles. Par exemple, si vous avez cinq règles personnalisées (priorités de 0 à 4) et que vous modifiez la priorité d'une règle sur 2, la règle existante de priorité 2 passe en priorité 3, et la règle de priorité 3 passe en priorité 4.

Pour définir la priorité d’une règle de filtrage des programmes malveillants dans PowerShell, utilisez la syntaxe suivante :

```PowerShell
Set-MalwareFilterRule -Identity "<RuleName>" -Priority <Number>
```

Cet exemple définit la priorité de la règle nommée Marketing Department sur 2. Toutes les règles existantes dont la priorité est inférieure ou égale à 2 sont diminuées d’une unité (leurs numéros de priorité sont augmentés de 1).

```PowerShell
Set-MalwareFilterRule -Identity "Marketing Department" -Priority 2
```

**Remarques** :

- Pour définir la priorité d’une nouvelle règle lors de sa création, utilisez plutôt le paramètre _Priority_ sur la cmdlet **New-MalwareFilterRule** .

- La stratégie de filtrage des programmes malveillants par défaut n’a pas de règle de filtrage des programmes malveillants correspondante et a toujours la valeur de priorité non modifiable la **plus faible**.

### <a name="use-powershell-to-remove-malware-filter-policies"></a>Utiliser PowerShell pour supprimer des stratégies de filtrage des programmes malveillants

Lorsque vous utilisez PowerShell pour supprimer une stratégie de filtrage des programmes malveillants, la règle de filtrage des programmes malveillants correspondante n’est pas supprimée.

Pour supprimer une stratégie de filtrage des programmes malveillants dans PowerShell, utilisez la syntaxe suivante :

```PowerShell
Remove-MalwareFilterPolicy -Identity "<PolicyName>"
```

Cet exemple supprime la stratégie de filtrage des programmes malveillants nommée Marketing Department.

```PowerShell
Remove-MalwareFilterPolicy -Identity "Marketing Department"
```

Pour obtenir des informations détaillées sur la syntaxe et les paramètres, consultez la rubrique [Remove-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/remove-malwarefilterpolicy).

### <a name="use-powershell-to-remove-malware-filter-rules"></a>Utiliser PowerShell pour supprimer des règles de filtrage des programmes malveillants

Lorsque vous utilisez PowerShell pour supprimer une règle de filtrage des programmes malveillants, la stratégie de filtrage des programmes malveillants correspondante n’est pas supprimée.

Pour supprimer une règle de filtrage des programmes malveillants dans PowerShell, utilisez la syntaxe suivante :

```PowerShell
Remove-MalwareFilterRule -Identity "<PolicyName>"
```

Cet exemple supprime la règle de filtrage des programmes malveillants nommée Marketing Department.

```PowerShell
Remove-MalwareFilterRule -Identity "Marketing Department"
```

Pour obtenir des informations détaillées sur la syntaxe et les paramètres, consultez la rubrique [Remove-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/remove-malwarefilterrule).

## <a name="how-do-you-know-these-procedures-worked"></a>Comment savoir si ces procédures ont fonctionné ?

### <a name="use-the-eicartxt-file-to-verify-your-anti-malware-policy-settings"></a>Utiliser le fichier EICAR.TXT pour vérifier vos paramètres de stratégie anti-programme malveillant

> [!IMPORTANT]
> Le fichier EICAR.TXT n'est pas un virus. The European Institute for Computer Antivirus Research (EICAR) a développé ce fichier pour tester en toute sécurité les installations et les paramètres antivirus.

1. Ouvrez le bloc-notes et collez le texte suivant dans un fichier vide :

   ```Text
   X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
   ```

   Assurez-vous qu’il s’agit des seuls caractères de texte dans le fichier. La taille du fichier doit être de 68 octets.

2. Enregistrez le fichier en tant que EICAR.TXT

   Dans votre programme antivirus de bureau, veillez à exclure les EICAR.TXT de l’analyse (sinon, le fichier sera mis en quarantaine).

3. Envoyer un message électronique qui contient le fichier EICAR.TXT en tant que pièce jointe, à l’aide d’un client de messagerie qui ne bloque pas automatiquement le fichier. Utilisez vos paramètres de stratégie anti-programme malveillant pour déterminer les scénarios suivants à tester :

   - Courrier électronique d’une boîte aux lettres interne à un destinataire interne.

   - Courrier électronique d’une boîte aux lettres interne à un destinataire externe.

   - Courrier électronique d’une boîte aux lettres externe à un destinataire interne.

4. Vérifiez que le message a été mis en quarantaine et vérifiez que les résultats de la notification du destinataire et de l’expéditeur sont basés sur vos paramètres de stratégie anti-programme malveillant. Par exemple :

   - Les destinataires ne sont pas avertis ou les destinataires reçoivent le message d’origine avec la EICAR.TXT pièce jointe remplacée par le **Text.txtd’alerte par programmes malveillants** qui contient le texte par défaut ou personnalisé.

   - Les expéditeurs internes ou externes sont avertis avec les messages de notification par défaut ou personnalisés.

   - L’adresse de messagerie de l’administrateur que vous avez spécifiée est notifiée pour les expéditeurs de messages internes ou externes, avec les messages de notification par défaut ou personnalisés.

5. Supprimez le fichier EICAR.TXT une fois le test terminé (de sorte que les autres utilisateurs ne soient pas obligés de le faire).
