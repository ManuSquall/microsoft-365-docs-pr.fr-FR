---
title: Détecter et corriger les règles Outlook et les attaques par injection de formulaires personnalisés.
f1.keywords:
- NOCSH
ms.author: tracyp
author: MSFTTracyp
manager: dansimp
ms.date: 04/23/2018
audience: ITPro
ms.topic: article
ms.collection:
- o365_security_incident_response
- M365-security-compliance
localization_priority: Normal
search.appverid:
- MET150
description: Découvrez comment reconnaître et corriger les règles Outlook et les attaques par injection de formulaires personnalisés dans Office 365
ms.custom: seo-marvel-apr2020
ms.technology: mdo
ms.prod: m365-security
ms.openlocfilehash: 30ddd5f57dee2156504211e76304d346a63e192d
ms.sourcegitcommit: 070724118be25cd83418d2a56863da95582dae65
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/03/2021
ms.locfileid: "50406699"
---
# <a name="detect-and-remediate-outlook-rules-and-custom-forms-injections-attacks"></a><span data-ttu-id="3cf5d-103">Détecter et corriger les règles Outlook et les attaques par injection de formulaires personnalisés</span><span class="sxs-lookup"><span data-stu-id="3cf5d-103">Detect and Remediate Outlook Rules and Custom Forms Injections Attacks</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]


<span data-ttu-id="3cf5d-104">**Résumé** Découvrez comment reconnaître et corriger les règles Outlook et les attaques par injection de formulaires personnalisées dans Office 365.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-104">**Summary** Learn how to recognize and remediate the Outlook rules and custom Forms injections attacks in Office 365.</span></span>

## <a name="what-is-the-outlook-rules-and-custom-forms-injection-attack"></a><span data-ttu-id="3cf5d-105">Qu’est-ce que l’attaque par injection des règles Outlook et des formulaires personnalisés ?</span><span class="sxs-lookup"><span data-stu-id="3cf5d-105">What is the Outlook Rules and Custom Forms injection attack?</span></span>

<span data-ttu-id="3cf5d-106">Une fois qu’un attaquant a accédé à votre organisation, il essaiera d’établir un point d’accès pour rester dans votre organisation ou y revenir une fois qu’il a été détecté.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-106">After an attacker gains access to your organization, they'll try to establish a foothold to stay in or get back in after they've been discovered.</span></span> <span data-ttu-id="3cf5d-107">Cette activité est appelée *établissement d’un mécanisme de persistance.*</span><span class="sxs-lookup"><span data-stu-id="3cf5d-107">This activity is called *establishing a persistence mechanism*.</span></span> <span data-ttu-id="3cf5d-108">Il existe deux façons pour une personne malveillante d’utiliser Outlook pour établir un mécanisme de persistance :</span><span class="sxs-lookup"><span data-stu-id="3cf5d-108">There are two ways that an attacker can use Outlook to establish a persistence mechanism:</span></span>

- <span data-ttu-id="3cf5d-109">En exploitant les règles Outlook.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-109">By exploiting Outlook rules.</span></span>
- <span data-ttu-id="3cf5d-110">En injectant des formulaires personnalisés dans Outlook.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-110">By injecting custom forms into Outlook.</span></span>

<span data-ttu-id="3cf5d-111">Réinstaller Outlook ou même donner à la personne concernée un nouvel ordinateur ne vous aidera pas.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-111">Reinstalling Outlook, or even giving the affected person a new computer won't help.</span></span> <span data-ttu-id="3cf5d-112">Lorsque la nouvelle installation d’Outlook se connecte à la boîte aux lettres, toutes les règles et tous les formulaires sont synchronisés à partir du cloud.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-112">When the fresh installation of Outlook connects to the mailbox, all rules and forms are synchronized from the cloud.</span></span> <span data-ttu-id="3cf5d-113">Les règles ou les formulaires sont généralement conçus pour exécuter du code à distance et installer des programmes malveillants sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-113">The rules or forms are typically designed to run remote code and install malware on the local machine.</span></span> <span data-ttu-id="3cf5d-114">Le programme malveillant volera les informations d’identification ou effectuera d’autres activités illicites.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-114">The malware steals credentials or performs other illicit activity.</span></span>

<span data-ttu-id="3cf5d-115">La bonne nouvelle est que si vous conservez vos clients Outlook corrigés sur la dernière version, vous n’êtes pas vulnérable à la menace, car les valeurs par défaut actuelles du client Outlook bloquent les deux mécanismes.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-115">The good news is: if you keep your Outlook clients patched to the latest version, you aren't vulnerable to the threat as current Outlook client defaults block both mechanisms.</span></span>

<span data-ttu-id="3cf5d-116">Les attaques suivent généralement les modèles ci-après :</span><span class="sxs-lookup"><span data-stu-id="3cf5d-116">The attacks typically follow these patterns:</span></span>

<span data-ttu-id="3cf5d-117">**L’exploit des règles**:</span><span class="sxs-lookup"><span data-stu-id="3cf5d-117">**The Rules Exploit**:</span></span>

1. <span data-ttu-id="3cf5d-118">L’attaquant volera les informations d’identification d’un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-118">The attacker steals a user's credentials.</span></span>

2. <span data-ttu-id="3cf5d-119">L’attaquant se signe à la boîte aux lettres Exchange de cet utilisateur (Exchange Online ou Exchange local).</span><span class="sxs-lookup"><span data-stu-id="3cf5d-119">The attacker signs in to that user's Exchange mailbox (Exchange Online or on-premises Exchange).</span></span>

3. <span data-ttu-id="3cf5d-120">L’attaquant crée une règle de boîte de réception de forwarding dans la boîte aux lettres.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-120">The attacker creates a forwarding Inbox rule in the mailbox.</span></span> <span data-ttu-id="3cf5d-121">La règle de forwarding est déclenchée lorsque la boîte aux lettres reçoit un message spécifique de l’attaquant qui correspond aux conditions de la règle.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-121">The forwarding rule is triggered when the mailbox receives a specific message from the attacker that matches the conditions of the rule.</span></span> <span data-ttu-id="3cf5d-122">Les conditions de règle et le format des messages sont personnalisés les uns pour les autres.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-122">The rule conditions and message format are tailor-made for each other.</span></span>

4. <span data-ttu-id="3cf5d-123">L’attaquant envoie le message électronique de déclencheur à la boîte aux lettres compromise, qui est toujours utilisée normalement par l’utilisateur qui ne s’en doute pas.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-123">The attacker sends the trigger email to the compromised mailbox, which is still being used as normal by the unsuspecting user.</span></span>

5. <span data-ttu-id="3cf5d-124">Lorsque la boîte aux lettres reçoit un message qui correspond aux conditions de règle, l’action de la règle est appliquée.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-124">When the mailbox receives a message that matches the conditions of rule, the action of the rule is applied.</span></span> <span data-ttu-id="3cf5d-125">En règle générale, l’action de la règle consiste à lancer une application sur un serveur distant (WebDAV).</span><span class="sxs-lookup"><span data-stu-id="3cf5d-125">Typically, the rule action is to launch an application on a remote (WebDAV) server.</span></span>

6. <span data-ttu-id="3cf5d-126">En règle générale, l’application installe un programme malveillant sur l’ordinateur de l’utilisateur (par exemple, [PowerShell).](https://www.powershellempire.com/)</span><span class="sxs-lookup"><span data-stu-id="3cf5d-126">Typically, the application installs malware on the user's machine (for example, [PowerShell Empire](https://www.powershellempire.com/)).</span></span>

7. <span data-ttu-id="3cf5d-127">Le programme malveillant permet à l’attaquant de voler (ou de voler à nouveau) le nom d’utilisateur et le mot de passe de l’utilisateur ou d’autres informations d’identification de l’ordinateur local et d’effectuer d’autres activités malveillantes.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-127">The malware allows the attacker to steal (or steal again) the user's username and password or other credentials from local machine and perform other malicious activities.</span></span>

<span data-ttu-id="3cf5d-128">**L’exploit de formulaires**:</span><span class="sxs-lookup"><span data-stu-id="3cf5d-128">**The Forms Exploit**:</span></span>

1. <span data-ttu-id="3cf5d-129">L’attaquant volera les informations d’identification d’un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-129">The attacker steals a user's credentials.</span></span>

2. <span data-ttu-id="3cf5d-130">L’attaquant se signe à la boîte aux lettres Exchange de cet utilisateur (Exchange Online ou Exchange local).</span><span class="sxs-lookup"><span data-stu-id="3cf5d-130">The attacker signs in to that user's Exchange mailbox (Exchange Online or on-premises Exchange).</span></span>

3. <span data-ttu-id="3cf5d-131">L’attaquant insère un modèle de formulaire de courrier personnalisé dans la boîte aux lettres de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-131">The attacker inserts a custom mail form template into the user's mailbox.</span></span> <span data-ttu-id="3cf5d-132">Le formulaire personnalisé est déclenché lorsque la boîte aux lettres reçoit un message spécifique de l’attaquant qui exige que la boîte aux lettres charge le formulaire personnalisé.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-132">The custom form is triggered when the mailbox receives a specific message from the attacker that requires the mailbox to load the custom form.</span></span> <span data-ttu-id="3cf5d-133">Le formulaire personnalisé et le format de message sont personnalisés les uns pour les autres.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-133">The custom form and the message format are tailor-made for each other.</span></span>

4. <span data-ttu-id="3cf5d-134">L’attaquant envoie le message électronique de déclencheur à la boîte aux lettres compromise, qui est toujours utilisée normalement par l’utilisateur qui ne s’en doute pas.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-134">The attacker sends the trigger email to the compromised mailbox, which is still being used as normal by the unsuspecting user.</span></span>

5. <span data-ttu-id="3cf5d-135">Lorsque la boîte aux lettres reçoit le message, elle charge le formulaire requis.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-135">When the mailbox receives the message, the mailbox loads the required form.</span></span> <span data-ttu-id="3cf5d-136">Le formulaire lance une application sur un serveur distant (WebDAV).</span><span class="sxs-lookup"><span data-stu-id="3cf5d-136">The form launches an application on a remote (WebDAV) server.</span></span>

6. <span data-ttu-id="3cf5d-137">En règle générale, l’application installe un programme malveillant sur l’ordinateur de l’utilisateur (par exemple, [PowerShell).](https://www.powershellempire.com/)</span><span class="sxs-lookup"><span data-stu-id="3cf5d-137">Typically, the application installs malware on the user's machine (for example, [PowerShell Empire](https://www.powershellempire.com/)).</span></span>

7. <span data-ttu-id="3cf5d-138">Le programme malveillant permet à l’attaquant de voler (ou de voler à nouveau) le nom d’utilisateur et le mot de passe de l’utilisateur ou d’autres informations d’identification de l’ordinateur local et d’effectuer d’autres activités malveillantes.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-138">The malware allows the attacker to steal (or steal again) the user's username and password or other credentials from local machine and perform other malicious activities.</span></span>

## <a name="what-a-rules-and-custom-forms-injection-attack-might-look-like-office-365"></a><span data-ttu-id="3cf5d-139">À quoi pourrait ressembler une attaque par injection de règles et de formulaires personnalisés dans Office 365 ?</span><span class="sxs-lookup"><span data-stu-id="3cf5d-139">What a Rules and Custom Forms Injection attack might look like Office 365?</span></span>

<span data-ttu-id="3cf5d-140">Ces mécanismes de persistance sont peu susceptibles d’être remarqués par vos utilisateurs et peuvent même, dans certains cas, leur être invisibles.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-140">These persistence mechanisms are unlikely to be noticed by your users and may in some cases even be invisible to them.</span></span> <span data-ttu-id="3cf5d-141">Cet article vous indique comment rechercher l’un des sept signes (Indicateurs de compromis) répertoriés ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-141">This article tells you how to look for any of the seven signs (Indicators of Compromise) listed below.</span></span> <span data-ttu-id="3cf5d-142">Si vous trouvez l’un de ces éléments, vous devez prendre des mesures correctives.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-142">If you find any of these, you need to take remediation steps.</span></span>

- <span data-ttu-id="3cf5d-143">**Indicateurs de compromission des règles**:</span><span class="sxs-lookup"><span data-stu-id="3cf5d-143">**Indicators of the Rules compromise**:</span></span>
  - <span data-ttu-id="3cf5d-144">L’action de la règle consiste à démarrer une application.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-144">Rule Action is to start an application.</span></span>
  - <span data-ttu-id="3cf5d-145">La règle fait référence à un FICHIER EXE, ZIP ou URL.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-145">Rule References an EXE, ZIP, or URL.</span></span>
  - <span data-ttu-id="3cf5d-146">Sur l’ordinateur local, recherchez les nouveaux processus qui démarrent à partir du piD Outlook.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-146">On the local machine, look for new process starts that originate from the Outlook PID.</span></span>

- <span data-ttu-id="3cf5d-147">**Indicateurs de compromission des formulaires personnalisés**:</span><span class="sxs-lookup"><span data-stu-id="3cf5d-147">**Indicators of the Custom forms compromise**:</span></span>
  - <span data-ttu-id="3cf5d-148">Les formulaires personnalisés présents sont enregistrés en tant que classe de message.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-148">Custom forms present saved as their own message class.</span></span>
  - <span data-ttu-id="3cf5d-149">La classe de message contient du code exécutable.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-149">Message class contains executable code.</span></span>
  - <span data-ttu-id="3cf5d-150">En règle générale, les formulaires malveillants sont stockés dans des dossiers de la bibliothèque de formulaires personnels ou de la boîte de réception.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-150">Typically, malicious forms are stored in Personal Forms Library or Inbox folders.</span></span>
  - <span data-ttu-id="3cf5d-151">Le formulaire est nommé IPM. Remarque. [nom personnalisé].</span><span class="sxs-lookup"><span data-stu-id="3cf5d-151">Form is named IPM.Note.[custom name].</span></span>

## <a name="steps-for-finding-signs-of-this-attack-and-confirming-it"></a><span data-ttu-id="3cf5d-152">Étapes de recherche et de confirmation de cette attaque</span><span class="sxs-lookup"><span data-stu-id="3cf5d-152">Steps for finding signs of this attack and confirming it</span></span>

<span data-ttu-id="3cf5d-153">Vous pouvez utiliser l’une des méthodes suivantes pour confirmer l’attaque :</span><span class="sxs-lookup"><span data-stu-id="3cf5d-153">You can use either of the following methods to confirm the attack:</span></span>

- <span data-ttu-id="3cf5d-154">Examinez manuellement les règles et les formulaires pour chaque boîte aux lettres à l’aide du client Outlook.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-154">Manually examine the rules and forms for each mailbox using the Outlook client.</span></span> <span data-ttu-id="3cf5d-155">Cette méthode est minutieuse, mais vous ne pouvez vérifier qu’une seule boîte aux lettres à la fois.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-155">This method is thorough, but you can only check one mailbox at a time.</span></span> <span data-ttu-id="3cf5d-156">Cette méthode peut prendre beaucoup de temps si vous avez de nombreux utilisateurs à vérifier et peut également infecter l’ordinateur que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-156">This method can be very time consuming if you have many users to check, and might also infect the computer that you're using.</span></span>

- <span data-ttu-id="3cf5d-157">Utilisez le script [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell pour vider automatiquement toutes les règles de forwarding de courrier et les formulaires personnalisés pour tous les utilisateurs de votre location.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-157">Use the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script to automatically dump all the mail forwarding rules and custom forms for all the users in your tenancy.</span></span> <span data-ttu-id="3cf5d-158">Il s’agit de la méthode la plus rapide et la plus sûre avec la charge de traitement la moins importante.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-158">This is the fastest and safest method with the least amount of overhead.</span></span>

### <a name="confirm-the-rules-attack-using-the-outlook-client"></a><span data-ttu-id="3cf5d-159">Confirmer l’attaque par règles à l’aide du client Outlook</span><span class="sxs-lookup"><span data-stu-id="3cf5d-159">Confirm the Rules Attack Using the Outlook client</span></span>

1. <span data-ttu-id="3cf5d-160">Ouvrez le client Outlook des utilisateurs en tant qu’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-160">Open the users Outlook client as the user.</span></span> <span data-ttu-id="3cf5d-161">L’utilisateur peut avoir besoin de votre aide pour examiner les règles de sa boîte aux lettres.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-161">The user may need your help in examining the rules on their mailbox.</span></span>

2. <span data-ttu-id="3cf5d-162">[Reportez-vous à l’article](https://support.microsoft.com/office/c24f5dea-9465-4df4-ad17-a50704d66c59) Gérer les messages électroniques à l’aide de l’article règles pour les procédures d’ouverture de l’interface de règles dans Outlook.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-162">Refer to [Manage email messages by using rules](https://support.microsoft.com/office/c24f5dea-9465-4df4-ad17-a50704d66c59) article for the procedures on how to open the rules interface in Outlook.</span></span>

3. <span data-ttu-id="3cf5d-163">Recherchez les règles que l’utilisateur n’a pas créés, ou les règles ou règles inattendues avec des noms suspects.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-163">Look for rules that the user did not create, or any unexpected rules or rules with suspicious names.</span></span>

4. <span data-ttu-id="3cf5d-164">Dans la description de la règle, recherchez les actions de règle qui démarrent et s’applicationnt ou font référence à un . EXE, . Fichier ZIP ou lancement d’une URL.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-164">Look in the rule description for rule actions that start and application or refer to an .EXE, .ZIP file or to launching a URL.</span></span>

5. <span data-ttu-id="3cf5d-165">Recherchez les nouveaux processus qui commencent à utiliser l’ID de processus Outlook.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-165">Look for any new processes that start using the Outlook process ID.</span></span> <span data-ttu-id="3cf5d-166">Reportez-vous [à Rechercher l’ID de processus.](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id)</span><span class="sxs-lookup"><span data-stu-id="3cf5d-166">Refer to [Find the Process ID](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id).</span></span>

### <a name="steps-to-confirm-the-forms-attack-using-the-outlook-client"></a><span data-ttu-id="3cf5d-167">Étapes de confirmation de l’attaque par formulaires à l’aide du client Outlook</span><span class="sxs-lookup"><span data-stu-id="3cf5d-167">Steps to confirm the Forms attack using the Outlook client</span></span>

1. <span data-ttu-id="3cf5d-168">Ouvrez le client Outlook de l’utilisateur en tant qu’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-168">Open the user Outlook client as the user.</span></span>

2. <span data-ttu-id="3cf5d-169">Suivez les étapes de la procédure [, Afficher l’onglet Développeur](https://support.microsoft.com/office/e1192344-5e56-4d45-931b-e5fd9bea2d45) pour la version d’Outlook de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-169">Follow the steps in, [Show the Developer tab](https://support.microsoft.com/office/e1192344-5e56-4d45-931b-e5fd9bea2d45) for the user's version of Outlook.</span></span>

3. <span data-ttu-id="3cf5d-170">Ouvrez l’onglet développeur désormais visible dans Outlook et cliquez **sur Concevoir un formulaire.**</span><span class="sxs-lookup"><span data-stu-id="3cf5d-170">Open the now visible developer tab in Outlook and click **design a form**.</span></span>

4. <span data-ttu-id="3cf5d-171">Sélectionnez **la boîte de réception** dans la liste **Rechercher** dans.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-171">Select the **Inbox** from the **Look In** list.</span></span> <span data-ttu-id="3cf5d-172">Recherchez les formulaires personnalisés.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-172">Look for any custom forms.</span></span> <span data-ttu-id="3cf5d-173">Les formulaires personnalisés sont suffisamment rares pour que si vous avez des formulaires personnalisés, cela vaut la peine d’avoir une apparence plus approfondie.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-173">Custom forms are rare enough that if you have any custom forms at all, it is worth a deeper look.</span></span>

5. <span data-ttu-id="3cf5d-174">Examinez tous les formulaires personnalisés, en particulier ceux marqués comme masqués.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-174">Investigate any custom forms, especially those marked as hidden.</span></span>

6. <span data-ttu-id="3cf5d-175">Ouvrez tous les formulaires personnalisés et, dans le groupe **Formulaire,** cliquez sur Afficher le **code** pour voir ce qui s’exécute lorsque le formulaire est chargé.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-175">Open any custom forms and in the **Form** group click **View Code** to see what runs when the form is loaded.</span></span>

### <a name="steps-to-confirm-the-rules-and-forms-attack-using-powershell"></a><span data-ttu-id="3cf5d-176">Étapes de confirmation de l’attaque par règles et formulaires à l’aide de PowerShell</span><span class="sxs-lookup"><span data-stu-id="3cf5d-176">Steps to confirm the Rules and Forms attack using PowerShell</span></span>

<span data-ttu-id="3cf5d-177">Le moyen le plus simple de vérifier une attaque par des règles ou des formulaires personnalisés consiste à exécuter [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) script PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-177">The simplest way to verify a rules or custom forms attack is to run the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script.</span></span> <span data-ttu-id="3cf5d-178">Ce script se connecte à chaque boîte aux lettres de votre client et vide toutes les règles et formulaires dans deux fichiers .csv.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-178">This script connects to every mailbox in your tenant and dumps all the rules and forms into two .csv files.</span></span>

#### <a name="pre-requisites"></a><span data-ttu-id="3cf5d-179">Conditions préalables</span><span class="sxs-lookup"><span data-stu-id="3cf5d-179">Pre-requisites</span></span>

<span data-ttu-id="3cf5d-180">Vous devez avoir des droits d’administrateur général pour exécuter le script, car il se connecte à chaque boîte aux lettres de la location pour lire les règles et les formulaires.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-180">You will need to have global administrator rights to run the script because the script connects to every mailbox in the tenancy to read the rules and forms.</span></span>

1. <span data-ttu-id="3cf5d-181">Connectez-vous à l’ordinateur à partir de qui vous exécuterez le script avec des droits d’administrateur local.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-181">Sign in to the machine that you will run the script from with local administrator rights.</span></span>

2. <span data-ttu-id="3cf5d-182">Téléchargez ou copiez le script Get-AllTenantRulesAndForms.ps1 à partir de GitHub dans un dossier à partir duquel vous l’exécuterez.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-182">Download or copy the Get-AllTenantRulesAndForms.ps1 script from GitHub to a folder from which you will run it.</span></span> <span data-ttu-id="3cf5d-183">Le script crée deux fichiers horodatés dans ce dossier, MailboxFormsExport-yyyy-mm-dd.csv et MailboxRulesExport-yyyy-mm-dd.csv.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-183">The script will create two date stamped files to this folder, MailboxFormsExport-yyyy-mm-dd.csv, and MailboxRulesExport-yyyy-mm-dd.csv.</span></span>

3. <span data-ttu-id="3cf5d-184">Ouvrez une instance PowerShell en tant qu’administrateur et ouvrez le dossier dans qui vous avez enregistré le script.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-184">Open a PowerShell instance as an administrator and open the folder you saved the script to.</span></span>

4. <span data-ttu-id="3cf5d-185">Exécutez cette ligne de commande PowerShell comme `.\Get-AllTenantRulesAndForms.ps1` suit.\Get-AllTenantRulesAndForms.ps1</span><span class="sxs-lookup"><span data-stu-id="3cf5d-185">Run this PowerShell command line as follows `.\Get-AllTenantRulesAndForms.ps1`.\Get-AllTenantRulesAndForms.ps1</span></span>

#### <a name="interpreting-the-output"></a><span data-ttu-id="3cf5d-186">Interprétation de la sortie</span><span class="sxs-lookup"><span data-stu-id="3cf5d-186">Interpreting the output</span></span>

- <span data-ttu-id="3cf5d-187">**MailboxRulesExport-*yyyy-mm-dd*.csv**: examinez les règles (une par ligne) pour les conditions d’action qui incluent des applications ou des exécutables :</span><span class="sxs-lookup"><span data-stu-id="3cf5d-187">**MailboxRulesExport-*yyyy-mm-dd*.csv**: Examine the rules (one per row) for action conditions that include applications or executables:</span></span>

  - <span data-ttu-id="3cf5d-188">**ActionType (colonne A)**: si vous voyez la valeur « ID_ACTION_CUSTOM », la règle est probablement malveillante.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-188">**ActionType (column A)**: If you see the value "ID_ACTION_CUSTOM", the rule is likely malicious.</span></span>

  - <span data-ttu-id="3cf5d-189">**IsPotentiallyMalicious (colonne D)**: si cette valeur est « TRUE », la règle est probablement malveillante.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-189">**IsPotentiallyMalicious (column D)**: If this value is "TRUE", the rule is likely malicious.</span></span>

  - <span data-ttu-id="3cf5d-190">**ActionCommand (colonne G)**: si cette colonne répertorie une application ou un fichier avec des extensions .exe ou .zip, ou une entrée inconnue qui fait référence à une URL, la règle est probablement malveillante.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-190">**ActionCommand (column G)**: If this column lists an application or any file with .exe or .zip extensions, or an unknown entry that refers to a URL, the rule is likely malicious.</span></span>

- <span data-ttu-id="3cf5d-191">**MailboxFormsExport-*yyyy-mm-dd*.csv**: en général, l’utilisation de formulaires personnalisés est rare.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-191">**MailboxFormsExport-*yyyy-mm-dd*.csv**: In general, the use of custom forms is rare.</span></span> <span data-ttu-id="3cf5d-192">Si vous en trouvez dans ce workbook, vous ouvrez la boîte aux lettres de cet utilisateur et examinez le formulaire lui-même.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-192">If you find any in this workbook, you open that user's mailbox and examine the form itself.</span></span> <span data-ttu-id="3cf5d-193">Si votre organisation ne l’a pas placé intentionnellement, il est probablement malveillant.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-193">If your organization did not put it there intentionally, it is likely malicious.</span></span>

## <a name="how-to-stop-and-remediate-the-outlook-rules-and-forms-attack"></a><span data-ttu-id="3cf5d-194">Comment arrêter et corriger les attaques par formulaires et règles Outlook</span><span class="sxs-lookup"><span data-stu-id="3cf5d-194">How to stop and remediate the Outlook Rules and Forms attack</span></span>

<span data-ttu-id="3cf5d-195">Si vous trouvez des preuves de l’une de ces attaques, la correction est simple, supprimez simplement la règle ou le formulaire de la boîte aux lettres.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-195">If you find any evidence of either of these attacks, remediation is simple, just delete the rule or form from the mailbox.</span></span> <span data-ttu-id="3cf5d-196">Vous pouvez le faire avec le client Outlook ou à l’aide de PowerShell à distance pour supprimer des règles.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-196">You can do this with the Outlook client or using remote PowerShell to remove rules.</span></span>

### <a name="using-outlook"></a><span data-ttu-id="3cf5d-197">Utilisation d’Outlook</span><span class="sxs-lookup"><span data-stu-id="3cf5d-197">Using Outlook</span></span>

1. <span data-ttu-id="3cf5d-198">Identifiez tous les appareils que l’utilisateur a utilisés avec Outlook.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-198">Identify all the devices that the user has used with Outlook.</span></span> <span data-ttu-id="3cf5d-199">Ils devront tous être nettoyés des programmes malveillants potentiels.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-199">They will all need to be cleaned of potential malware.</span></span> <span data-ttu-id="3cf5d-200">N’autorisez pas l’utilisateur à se connecter et à utiliser le courrier tant que tous les appareils n’ont pas été nettoyés.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-200">Do not allow the user to sign on and use email until all the devices are cleaned.</span></span>

2. <span data-ttu-id="3cf5d-201">Suivez les étapes de [la procédure de suppression d’une règle](https://support.microsoft.com/office/2f0e7139-f696-4422-8498-44846db9067f) pour chaque appareil.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-201">Follow the steps in [Delete a rule](https://support.microsoft.com/office/2f0e7139-f696-4422-8498-44846db9067f) for each device.</span></span>

3. <span data-ttu-id="3cf5d-202">Si vous n’êtes pas sûr de la présence d’autres programmes malveillants, vous pouvez formater et réinstaller tous les logiciels sur l’appareil.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-202">If you are unsure about the presence of other malware, you can format and reinstall all the software on the device.</span></span> <span data-ttu-id="3cf5d-203">Pour les appareils mobiles, vous pouvez suivre les étapes des fabricants pour réinitialiser l’appareil à l’image d’usine.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-203">For mobile devices, you can follow the manufacturers steps to reset the device to the factory image.</span></span>

4. <span data-ttu-id="3cf5d-204">Installez les versions les plus récentes d’Outlook.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-204">Install the most up-to-date versions of Outlook.</span></span> <span data-ttu-id="3cf5d-205">N’oubliez pas que la version actuelle d’Outlook bloque les deux types d’attaque par défaut.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-205">Remember that the current version of Outlook blocks both types of this attack by default.</span></span>

5. <span data-ttu-id="3cf5d-206">Une fois toutes les copies hors connexion de la boîte aux lettres supprimées, réinitialisez le mot de passe de l’utilisateur (utilisez une copie de haute qualité) et suivez les étapes de l’authentification [multifacteur](../../admin/security-and-compliance/set-up-multi-factor-authentication.md) du programme d’installation pour les utilisateurs si l’authentification multifacteur n’a pas encore été activée.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-206">Once all offline copies of the mailbox have been removed, reset the user's password (use a high quality one) and follow the steps in [Setup multi-factor authentication for users](../../admin/security-and-compliance/set-up-multi-factor-authentication.md) if MFA has not already been enabled.</span></span> <span data-ttu-id="3cf5d-207">Cela garantit que les informations d’identification de l’utilisateur ne sont pas exposées par d’autres moyens (par exemple, hameçonnage ou nouvelle utilisation du mot de passe).</span><span class="sxs-lookup"><span data-stu-id="3cf5d-207">This ensures that the user's credentials are not exposed via other means (such as phishing or password re-use).</span></span>

### <a name="using-powershell"></a><span data-ttu-id="3cf5d-208">Utiliser PowerShell</span><span class="sxs-lookup"><span data-stu-id="3cf5d-208">Using PowerShell</span></span>

<span data-ttu-id="3cf5d-209">Il existe deux cmdlets PowerShell distantes que vous pouvez utiliser pour supprimer ou désactiver des règles dangereuses.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-209">There are two remote PowerShell cmdlets you can use to remove or disable dangerous rules.</span></span> <span data-ttu-id="3cf5d-210">Suivez simplement les étapes.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-210">Just follow the steps.</span></span>

#### <a name="steps-for-mailboxes-that-are-on-an-exchange-server"></a><span data-ttu-id="3cf5d-211">Étapes pour les boîtes aux lettres sur un serveur Exchange</span><span class="sxs-lookup"><span data-stu-id="3cf5d-211">Steps for mailboxes that are on an Exchange server</span></span>

1. <span data-ttu-id="3cf5d-212">Connectez-vous au serveur Exchange à l’aide de PowerShell à distance.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-212">Connect to the Exchange server using remote PowerShell.</span></span> <span data-ttu-id="3cf5d-213">Suivez les étapes de [la procédure de connexion à des serveurs Exchange à l’aide de PowerShell à distance.](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-servers-using-remote-powershell)</span><span class="sxs-lookup"><span data-stu-id="3cf5d-213">Follow the steps in [Connect to Exchange servers using remote PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-servers-using-remote-powershell).</span></span>

2. <span data-ttu-id="3cf5d-214">Si vous souhaitez supprimer complètement une règle unique, plusieurs règles ou toutes les règles d’une boîte aux lettres, utilisez la cmdlet [Remove-InboxRule.](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule)</span><span class="sxs-lookup"><span data-stu-id="3cf5d-214">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-InboxRule](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule) cmdlet.</span></span>

3. <span data-ttu-id="3cf5d-215">Si vous souhaitez conserver la règle et son contenu pour un examen plus approfondie, utilisez la cmdlet [Disable-InboxRule.](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule)</span><span class="sxs-lookup"><span data-stu-id="3cf5d-215">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule) cmdlet.</span></span>

#### <a name="steps-for-mailboxes-in-exchange-online"></a><span data-ttu-id="3cf5d-216">Étapes pour les boîtes aux lettres dans Exchange Online</span><span class="sxs-lookup"><span data-stu-id="3cf5d-216">Steps for mailboxes in Exchange Online</span></span>

1. <span data-ttu-id="3cf5d-217">Suivez les étapes de [la procédure de connexion à Exchange Online à l’aide de PowerShell.](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell)</span><span class="sxs-lookup"><span data-stu-id="3cf5d-217">Follow the steps in [Connect to Exchange Online using PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell).</span></span>

2. <span data-ttu-id="3cf5d-218">Si vous souhaitez supprimer complètement une règle unique, plusieurs règles ou toutes les règles d’une boîte aux lettres, utilisez la cmdlet [Remove-Inbox Rule.](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule)</span><span class="sxs-lookup"><span data-stu-id="3cf5d-218">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-Inbox Rule](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule) cmdlet.</span></span>

3. <span data-ttu-id="3cf5d-219">Si vous souhaitez conserver la règle et son contenu pour un examen plus approfondie, utilisez la cmdlet [Disable-InboxRule.](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule)</span><span class="sxs-lookup"><span data-stu-id="3cf5d-219">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule) cmdlet.</span></span>

## <a name="how-to-minimize-future-attacks"></a><span data-ttu-id="3cf5d-220">Comment réduire les attaques futures</span><span class="sxs-lookup"><span data-stu-id="3cf5d-220">How to minimize future attacks</span></span>

### <a name="first-protect-your-accounts"></a><span data-ttu-id="3cf5d-221">Tout d’abord : protéger vos comptes</span><span class="sxs-lookup"><span data-stu-id="3cf5d-221">First: protect your accounts</span></span>

<span data-ttu-id="3cf5d-222">Les attaques par règles et formulaires sont utilisées uniquement par une personne malveillante après le vol ou la violation de l’un des comptes de votre utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-222">The Rules and Forms exploits are only used by an attacker after they have stolen or breached one of your user's accounts.</span></span> <span data-ttu-id="3cf5d-223">Par conséquent, la première étape pour empêcher l’utilisation de ces attaques contre votre organisation consiste à protéger de manière agressive vos comptes d’utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-223">So, your first step to preventing the use of these exploits against your organization is to aggressively protect your user accounts.</span></span> <span data-ttu-id="3cf5d-224">Certaines des façons les plus courantes d’enfreiner les comptes sont par le biais d’attaques par hameçonnage ou par pulvérisation [de mots de passe.](https://www.microsoft.com/security/blog/2020/04/23/protecting-organization-password-spray-attacks/)</span><span class="sxs-lookup"><span data-stu-id="3cf5d-224">Some of the most common ways that accounts are breached are through phishing or [password spray attacks](https://www.microsoft.com/security/blog/2020/04/23/protecting-organization-password-spray-attacks/).</span></span>

<span data-ttu-id="3cf5d-225">La meilleure façon de protéger vos comptes d’utilisateur, et en particulier vos comptes d’administrateur, consiste à configurer l’authentification [multifacteur pour les utilisateurs.](../../admin/security-and-compliance/set-up-multi-factor-authentication.md)</span><span class="sxs-lookup"><span data-stu-id="3cf5d-225">The best way to protect your user accounts, and especially your administrator accounts, is to [set up multi-factor authentication for users](../../admin/security-and-compliance/set-up-multi-factor-authentication.md).</span></span> <span data-ttu-id="3cf5d-226">Vous devez également :</span><span class="sxs-lookup"><span data-stu-id="3cf5d-226">You should also:</span></span>

- <span data-ttu-id="3cf5d-227">Surveillez l’accès et l’utilisation de [vos comptes d’utilisateur.](https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports)</span><span class="sxs-lookup"><span data-stu-id="3cf5d-227">Monitor how your user accounts are [accessed and used](https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports).</span></span> <span data-ttu-id="3cf5d-228">Vous n’empêcherez peut-être pas la violation initiale, mais vous raccourcirez la durée et l’impact de la violation en la détectant plus rapidement.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-228">You may not prevent the initial breach, but you will shorten the duration and the impact of the breach by detecting it sooner.</span></span> <span data-ttu-id="3cf5d-229">Vous pouvez utiliser ces stratégies de sécurité des applications cloud [Office 365](https://docs.microsoft.com/cloud-app-security/what-is-cloud-app-security) pour surveiller vos comptes et vous alerter sur les activités inhabituelles :</span><span class="sxs-lookup"><span data-stu-id="3cf5d-229">You can use these [Office 365 Cloud App Security policies](https://docs.microsoft.com/cloud-app-security/what-is-cloud-app-security) to monitor you accounts and alert on unusual activity:</span></span>

  - <span data-ttu-id="3cf5d-230">**Plusieurs tentatives** de connexion ayant échoué : cette stratégie profile votre environnement et déclenche des alertes lorsque les utilisateurs effectuent plusieurs activités de connexion ayant échoué en une seule session par rapport à la ligne de base acquise, ce qui peut indiquer une tentative de violation.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-230">**Multiple failed login attempts**: This policy profiles your environment and triggers alerts when users perform multiple failed login activities in a single session with respect to the learned baseline, which could indicate an attempted breach.</span></span>

  - <span data-ttu-id="3cf5d-231">**Voyage impossible**: cette stratégie profile votre environnement et déclenche des alertes lorsque des activités sont détectées par le même utilisateur à différents emplacements dans une période plus courte que le temps de déplacement prévu entre les deux emplacements.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-231">**Impossible travel**: This policy profiles your environment and triggers alerts when activities are detected from the same user in different locations within a time period that is shorter than the expected travel time between the two locations.</span></span> <span data-ttu-id="3cf5d-232">Cela peut indiquer qu’un autre utilisateur utilise les mêmes informations d’identification.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-232">This could indicate that a different user is using the same credentials.</span></span> <span data-ttu-id="3cf5d-233">La détection de ce comportement anormal nécessite une période d’apprentissage initiale de sept jours au cours de laquelle elle apprend le modèle d’activité d’un nouvel utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-233">Detecting this anomalous behavior necessitates an initial learning period of seven days during which it learns a new user's activity pattern.</span></span>

  - <span data-ttu-id="3cf5d-234">Activité d’emprunt d’identité inhabituelle **(par utilisateur)**: cette stratégie profile votre environnement et déclenche des alertes lorsque les utilisateurs effectuent plusieurs activités usurpées d’identité dans une même session en respectant la ligne de base acquise, ce qui peut indiquer une tentative de violation.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-234">**Unusual impersonated activity (by user)**: This policy profiles your environment and triggers alerts when users perform multiple impersonated activities in a single session with respect to the baseline learned, which could indicate an attempted breach.</span></span>

- <span data-ttu-id="3cf5d-235">Utilisez un outil tel [qu’Office 365 Secure Score](https://securescore.office.com/) pour gérer les configurations et comportements de sécurité des comptes.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-235">Use a tool like [Office 365 Secure Score](https://securescore.office.com/) to manage account security configurations and behaviors.</span></span>

### <a name="second-keep-your-outlook-clients-current"></a><span data-ttu-id="3cf5d-236">Deuxième : maintenir vos clients Outlook à jour</span><span class="sxs-lookup"><span data-stu-id="3cf5d-236">Second: Keep your Outlook clients current</span></span>

<span data-ttu-id="3cf5d-237">Les versions entièrement mises à jour et mises à jour d’Outlook 2013 et 2016 désactivent l’action de formulaire/règle « Démarrer l’application » par défaut.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-237">Fully updated and patched versions of Outlook 2013, and 2016 disable the "Start Application" rule/form action by default.</span></span> <span data-ttu-id="3cf5d-238">Cela garantit que même si un attaquant enfreint le compte, les actions de règle et de formulaire seront bloquées.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-238">This will ensure that even if an attacker breaches the account, the rule and form actions will be blocked.</span></span> <span data-ttu-id="3cf5d-239">Vous pouvez installer les dernières mises à jour et correctifs de sécurité en suivant les étapes de l’installation des mises [à jour d’Office.](https://support.microsoft.com/office/2ab296f3-7f03-43a2-8e50-46de917611c5)</span><span class="sxs-lookup"><span data-stu-id="3cf5d-239">You can install the latest updates and security patches by following the steps in [Install Office updates](https://support.microsoft.com/office/2ab296f3-7f03-43a2-8e50-46de917611c5).</span></span>

<span data-ttu-id="3cf5d-240">Voici les versions des correctifs pour vos clients Outlook 2013 et 2016 :</span><span class="sxs-lookup"><span data-stu-id="3cf5d-240">Here are the patch versions for your Outlook 2013 and 2016 clients:</span></span>

- <span data-ttu-id="3cf5d-241">**Outlook 2016**: 16.0.4534.1001 ou supérieur.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-241">**Outlook 2016**: 16.0.4534.1001 or greater.</span></span>

- <span data-ttu-id="3cf5d-242">**Outlook 2013**: 15.0.4937.1000 ou supérieur.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-242">**Outlook 2013**: 15.0.4937.1000 or greater.</span></span>

<span data-ttu-id="3cf5d-243">Pour plus d’informations sur les correctifs de sécurité individuels, voir :</span><span class="sxs-lookup"><span data-stu-id="3cf5d-243">For more information on the individual security patches, see:</span></span>

- [<span data-ttu-id="3cf5d-244">Correctif de sécurité Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="3cf5d-244">Outlook 2016 Security Patch</span></span>](https://support.microsoft.com/help/3191883)

- [<span data-ttu-id="3cf5d-245">Correctif de sécurité Outlook 2013</span><span class="sxs-lookup"><span data-stu-id="3cf5d-245">Outlook 2013 Security Patch</span></span>](https://support.microsoft.com/help/3191938)

### <a name="third-monitor-your-outlook-clients"></a><span data-ttu-id="3cf5d-246">Troisième : surveiller vos clients Outlook</span><span class="sxs-lookup"><span data-stu-id="3cf5d-246">Third: Monitor your Outlook clients</span></span>

<span data-ttu-id="3cf5d-247">Notez que même avec les correctifs et mises à jour installés, il est possible pour un attaquant de modifier la configuration de l’ordinateur local afin de ré-activer le comportement « Démarrer l’application ».</span><span class="sxs-lookup"><span data-stu-id="3cf5d-247">Note that even with the patches and updates installed, it is possible for an attacker to change the local machine configuration to re-enable the "Start Application" behavior.</span></span> <span data-ttu-id="3cf5d-248">Vous pouvez utiliser la [gestion avancée des stratégies de](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/) groupe pour surveiller et appliquer des stratégies d’ordinateur local sur vos clients.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-248">You can use [Advanced Group Policy Management](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/) to monitor and enforce local machine policies on your clients.</span></span>

<span data-ttu-id="3cf5d-249">Vous pouvez voir si « Démarrer l’application » a été ré-activé via une substitution dans le Registre à l’aide des informations de la procédure d’affichage du Registre système à l’aide de [versions 64 bits](https://support.microsoft.com/help/305097)de Windows.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-249">You can see if "Start Application" has been re-enabled through an override in the registry by using the information in [How to view the system registry by using 64-bit versions of Windows](https://support.microsoft.com/help/305097).</span></span> <span data-ttu-id="3cf5d-250">Vérifiez les sous-clés ci-après :</span><span class="sxs-lookup"><span data-stu-id="3cf5d-250">Check these subkeys:</span></span>

- <span data-ttu-id="3cf5d-251">**Outlook 2016**: `HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\`</span><span class="sxs-lookup"><span data-stu-id="3cf5d-251">**Outlook 2016**: `HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\`</span></span>

- <span data-ttu-id="3cf5d-252">**Outlook 2013**: `HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\`</span><span class="sxs-lookup"><span data-stu-id="3cf5d-252">**Outlook 2013**: `HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\`</span></span>

<span data-ttu-id="3cf5d-253">Recherchez la clé EnableUnsafeClientMailRules.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-253">Look for the key EnableUnsafeClientMailRules.</span></span> <span data-ttu-id="3cf5d-254">Si elle est présente et est définie sur 1, le correctif de sécurité Outlook a été mis en place et l’ordinateur est vulnérable à l’attaque par formulaire/règles.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-254">If it is there and is set to 1, the Outlook security patch has been overridden and the computer is vulnerable to the Form/Rules attack.</span></span> <span data-ttu-id="3cf5d-255">Si la valeur est 0, l’action « Démarrer l’application » est désactivée.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-255">If the value is 0, the "Start Application" action is disabled.</span></span> <span data-ttu-id="3cf5d-256">Si la version mise à jour et corrigé d’Outlook est installée et que cette clé de Registre n’est pas présente, un système n’est pas vulnérable à ces attaques.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-256">If the updated and patched version of Outlook is installed and this registry key is not present, then a system is not vulnerable to these attacks.</span></span>

<span data-ttu-id="3cf5d-257">Les clients qui disposent d’installations Exchange sur site doivent envisager de bloquer les versions antérieures d’Outlook qui ne disposent pas de correctifs.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-257">Customers with on-premises Exchange installations should consider blocking older versions of Outlook that do not have patches available.</span></span> <span data-ttu-id="3cf5d-258">Pour plus d’informations sur ce processus, voir l’article [Configurer le blocage du client Outlook.](https://docs.microsoft.com/exchange/configure-outlook-client-blocking-exchange-2013-help)</span><span class="sxs-lookup"><span data-stu-id="3cf5d-258">Details on this process can be found in the article [Configure Outlook client blocking](https://docs.microsoft.com/exchange/configure-outlook-client-blocking-exchange-2013-help).</span></span>

## <a name="secure-microsoft-365-like-a-cybersecurity-pro"></a><span data-ttu-id="3cf5d-259">Sécuriser Microsoft 365 comme un pro de la cyber-sécurité</span><span class="sxs-lookup"><span data-stu-id="3cf5d-259">Secure Microsoft 365 like a cybersecurity pro</span></span>

<span data-ttu-id="3cf5d-260">Votre abonnement Microsoft 365 inclut un ensemble puissant de fonctionnalités de sécurité que vous pouvez utiliser pour protéger vos données et vos utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-260">Your Microsoft 365 subscription comes with a powerful set of security capabilities that you can use to protect your data and your users.</span></span> <span data-ttu-id="3cf5d-261">Utilisez la [Feuille de route du Centre de sécurité Microsoft 365 : principales priorités pour les 30 premiers jours, 90 premiers jours et au-delà](security-roadmap.md), pour implémenter les meilleures pratiques recommandées par Microsoft pour sécuriser votre client Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-261">Use the [Microsoft 365 security roadmap - Top priorities for the first 30 days, 90 days, and beyond](security-roadmap.md) to implement Microsoft recommended best practices for securing your Microsoft 365 tenant.</span></span>

- <span data-ttu-id="3cf5d-262">Tâches à effectuer lors des 30 premiers jours.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-262">Tasks to accomplish in the first 30 days.</span></span> <span data-ttu-id="3cf5d-263">Celles-ci ont un effet immédiat et ont un faible impact sur vos utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-263">These have immediate effect and are low-impact to your users.</span></span>

- <span data-ttu-id="3cf5d-264">Tâches à accomplir dans les 90 premiers jours.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-264">Tasks to accomplish in 90 days.</span></span> <span data-ttu-id="3cf5d-265">Ces tâches prennent un peu plus de temps à planifier et à implémenter, mais augmentent considérablement votre sécurité.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-265">These take a bit more time to plan and implement but greatly improve your security posture.</span></span>

- <span data-ttu-id="3cf5d-266">Au-delà de 90 jours.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-266">Beyond 90 days.</span></span> <span data-ttu-id="3cf5d-267">Ces améliorations sont à mettre en place pendant les 90 premiers jours.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-267">These enhancements build in your first 90 days work.</span></span>

## <a name="see-also"></a><span data-ttu-id="3cf5d-268">Voir aussi :</span><span class="sxs-lookup"><span data-stu-id="3cf5d-268">See also:</span></span>

- <span data-ttu-id="3cf5d-269">[Le billet sur les règles Outlook](https://silentbreaksecurity.com/malicious-outlook-rules/) malveillantes par le billet de sécurité SilentBreak sur le vecteur de règles fournit un examen détaillé de la façon dont les règles Outlook.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-269">[Malicious Outlook Rules](https://silentbreaksecurity.com/malicious-outlook-rules/) by SilentBreak Security Post about Rules Vector provides a detailed review of how the Outlook Rules.</span></span>

- <span data-ttu-id="3cf5d-270">[MAPI sur HTTP et Mailrule Pwnage](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) sur le blog Sensepost sur Mailrule Pwnage traite d’un outil appelé Ruler qui vous permet d’exploiter des boîtes aux lettres via des règles Outlook.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-270">[MAPI over HTTP and Mailrule Pwnage](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) on the Sensepost blog about Mailrule Pwnage discusses a tool called Ruler that lets you exploit mailboxes through Outlook rules.</span></span>

- <span data-ttu-id="3cf5d-271">[Formulaires et shells Outlook](https://sensepost.com/blog/2017/outlook-forms-and-shells/) sur le blog Sensepost sur le vecteur de menace de formulaires.</span><span class="sxs-lookup"><span data-stu-id="3cf5d-271">[Outlook forms and shells](https://sensepost.com/blog/2017/outlook-forms-and-shells/) on the Sensepost blog about Forms Threat Vector.</span></span>

- [<span data-ttu-id="3cf5d-272">Ruler Codebase</span><span class="sxs-lookup"><span data-stu-id="3cf5d-272">Ruler Codebase</span></span>](https://github.com/sensepost/ruler)

- [<span data-ttu-id="3cf5d-273">Indicateurs de règle de compromis</span><span class="sxs-lookup"><span data-stu-id="3cf5d-273">Ruler Indicators of Compromise</span></span>](https://github.com/sensepost/notruler/blob/master/iocs.md)
