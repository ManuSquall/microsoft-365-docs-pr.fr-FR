---
title: Détecter et corriger les octrois de consentement illicites
f1.keywords:
- NOCSH
ms.author: tracyp
author: MSFTTracyp
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: article
ms.collection:
- o365_security_incident_response
- M365-security-compliance
localization_priority: Normal
search.appverid:
- MET150
description: Découvrez comment reconnaître et corriger les attaques par consentement illicite dans Microsoft Office 365.
ms.custom: seo-marvel-apr2020
ms.technology: mdo
ms.prod: m365-security
ms.openlocfilehash: 4c3c3c06974feb2dab3985a60938fe7d543543c3
ms.sourcegitcommit: d904f04958a13a514ce10219ed822b9e4f74ca2d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/19/2021
ms.locfileid: "53028918"
---
# <a name="detect-and-remediate-illicit-consent-grants"></a><span data-ttu-id="bbc79-103">Détecter et corriger les octrois de consentement illicites</span><span class="sxs-lookup"><span data-stu-id="bbc79-103">Detect and Remediate Illicit Consent Grants</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]

<span data-ttu-id="bbc79-104">**S’applique à**</span><span class="sxs-lookup"><span data-stu-id="bbc79-104">**Applies to**</span></span>
- [<span data-ttu-id="bbc79-105">Microsoft Defender pour Office 365 : offre 1 et offre 2</span><span class="sxs-lookup"><span data-stu-id="bbc79-105">Microsoft Defender for Office 365 plan 1 and plan 2</span></span>](defender-for-office-365.md)
- [<span data-ttu-id="bbc79-106">Microsoft 365 Defender</span><span class="sxs-lookup"><span data-stu-id="bbc79-106">Microsoft 365 Defender</span></span>](../defender/microsoft-365-defender.md)

<span data-ttu-id="bbc79-107">**Résumé**  Découvrez comment reconnaître et corriger les attaques par consentement illicite dans Office 365.</span><span class="sxs-lookup"><span data-stu-id="bbc79-107">**Summary**  Learn how to recognize and remediate the illicit consent grants attack in Office 365.</span></span>

## <a name="what-is-the-illicit-consent-grant-attack-in-office-365"></a><span data-ttu-id="bbc79-108">Qu’est-ce que l’attaque par consentement illicite dans Office 365 ?</span><span class="sxs-lookup"><span data-stu-id="bbc79-108">What is the illicit consent grant attack in Office 365?</span></span>

<span data-ttu-id="bbc79-109">Dans le cas d’une attaque par consentement illicite, l’attaquant crée une application enregistrée par Azure qui demande l’accès à des données telles que des informations de contact, des e-mails ou des documents.</span><span class="sxs-lookup"><span data-stu-id="bbc79-109">In an illicit consent grant attack, the attacker creates an Azure-registered application that requests access to data such as contact information, email, or documents.</span></span> <span data-ttu-id="bbc79-110">L’attaquant astuces ensuite un utilisateur final pour accorder à cette application l’autorisation d’accéder à ses données par le biais d’une attaque par hameçonnage ou en injectant du code illicite dans un site web approuvé.</span><span class="sxs-lookup"><span data-stu-id="bbc79-110">The attacker then tricks an end user into granting that application consent to access their data either through a phishing attack, or by injecting illicit code into a trusted website.</span></span> <span data-ttu-id="bbc79-111">Une fois l’application illicite accordée, elle dispose d’un accès aux données au niveau du compte sans avoir besoin d’un compte d’organisation.</span><span class="sxs-lookup"><span data-stu-id="bbc79-111">After the illicit application has been granted consent, it has account-level access to data without the need for an organizational account.</span></span> <span data-ttu-id="bbc79-112">Les étapes de correction normales, telles que la réinitialisation des mots de passe pour les comptes en violation ou la nécessité d’une authentification multifacteur (MFA) sur les comptes, ne sont pas efficaces contre ce type d’attaque, car il s’agit d’applications tierces externes à l’organisation.</span><span class="sxs-lookup"><span data-stu-id="bbc79-112">Normal remediation steps, like resetting passwords for breached accounts or requiring Multi-Factor Authentication (MFA) on accounts, are not effective against this type of attack, since these are third-party applications and are external to the organization.</span></span>

<span data-ttu-id="bbc79-113">Ces attaques tirent parti d’un modèle d’interaction qui suppose que l’entité qui appelle les informations est une automatisation et non une personne.</span><span class="sxs-lookup"><span data-stu-id="bbc79-113">These attacks leverage an interaction model which presumes the entity that is calling the information is automation and not a human.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="bbc79-114">Pensez-vous que vous rencontrez des problèmes avec l’octroi illégal de consentement à partir d’une application, pour le moment ?</span><span class="sxs-lookup"><span data-stu-id="bbc79-114">Do you suspect you're experiencing problems with illicit consent-grants from an app, right now?</span></span> <span data-ttu-id="bbc79-115">Microsoft Cloud App Security (MCAS) dispose d’outils pour détecter, examiner et corriger vos applications OAuth.</span><span class="sxs-lookup"><span data-stu-id="bbc79-115">Microsoft Cloud App Security (MCAS) has tools to detect, investigate, and remediate your OAuth apps.</span></span> <span data-ttu-id="bbc79-116">Cet article MCAS présente un didacticiel qui explique comment examiner les applications [OAuth](/cloud-app-security/investigate-risky-oauth)à risque.</span><span class="sxs-lookup"><span data-stu-id="bbc79-116">This MCAS article has a tutorial that outlines how to go about [investigating risky OAuth apps](/cloud-app-security/investigate-risky-oauth).</span></span> <span data-ttu-id="bbc79-117">Vous pouvez également définir des stratégies d’application [OAuth](/cloud-app-security/app-permission-policy) pour examiner les autorisations demandées par l’application, les utilisateurs qui autorisent ces applications, et largement approuver ou interdire ces demandes d’autorisations.</span><span class="sxs-lookup"><span data-stu-id="bbc79-117">You can also set [OAuth app policies](/cloud-app-security/app-permission-policy) to investigate app-requested permissions, which users are authorizing these apps, and widely approve or ban these permissions requests.</span></span>

## <a name="what-does-an-illicit-consent-grant-attack-look-like-in-office-365"></a><span data-ttu-id="bbc79-118">À quoi ressemble une attaque d’octroi de consentement illicite dans Office 365 ?</span><span class="sxs-lookup"><span data-stu-id="bbc79-118">What does an illicit consent grant attack look like in Office 365?</span></span>

<span data-ttu-id="bbc79-119">Vous devez effectuer une recherche dans le journal **d’audit** pour trouver des signes, également appelés indicateurs de compromission (IOC) de cette attaque.</span><span class="sxs-lookup"><span data-stu-id="bbc79-119">You need to search the **audit log** to find signs, also called Indicators of Compromise (IOC) of this attack.</span></span> <span data-ttu-id="bbc79-120">Pour les organisations avec de nombreuses applications inscrites dans Azure et une base d’utilisateurs importante, la meilleure pratique consiste à examiner les octrois de consentement de votre organisation une fois par semaine.</span><span class="sxs-lookup"><span data-stu-id="bbc79-120">For organizations with many Azure-registered applications and a large user base, the best practice is to review your organizations consent grants on a weekly basis.</span></span>

### <a name="steps-for-finding-signs-of-this-attack"></a><span data-ttu-id="bbc79-121">Étapes de recherche des signes de cette attaque</span><span class="sxs-lookup"><span data-stu-id="bbc79-121">Steps for finding signs of this attack</span></span>

1. <span data-ttu-id="bbc79-122">Ouvrez **le portail Microsoft 365 Defender** sur <https://security.microsoft.com> .</span><span class="sxs-lookup"><span data-stu-id="bbc79-122">Open the **Microsoft 365 Defender** portal at <https://security.microsoft.com>.</span></span>

2. <span data-ttu-id="bbc79-123">Accédez à **Recherche et** sélectionnez Recherche dans le **journal d’audit.**</span><span class="sxs-lookup"><span data-stu-id="bbc79-123">Navigate to **Search** and select **Audit log search**.</span></span>

3. <span data-ttu-id="bbc79-124">Recherchez (toutes les activités et tous les utilisateurs), entrez la date de début et la date de fin si nécessaire, puis cliquez sur **Rechercher.**</span><span class="sxs-lookup"><span data-stu-id="bbc79-124">Search (all activities and all users) and enter the start date and end date if required and then click **Search**.</span></span>

4. <span data-ttu-id="bbc79-125">Cliquez **sur Filtrer les résultats** et entrez Consentement à l’application dans le **champ** Activité.</span><span class="sxs-lookup"><span data-stu-id="bbc79-125">Click **Filter results** and enter Consent to application in the **Activity** field.</span></span>

5. <span data-ttu-id="bbc79-126">Cliquez sur le résultat pour voir les détails de l’activité.</span><span class="sxs-lookup"><span data-stu-id="bbc79-126">Click on the result to see the details of the activity.</span></span> <span data-ttu-id="bbc79-127">Cliquez **sur Plus d’informations** pour obtenir des détails sur l’activité.</span><span class="sxs-lookup"><span data-stu-id="bbc79-127">Click **More Information** to get details of the activity.</span></span> <span data-ttu-id="bbc79-128">Vérifiez si IsAdminContent est définie sur True.</span><span class="sxs-lookup"><span data-stu-id="bbc79-128">Check to see if IsAdminContent is set to True.</span></span>

> [!NOTE]
>
> <span data-ttu-id="bbc79-129">L’affichage de l’entrée du journal d’audit correspondant dans les résultats de la recherche après un événement peut prendre entre 30 minutes et 24 heures.</span><span class="sxs-lookup"><span data-stu-id="bbc79-129">It can take from 30 minutes up to 24 hours for the corresponding audit log entry to be displayed in the search results after an event occurs.</span></span>
>
> <span data-ttu-id="bbc79-130">La durée de rétention et de recherche d’un enregistrement d’audit dans le journal d’audit dépend de votre abonnement Microsoft 365 et plus précisément du type de licence attribuée à un utilisateur spécifique.</span><span class="sxs-lookup"><span data-stu-id="bbc79-130">The length of time that an audit record is retained and searchable in the audit log depends on your Microsoft 365 subscription, and specifically the type of the license that is assigned to a specific user.</span></span> <span data-ttu-id="bbc79-131">Pour plus d’informations, consultez [le journal d’audit.](../../compliance/search-the-audit-log-in-security-and-compliance.md)</span><span class="sxs-lookup"><span data-stu-id="bbc79-131">For more information, see [Audit log](../../compliance/search-the-audit-log-in-security-and-compliance.md).</span></span>
>
> <span data-ttu-id="bbc79-132">Si cette valeur est true, elle indique qu’une personne ayant un accès Administrateur général a peut-être accordé un large accès aux données.</span><span class="sxs-lookup"><span data-stu-id="bbc79-132">If this value is true, it indicates that someone with Global Administrator access may have granted broad access to data.</span></span> <span data-ttu-id="bbc79-133">S’il s’agit d’une attaque inattendue, prenez les mesures [nécessaires pour confirmer une attaque.](#how-to-confirm-an-attack)</span><span class="sxs-lookup"><span data-stu-id="bbc79-133">If this is unexpected, take steps to [confirm an attack](#how-to-confirm-an-attack).</span></span>

## <a name="how-to-confirm-an-attack"></a><span data-ttu-id="bbc79-134">Comment confirmer une attaque</span><span class="sxs-lookup"><span data-stu-id="bbc79-134">How to confirm an attack</span></span>

<span data-ttu-id="bbc79-135">Si vous avez une ou plusieurs instances des CCI répertoriées ci-dessus, vous devez poursuivre l’examen pour confirmer que l’attaque s’est produite.</span><span class="sxs-lookup"><span data-stu-id="bbc79-135">If you have one or more instances of the IOCs listed above, you need to do further investigation to positively confirm that the attack occurred.</span></span> <span data-ttu-id="bbc79-136">Vous pouvez utiliser l’une de ces trois méthodes pour confirmer l’attaque :</span><span class="sxs-lookup"><span data-stu-id="bbc79-136">You can use any of these three methods to confirm the attack:</span></span>

- <span data-ttu-id="bbc79-137">Inventorier les applications et leurs autorisations à l’aide Azure Active Directory portail.</span><span class="sxs-lookup"><span data-stu-id="bbc79-137">Inventory applications and their permissions using the Azure Active Directory portal.</span></span> <span data-ttu-id="bbc79-138">Cette méthode est minutieuse, mais vous ne pouvez vérifier qu’un seul utilisateur à la fois, ce qui peut prendre beaucoup de temps si vous avez de nombreux utilisateurs à vérifier.</span><span class="sxs-lookup"><span data-stu-id="bbc79-138">This method is thorough, but you can only check one user at a time which can be very time consuming if you have many users to check.</span></span>

- <span data-ttu-id="bbc79-139">Inventorier les applications et leurs autorisations à l’aide de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bbc79-139">Inventory applications and their permissions using PowerShell.</span></span> <span data-ttu-id="bbc79-140">Il s’agit de la méthode la plus rapide et la plus minutieuse, avec la charge de traitement la moins importante.</span><span class="sxs-lookup"><span data-stu-id="bbc79-140">This is the fastest and most thorough method, with the least amount of overhead.</span></span>

- <span data-ttu-id="bbc79-141">Demander à vos utilisateurs de vérifier individuellement leurs applications et autorisations et de signaler les résultats aux administrateurs pour correction.</span><span class="sxs-lookup"><span data-stu-id="bbc79-141">Have your users individually check their apps and permissions and report the results back to the administrators for remediation.</span></span>

## <a name="inventory-apps-with-access-in-your-organization"></a><span data-ttu-id="bbc79-142">Inventaire des applications avec accès dans votre organisation</span><span class="sxs-lookup"><span data-stu-id="bbc79-142">Inventory apps with access in your organization</span></span>

<span data-ttu-id="bbc79-143">Vous pouvez le faire pour vos utilisateurs avec le portail Azure Active Directory ou PowerShell, ou faire en sorte que vos utilisateurs émanent individuellement leur accès aux applications.</span><span class="sxs-lookup"><span data-stu-id="bbc79-143">You can do this for your users with either the Azure Active Directory Portal, or PowerShell or have your users individually enumerate their application access.</span></span>

### <a name="steps-for-using-the-azure-active-directory-portal"></a><span data-ttu-id="bbc79-144">Étapes d’utilisation du portail Azure Active Directory web</span><span class="sxs-lookup"><span data-stu-id="bbc79-144">Steps for using the Azure Active Directory Portal</span></span>

<span data-ttu-id="bbc79-145">Vous pouvez rechercher les applications pour lesquelles un utilisateur individuel a accordé des autorisations à l’aide [du portail Azure Active Directory.](https://portal.azure.com/)</span><span class="sxs-lookup"><span data-stu-id="bbc79-145">You can look up the applications to which any individual user has granted permissions by using the [Azure Active Directory Portal](https://portal.azure.com/).</span></span>

1. <span data-ttu-id="bbc79-146">Connectez-vous au portail Azure avec des droits d’administration.</span><span class="sxs-lookup"><span data-stu-id="bbc79-146">Sign in to the Azure portal with administrative rights.</span></span>

2. <span data-ttu-id="bbc79-147">Sélectionnez le Azure Active Directory de l’équipe.</span><span class="sxs-lookup"><span data-stu-id="bbc79-147">Select the Azure Active Directory blade.</span></span>

3. <span data-ttu-id="bbc79-148">Sélectionnez **Utilisateurs**.</span><span class="sxs-lookup"><span data-stu-id="bbc79-148">Select **Users**.</span></span>

4. <span data-ttu-id="bbc79-149">Sélectionnez l’utilisateur à réviser.</span><span class="sxs-lookup"><span data-stu-id="bbc79-149">Select the user that you want to review.</span></span>

5. <span data-ttu-id="bbc79-150">Sélectionnez **Applications**.</span><span class="sxs-lookup"><span data-stu-id="bbc79-150">Select **Applications**.</span></span>

<span data-ttu-id="bbc79-151">Cela vous indique les applications qui sont affectées à l’utilisateur et les autorisations dont elles ont.</span><span class="sxs-lookup"><span data-stu-id="bbc79-151">This will show you the apps that are assigned to the user and what permissions the applications have.</span></span>

### <a name="steps-for-having-your-users-enumerate-their-application-access"></a><span data-ttu-id="bbc79-152">Étapes pour que vos utilisateurs émanent l’accès à leur application</span><span class="sxs-lookup"><span data-stu-id="bbc79-152">Steps for having your users enumerate their application access</span></span>

<span data-ttu-id="bbc79-153">Demande à vos utilisateurs d’y accéder et de consulter https://myapps.microsoft.com leur propre accès aux applications.</span><span class="sxs-lookup"><span data-stu-id="bbc79-153">Have your users go to https://myapps.microsoft.com and review their own application access there.</span></span> <span data-ttu-id="bbc79-154">Ils doivent être en mesure d’afficher toutes les applications avec accès, d’afficher les détails les concernant (y compris l’étendue de l’accès) et de révoquer des privilèges pour des applications suspectes ou illicites.</span><span class="sxs-lookup"><span data-stu-id="bbc79-154">They should be able to see all the apps with access, view details about them (including the scope of access), and be able to revoke privileges to suspicious or illicit apps.</span></span>

### <a name="steps-for-doing-this-with-powershell"></a><span data-ttu-id="bbc79-155">Étapes à suivre pour ce faire avec PowerShell</span><span class="sxs-lookup"><span data-stu-id="bbc79-155">Steps for doing this with PowerShell</span></span>

<span data-ttu-id="bbc79-156">Le moyen le plus simple de vérifier l’attaque par consentement illicite consiste à exécuter [Get-AzureADPSPermissions.ps1, ](https://gist.github.com/psignoret/41793f8c6211d2df5051d77ca3728c09)qui vide toutes les autorisations OAuth et toutes les applications OAuth pour tous les utilisateurs de votre location dans un seul fichier .csv.</span><span class="sxs-lookup"><span data-stu-id="bbc79-156">The simplest way to verify the Illicit Consent Grant attack is to run [Get-AzureADPSPermissions.ps1](https://gist.github.com/psignoret/41793f8c6211d2df5051d77ca3728c09), which will dump all the OAuth consent grants and OAuth apps for all users in your tenancy into one .csv file.</span></span>

#### <a name="pre-requisites"></a><span data-ttu-id="bbc79-157">Conditions préalables</span><span class="sxs-lookup"><span data-stu-id="bbc79-157">Pre-requisites</span></span>

- <span data-ttu-id="bbc79-158">La bibliothèque Azure AD PowerShell est installée.</span><span class="sxs-lookup"><span data-stu-id="bbc79-158">The Azure AD PowerShell library installed.</span></span>

- <span data-ttu-id="bbc79-159">Droits d’administrateur général sur le client sur le client sur qui le script sera exécuté.</span><span class="sxs-lookup"><span data-stu-id="bbc79-159">Global administrator rights on the tenant that the script will be run against.</span></span>

- <span data-ttu-id="bbc79-160">Administrateur local sur l’ordinateur à partir duquel exécuter les scripts.</span><span class="sxs-lookup"><span data-stu-id="bbc79-160">Local Administrator on the computer from which will run the scripts.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="bbc79-161">Nous ***vous recommandons vivement*** d’exiger une authentification multifacteur sur votre compte d’administration.</span><span class="sxs-lookup"><span data-stu-id="bbc79-161">We ***highly recommend*** that you require multi-factor authentication on your administrative account.</span></span> <span data-ttu-id="bbc79-162">Ce script prend en charge l’authentification multifacteur.</span><span class="sxs-lookup"><span data-stu-id="bbc79-162">This script supports MFA authentication.</span></span>

1. <span data-ttu-id="bbc79-163">Connectez-vous à l’ordinateur à partir de qui vous exécuterez le script avec des droits d’administrateur local.</span><span class="sxs-lookup"><span data-stu-id="bbc79-163">Sign in to the computer that you will run the script from with local administrator rights.</span></span>

2. <span data-ttu-id="bbc79-164">Téléchargez ou copiez [Get-AzureADPSPermissions.ps1](https://gist.github.com/psignoret/41793f8c6211d2df5051d77ca3728c09) script de GitHub vers un dossier à partir duquel vous exécuterez le script.</span><span class="sxs-lookup"><span data-stu-id="bbc79-164">Download or copy the [Get-AzureADPSPermissions.ps1](https://gist.github.com/psignoret/41793f8c6211d2df5051d77ca3728c09) script from GitHub to a folder from which you will run the script.</span></span> <span data-ttu-id="bbc79-165">Ce sera le même dossier dans lequel le fichier « permissions.csv » de sortie sera écrit.</span><span class="sxs-lookup"><span data-stu-id="bbc79-165">This will be the same folder to which the output "permissions.csv" file will be written.</span></span>

3. <span data-ttu-id="bbc79-166">Ouvrez une instance PowerShell en tant qu’administrateur et ouvrez le dossier dans qui vous avez enregistré le script.</span><span class="sxs-lookup"><span data-stu-id="bbc79-166">Open a PowerShell instance as an administrator and open to the folder you saved the script to.</span></span>

4. <span data-ttu-id="bbc79-167">Connecter votre répertoire à l’aide de [l Connecter-AzureAD.](/powershell/module/azuread/connect-azuread)</span><span class="sxs-lookup"><span data-stu-id="bbc79-167">Connect to your directory using the [Connect-AzureAD](/powershell/module/azuread/connect-azuread) cmdlet.</span></span>

5. <span data-ttu-id="bbc79-168">Exécutez cette commande PowerShell :</span><span class="sxs-lookup"><span data-stu-id="bbc79-168">Run this PowerShell command:</span></span>

   ```powershell
   .\Get-AzureADPSPermissions.ps1 | Export-csv -Path "Permissions.csv" -NoTypeInformation
   ```

<span data-ttu-id="bbc79-169">Le script produit un fichier nommé Permissions.csv.</span><span class="sxs-lookup"><span data-stu-id="bbc79-169">The script produces one file named Permissions.csv.</span></span> <span data-ttu-id="bbc79-170">Pour rechercher des autorisations d’application illicites, suivez les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="bbc79-170">Follow these steps to look for illicit application permission grants:</span></span>

1. <span data-ttu-id="bbc79-171">Dans la colonne ConsentType (colonne G), recherchez la valeur « AllPrinciples ».</span><span class="sxs-lookup"><span data-stu-id="bbc79-171">In the ConsentType column (column G) search for the value "AllPrinciples".</span></span> <span data-ttu-id="bbc79-172">L’autorisation AllPrincipals permet à l’application cliente d’accéder au contenu de tout le monde dans la location.</span><span class="sxs-lookup"><span data-stu-id="bbc79-172">The AllPrincipals permission allows the client application to access everyone's content in the tenancy.</span></span> <span data-ttu-id="bbc79-173">Les applications Microsoft 365 natives ont besoin de cette autorisation pour fonctionner correctement.</span><span class="sxs-lookup"><span data-stu-id="bbc79-173">Native Microsoft 365 applications need this permission to work correctly.</span></span> <span data-ttu-id="bbc79-174">Toutes les applications non-Microsoft qui ont cette autorisation doivent être examinées attentivement.</span><span class="sxs-lookup"><span data-stu-id="bbc79-174">Every non-Microsoft application with this permission should be reviewed carefully.</span></span>

2. <span data-ttu-id="bbc79-175">Dans la colonne Autorisation (colonne F), examinez les autorisations dont dispose chaque application déléguée pour le contenu.</span><span class="sxs-lookup"><span data-stu-id="bbc79-175">In the Permission column (column F) review the permissions that each delegated application has to content.</span></span> <span data-ttu-id="bbc79-176">Recherchez les autorisations « Lecture » et « Écriture » ou « \* ». Toutes les autorisations et examinez-les attentivement, car elles peuvent ne pas être appropriées.</span><span class="sxs-lookup"><span data-stu-id="bbc79-176">Look for "Read" and "Write" permission or "\*.All" permission, and review these carefully because they may not be appropriate.</span></span>

3. <span data-ttu-id="bbc79-177">Examinez les utilisateurs spécifiques qui ont des consentements accordés.</span><span class="sxs-lookup"><span data-stu-id="bbc79-177">Review the specific users that have consents granted.</span></span> <span data-ttu-id="bbc79-178">Si des utilisateurs à profil élevé ou à fort impact ont des consentements inappropriés accordés, vous devez examiner plus en détail.</span><span class="sxs-lookup"><span data-stu-id="bbc79-178">If high profile or high impact users have inappropriate consents granted, you should investigate further.</span></span>

4. <span data-ttu-id="bbc79-179">Dans la colonne ClientDisplayName (colonne C), recherchez les applications qui semblent suspectes.</span><span class="sxs-lookup"><span data-stu-id="bbc79-179">In the ClientDisplayName column (column C) look for apps that seem suspicious.</span></span> <span data-ttu-id="bbc79-180">Les applications avec des noms mal orthographiés, des noms de super-sites ou des noms de pirates informatiques doivent être examinées attentivement.</span><span class="sxs-lookup"><span data-stu-id="bbc79-180">Apps with misspelled names, super bland names, or hacker-sounding names should be reviewed carefully.</span></span>

## <a name="determine-the-scope-of-the-attack"></a><span data-ttu-id="bbc79-181">Déterminer l’étendue de l’attaque</span><span class="sxs-lookup"><span data-stu-id="bbc79-181">Determine the scope of the attack</span></span>

<span data-ttu-id="bbc79-182">Une fois que vous avez terminé l’inventaire de l’accès aux applications, examinez le journal **d’audit** pour déterminer l’étendue complète de la violation.</span><span class="sxs-lookup"><span data-stu-id="bbc79-182">After you have finished inventorying application access, review the **audit log** to determine the full scope of the breach.</span></span> <span data-ttu-id="bbc79-183">Recherchez les utilisateurs concernés, les délais d’accès de l’application illicite à votre organisation et les autorisations de l’application.</span><span class="sxs-lookup"><span data-stu-id="bbc79-183">Search on the affected users, the time frames that the illicit application had access to your organization, and the permissions the app had.</span></span> <span data-ttu-id="bbc79-184">Vous pouvez effectuer une recherche **dans le journal d’audit** [dans le Microsoft 365 Defender](../../compliance/search-the-audit-log-in-security-and-compliance.md).</span><span class="sxs-lookup"><span data-stu-id="bbc79-184">You can search the **audit log** in the [Microsoft 365 Defender](../../compliance/search-the-audit-log-in-security-and-compliance.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="bbc79-185">[L’audit de boîte](../../compliance/enable-mailbox-auditing.md) aux lettres et l’audit d’activité pour les administrateurs et les utilisateurs doivent avoir été [activés](../../compliance/turn-audit-log-search-on-or-off.md) avant l’attaque pour que vous receviez ces informations.</span><span class="sxs-lookup"><span data-stu-id="bbc79-185">[Mailbox auditing](../../compliance/enable-mailbox-auditing.md) and [Activity auditing for admins and users](../../compliance/turn-audit-log-search-on-or-off.md) must have been enabled prior to the attack for you to get this information.</span></span>

## <a name="how-to-stop-and-remediate-an-illicit-consent-grant-attack"></a><span data-ttu-id="bbc79-186">Comment arrêter et corriger une attaque d’octroi de consentement illicite</span><span class="sxs-lookup"><span data-stu-id="bbc79-186">How to stop and remediate an illicit consent grant attack</span></span>

<span data-ttu-id="bbc79-187">Une fois que vous avez identifié une application avec des autorisations illicites, vous avez plusieurs façons de supprimer cet accès.</span><span class="sxs-lookup"><span data-stu-id="bbc79-187">After you have identified an application with illicit permissions, you have several ways to remove that access.</span></span>

- <span data-ttu-id="bbc79-188">Vous pouvez révoquer l’autorisation de l’application dans le portail Azure Active Directory en :</span><span class="sxs-lookup"><span data-stu-id="bbc79-188">You can revoke the application's permission in the Azure Active Directory Portal by:</span></span>

  - <span data-ttu-id="bbc79-189">Accédez à l’utilisateur affecté dans le **Azure Active Directory’utilisateur.**</span><span class="sxs-lookup"><span data-stu-id="bbc79-189">Navigate to the affected user in the **Azure Active Directory User** blade.</span></span>

  - <span data-ttu-id="bbc79-190">Sélectionnez **Applications**.</span><span class="sxs-lookup"><span data-stu-id="bbc79-190">Select **Applications**.</span></span>

  - <span data-ttu-id="bbc79-191">Sélectionnez l’application illicite.</span><span class="sxs-lookup"><span data-stu-id="bbc79-191">Select the illicit application.</span></span>

  - <span data-ttu-id="bbc79-192">Cliquez **sur Supprimer** dans l’exercice vers le bas.</span><span class="sxs-lookup"><span data-stu-id="bbc79-192">Click **Remove** in the drill down.</span></span>

- <span data-ttu-id="bbc79-193">Vous pouvez révoquer l’octroi de consentement OAuth avec PowerShell en suivant les étapes de [Remove-AzureADOAuth2PermissionGrant](/powershell/module/azuread/Remove-AzureADOAuth2PermissionGrant).</span><span class="sxs-lookup"><span data-stu-id="bbc79-193">You can revoke the OAuth consent grant with PowerShell by following the steps in [Remove-AzureADOAuth2PermissionGrant](/powershell/module/azuread/Remove-AzureADOAuth2PermissionGrant).</span></span>

- <span data-ttu-id="bbc79-194">Vous pouvez révoquer l’attribution de rôle d’application de service avec PowerShell en suivant les étapes de [Remove-AzureADServiceAppRoleAssignment](/powershell/module/azuread/Remove-AzureADServiceAppRoleAssignment).</span><span class="sxs-lookup"><span data-stu-id="bbc79-194">You can revoke the Service App Role Assignment with PowerShell by following the steps in [Remove-AzureADServiceAppRoleAssignment](/powershell/module/azuread/Remove-AzureADServiceAppRoleAssignment).</span></span>

- <span data-ttu-id="bbc79-195">Vous pouvez également désactiver la connectez-vous pour le compte affecté, ce qui désactivera à son tour l’accès de l’application aux données de ce compte.</span><span class="sxs-lookup"><span data-stu-id="bbc79-195">You can also disable sign-in for the affected account altogether, which will in turn disable app access to data in that account.</span></span> <span data-ttu-id="bbc79-196">Ce n’est pas idéal pour la productivité de l’utilisateur final, bien entendu, mais si vous travaillez pour limiter rapidement l’impact, il peut s’agir d’une correction viable à court terme.</span><span class="sxs-lookup"><span data-stu-id="bbc79-196">This isn't ideal for the end user's productivity, of course, but if you are working to limit impact quickly, it can be a viable short-term remediation.</span></span>

- <span data-ttu-id="bbc79-197">Vous pouvez désactiver les applications intégrées pour votre location.</span><span class="sxs-lookup"><span data-stu-id="bbc79-197">You can turn integrated applications off for your tenancy.</span></span> <span data-ttu-id="bbc79-198">Il s’agit d’une étape radicale qui désactive la possibilité pour les utilisateurs finaux d’accorder leur consentement à l’échelle du client.</span><span class="sxs-lookup"><span data-stu-id="bbc79-198">This is a drastic step that disables the ability for end users to grant consent on a tenant-wide basis.</span></span> <span data-ttu-id="bbc79-199">Cela empêche vos utilisateurs d’accorder par inadvertance l’accès à une application malveillante.</span><span class="sxs-lookup"><span data-stu-id="bbc79-199">This prevents your users from inadvertently granting access to a malicious application.</span></span> <span data-ttu-id="bbc79-200">Cette recommandation n’est pas vivement recommandée, car elle nuit gravement à la capacité de productivité de vos utilisateurs avec des applications tierces.</span><span class="sxs-lookup"><span data-stu-id="bbc79-200">This isn't strongly recommended as it severely impairs your users' ability to be productive with third party applications.</span></span> <span data-ttu-id="bbc79-201">Pour ce faire, vous pouvez suivre les étapes de [l’étape d'](../../admin/misc/user-consent.md)allumer ou de éteindre les applications intégrées.</span><span class="sxs-lookup"><span data-stu-id="bbc79-201">You can do this by following the steps in [Turning Integrated Apps on or off](../../admin/misc/user-consent.md).</span></span>

## <a name="secure-microsoft-365-like-a-cybersecurity-pro"></a><span data-ttu-id="bbc79-202">Sécuriser Microsoft 365 comme un pro de la cyber-sécurité</span><span class="sxs-lookup"><span data-stu-id="bbc79-202">Secure Microsoft 365 like a cybersecurity pro</span></span>

<span data-ttu-id="bbc79-203">Votre abonnement Microsoft 365 inclut un ensemble puissant de fonctionnalités de sécurité que vous pouvez utiliser pour protéger vos données et vos utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="bbc79-203">Your Microsoft 365 subscription comes with a powerful set of security capabilities that you can use to protect your data and your users.</span></span> <span data-ttu-id="bbc79-204">Utilisez la [Feuille de route du Centre de sécurité Microsoft 365 : principales priorités pour les 30 premiers jours, 90 premiers jours et au-delà](security-roadmap.md), pour implémenter les meilleures pratiques recommandées par Microsoft pour sécuriser votre client Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="bbc79-204">Use the [Microsoft 365 security roadmap - Top priorities for the first 30 days, 90 days, and beyond](security-roadmap.md) to implement Microsoft recommended best practices for securing your Microsoft 365 tenant.</span></span>

- <span data-ttu-id="bbc79-205">Tâches à effectuer lors des 30 premiers jours.</span><span class="sxs-lookup"><span data-stu-id="bbc79-205">Tasks to accomplish in the first 30 days.</span></span> <span data-ttu-id="bbc79-206">Elle ont un effet immédiat et n’ont qu’un faible impact négatif sur vos utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="bbc79-206">These have immediate affect and are low-impact to your users.</span></span>

- <span data-ttu-id="bbc79-207">Tâches à accomplir dans les 90 premiers jours.</span><span class="sxs-lookup"><span data-stu-id="bbc79-207">Tasks to accomplish in 90 days.</span></span> <span data-ttu-id="bbc79-208">Ces tâches prennent un peu plus de temps à planifier et à implémenter, mais augmentent considérablement votre sécurité.</span><span class="sxs-lookup"><span data-stu-id="bbc79-208">These take a bit more time to plan and implement but greatly improve your security posture.</span></span>

- <span data-ttu-id="bbc79-209">Au-delà de 90 jours.</span><span class="sxs-lookup"><span data-stu-id="bbc79-209">Beyond 90 days.</span></span> <span data-ttu-id="bbc79-210">Ces améliorations sont à mettre en place pendant les 90 premiers jours.</span><span class="sxs-lookup"><span data-stu-id="bbc79-210">These enhancements build in your first 90 days work.</span></span>

## <a name="see-also"></a><span data-ttu-id="bbc79-211">Voir aussi :</span><span class="sxs-lookup"><span data-stu-id="bbc79-211">See also:</span></span>

- <span data-ttu-id="bbc79-212">[Une application inattendue dans la](/azure/active-directory/application-access-unexpected-application) liste des applications permet aux administrateurs d’accéder aux différentes actions qu’ils souhaitent peut-être réaliser après avoir réalisé qu’il existe des applications inattendues ayant accès aux données.</span><span class="sxs-lookup"><span data-stu-id="bbc79-212">[Unexpected application in my applications list](/azure/active-directory/application-access-unexpected-application) walks administrators through various actions they may want to take after realizing there are unexpected applications with access to data.</span></span>

- <span data-ttu-id="bbc79-213">[L’intégration d’applications Azure Active Directory](/azure/active-directory/active-directory-apps-permissions-consent) est une vue d’ensemble générale du consentement et des autorisations.</span><span class="sxs-lookup"><span data-stu-id="bbc79-213">[Integrating applications with Azure Active Directory](/azure/active-directory/active-directory-apps-permissions-consent) is a high-level overview of consent and permissions.</span></span>

- <span data-ttu-id="bbc79-214">[Les problèmes liés au développement de mon application](/azure/active-directory/active-directory-application-dev-development-content-map) fournissent des liens vers différents articles relatifs au consentement.</span><span class="sxs-lookup"><span data-stu-id="bbc79-214">[Problems developing my application](/azure/active-directory/active-directory-application-dev-development-content-map) provides links to various consent related articles.</span></span>

- <span data-ttu-id="bbc79-215">Les objets principaux d’application et de service dans [Azure Active Directory (Azure AD)](/azure/active-directory/develop/active-directory-application-objects) offrent une vue d’ensemble des objets principaux d’application et de service qui sont essentiels au modèle d’application.</span><span class="sxs-lookup"><span data-stu-id="bbc79-215">[Application and service principal objects in Azure Active Directory (Azure AD)](/azure/active-directory/develop/active-directory-application-objects) provides an overview of the Application and Service principal objects that are core to the application model.</span></span>

- <span data-ttu-id="bbc79-216">[Gérer l’accès aux applications](/azure/active-directory/active-directory-managing-access-to-apps) est une vue d’ensemble des fonctionnalités dont les administrateurs ont besoin pour gérer l’accès des utilisateurs aux applications.</span><span class="sxs-lookup"><span data-stu-id="bbc79-216">[Manage access to apps](/azure/active-directory/active-directory-managing-access-to-apps) is an overview of the capabilities that administrators have to manage user access to apps.</span></span>
