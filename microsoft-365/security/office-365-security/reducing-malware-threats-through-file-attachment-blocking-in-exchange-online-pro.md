---
title: Utiliser des règles de flux de messagerie pour bloquer les messages avec des pièces jointes exécutables
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
ms.service: O365-seccomp
localization_priority: Normal
ms.assetid: c4fb4a86-b772-49d0-8773-e8ee897e175d
ms.custom:
- seo-marvel-apr2020
description: Les administrateurs peuvent apprendre à créer des règles de flux de messagerie (règles de transport) pour bloquer les messages qui contiennent des pièces jointes exécutables.
ms.openlocfilehash: 0d641b5e8e93f4cd65a4ae22f1d99df41bf5fc9c
ms.sourcegitcommit: c083602dda3cdcb5b58cb8aa070d77019075f765
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/22/2020
ms.locfileid: "48197234"
---
# <a name="use-mail-flow-rules-to-block-messages-with-executable-attachments-in-eop"></a><span data-ttu-id="19fbc-103">Utiliser des règles de flux de courrier pour bloquer les messages avec des pièces jointes exécutables dans EOP</span><span class="sxs-lookup"><span data-stu-id="19fbc-103">Use mail flow rules to block messages with executable attachments in EOP</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]


<span data-ttu-id="19fbc-104">Dans les organisations Microsoft 365 avec des boîtes aux lettres dans Exchange Online ou des organisations Exchange Online Protection (EOP) autonomes sans boîte aux lettres Exchange Online, EOP utilise des stratégies de protection contre les programmes malveillants pour bloquer les messages nuisibles, y compris les messages avec pièces jointes exécutables.</span><span class="sxs-lookup"><span data-stu-id="19fbc-104">In Microsoft 365 organizations with mailboxes in Exchange Online or standalone Exchange Online Protection (EOP) organizations without Exchange Online mailboxes, EOP uses anti-malware policies to block harmful messages, including messages with executable attachments.</span></span> <span data-ttu-id="19fbc-105">Pour plus d’informations, consultez la rubrique [protection contre les programmes malveillants dans EOP](anti-malware-protection.md).</span><span class="sxs-lookup"><span data-stu-id="19fbc-105">For more information, see [Anti-malware protection in EOP](anti-malware-protection.md).</span></span>

<span data-ttu-id="19fbc-106">Pour améliorer davantage la protection, vous pouvez utiliser des règles de flux de messagerie (également appelées règles de transport) pour identifier et bloquer les messages qui contiennent des pièces jointes exécutables, comme décrit dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="19fbc-106">To further enhance protection, you can use mail flow rules (also known as transport rules) to identify and block messages that contain executable attachments as described in this topic.</span></span>

<span data-ttu-id="19fbc-107">Par exemple, après une attaque de programme malveillant, une société peut appliquer cette règle avec une limite de temps pour permettre aux utilisateurs concernés de revenir à l’envoi de pièces jointes après un laps de temps spécifié.</span><span class="sxs-lookup"><span data-stu-id="19fbc-107">For example, following a malware outbreak, a company could apply this rule with a time limit so that affected users can get back to sending attachments after a specified length of time.</span></span>

## <a name="what-do-you-need-to-know-before-you-begin"></a><span data-ttu-id="19fbc-108">Ce qu'il faut savoir avant de commencer</span><span class="sxs-lookup"><span data-stu-id="19fbc-108">What do you need to know before you begin?</span></span>

- <span data-ttu-id="19fbc-109">Pour pouvoir effectuer ces procédures, vous devez disposer des autorisations suivantes :</span><span class="sxs-lookup"><span data-stu-id="19fbc-109">You need to be assigned permissions before you can do these procedures:</span></span>

  - <span data-ttu-id="19fbc-110">Dans Exchange Online, consultez l’entrée « flux de messagerie » dans [autorisations des fonctionnalités dans Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/feature-permissions).</span><span class="sxs-lookup"><span data-stu-id="19fbc-110">In Exchange Online, see the "Mail flow" entry in [Feature Permissions in Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/feature-permissions).</span></span>
  
  - <span data-ttu-id="19fbc-111">Dans EOP autonome, vous avez besoin du rôle de règles de transport, qui est affecté par défaut aux rôles OrganizationManagement, ComplianceManagement et RecordsManagement.</span><span class="sxs-lookup"><span data-stu-id="19fbc-111">In standalone EOP, you need the Transport Rules role, which is assigned to the OrganizationManagement, ComplianceManagement, and RecordsManagement roles by default.</span></span> <span data-ttu-id="19fbc-112">Pour plus d’informations, consultez la rubrique [autorisations dans EOP autonome](feature-permissions-in-eop.md) et utiliser le centre d’administration Exchange pour [modifier la liste des membres dans les groupes de rôles](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups).</span><span class="sxs-lookup"><span data-stu-id="19fbc-112">For more information, see [Permissions in standalone EOP](feature-permissions-in-eop.md) and [Use the EAC modify the list of members in role groups](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups).</span></span>

- <span data-ttu-id="19fbc-113">Pour ouvrir le centre d’administration Exchange dans Exchange Online, consultez la rubrique [Exchange Admin Center in Exchange Online](https://docs.microsoft.com/Exchange/exchange-admin-center).</span><span class="sxs-lookup"><span data-stu-id="19fbc-113">To open the EAC in Exchange Online, see [Exchange admin center in Exchange Online](https://docs.microsoft.com/Exchange/exchange-admin-center).</span></span> <span data-ttu-id="19fbc-114">Pour ouvrir le centre d’administration Exchange en mode autonome EOP, consultez la rubrique [Exchange Admin Center in standalone EOP](exchange-admin-center-in-exchange-online-protection-eop.md).</span><span class="sxs-lookup"><span data-stu-id="19fbc-114">To open the EAC in standalone EOP, see [Exchange admin center in standalone EOP](exchange-admin-center-in-exchange-online-protection-eop.md).</span></span>

- <span data-ttu-id="19fbc-115">Pour vous connecter à Exchange Online PowerShell, voir [Connexion à Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell).</span><span class="sxs-lookup"><span data-stu-id="19fbc-115">To connect to Exchange Online PowerShell, see [Connect to Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell).</span></span> <span data-ttu-id="19fbc-116">Pour vous connecter à un service Exchange Online Protection PowerShell autonome, voir [Se connecter à Exchange Online Protection PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).</span><span class="sxs-lookup"><span data-stu-id="19fbc-116">To connect to standalone EOP PowerShell, see [Connect to Exchange Online Protection PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).</span></span>

- <span data-ttu-id="19fbc-117">Pour plus d’informations sur les règles de flux de messagerie dans Exchange Online et dans la version autonome d’EOP, consultez les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="19fbc-117">For more information about mail flow rules in Exchange Online and standalone EOP, see the following topics:</span></span>

  - [<span data-ttu-id="19fbc-118">Règles de flux de messagerie (règles de transport) dans Exchange Online</span><span class="sxs-lookup"><span data-stu-id="19fbc-118">Mail flow rules (transport rules) in Exchange Online</span></span>](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rules)

  - [<span data-ttu-id="19fbc-119">Conditions de règle de flux de messagerie et exceptions (prédicats) dans Exchange Online</span><span class="sxs-lookup"><span data-stu-id="19fbc-119">Mail flow rule conditions and exceptions (predicates) in Exchange Online</span></span>](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions)

  - [<span data-ttu-id="19fbc-120">Actions de règle de flux de courrier dans Exchange Online</span><span class="sxs-lookup"><span data-stu-id="19fbc-120">Mail flow rule actions in Exchange Online</span></span>](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rule-actions)

## <a name="use-the-eac-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a><span data-ttu-id="19fbc-121">Utiliser le centre d’administration Exchange pour créer une règle qui bloque les messages avec des pièces jointes exécutables</span><span class="sxs-lookup"><span data-stu-id="19fbc-121">Use the EAC to create a rule that blocks messages with executable attachments</span></span>

1. <span data-ttu-id="19fbc-122">Dans le CAE, accédez à **Flux de messagerie** \> **Règles**.</span><span class="sxs-lookup"><span data-stu-id="19fbc-122">In the EAC, go to **Mail flow** \> **Rules**.</span></span>

2. <span data-ttu-id="19fbc-123">Cliquez sur **Ajouter** ![ une icône Ajouter ](../../media/ITPro-EAC-AddIcon.png) , puis sélectionnez **créer une nouvelle règle**.</span><span class="sxs-lookup"><span data-stu-id="19fbc-123">Click **Add** ![Add icon](../../media/ITPro-EAC-AddIcon.png) and then select **Create a new rule**.</span></span>

3. <span data-ttu-id="19fbc-124">Dans la page **Nouvelle règle** qui s'ouvre, configurez les paramètres suivants :</span><span class="sxs-lookup"><span data-stu-id="19fbc-124">In the **New rule** page that opens, configure the following settings:</span></span>

   - <span data-ttu-id="19fbc-125">**Nom**: entrez un nom unique et descriptif pour la règle.</span><span class="sxs-lookup"><span data-stu-id="19fbc-125">**Name**: Enter a unique, descriptive name for the rule.</span></span>

   - <span data-ttu-id="19fbc-126">Cliquez sur **Autres options**.</span><span class="sxs-lookup"><span data-stu-id="19fbc-126">Click **More Options**.</span></span>

   - <span data-ttu-id="19fbc-127">**Appliquer cette règle si**: sélectionnez **une pièce jointe** \> **a un contenu exécutable**.</span><span class="sxs-lookup"><span data-stu-id="19fbc-127">**Apply this rule if**: Select **Any attachment** \> **has executable content**.</span></span>

   - <span data-ttu-id="19fbc-128">**Procédez comme suit**: sélectionnez **bloquer le message** , puis sélectionnez l’action souhaitée :</span><span class="sxs-lookup"><span data-stu-id="19fbc-128">**Do the following**: Select **Block the message** and then choose the action you want:</span></span>

     - <span data-ttu-id="19fbc-129">**rejeter le message et inclure une explication**: dans la boîte de dialogue **spécifier la raison du rejet** qui s’affiche, entrez le texte que vous souhaitez voir apparaître dans la notification d’échec de remise (également appelée notification de non-remise).</span><span class="sxs-lookup"><span data-stu-id="19fbc-129">**reject the message and include an explanation**: In the **Specify reject reason** dialog that appears, enter the text you want to appear in the non-delivery report (also known as an NDR or bounce message).</span></span> <span data-ttu-id="19fbc-130">Le code d’état étendu utilisé par défaut est 5.7.1.</span><span class="sxs-lookup"><span data-stu-id="19fbc-130">The default enhanced status code that's used is 5.7.1.</span></span>

     - <span data-ttu-id="19fbc-131">**rejeter le message avec le code d’état étendu**: dans la boîte de dialogue **Entrez le code d’état étendu** qui s’affiche, entrez le code d’état étendu que vous souhaitez voir apparaître dans la notification d’état de remise.</span><span class="sxs-lookup"><span data-stu-id="19fbc-131">**reject the message with the enhanced status code of**:  In the **Enter enhanced status code** dialog that appears, enter the enhanced status code that you want to appear in the NDR.</span></span> <span data-ttu-id="19fbc-132">Les valeurs valides sont 5.7.1 ou une valeur comprise entre 5.7.900 et 5.7.999.</span><span class="sxs-lookup"><span data-stu-id="19fbc-132">Valid values are 5.7.1 or a value from 5.7.900 to 5.7.999.</span></span> <span data-ttu-id="19fbc-133">Le texte de rejet par défaut est : remise non autorisée, message refusé.</span><span class="sxs-lookup"><span data-stu-id="19fbc-133">The default rejection text is: Delivery not authorized, message refused.</span></span>

     - <span data-ttu-id="19fbc-134">**rejeter le message sans avertir personne**</span><span class="sxs-lookup"><span data-stu-id="19fbc-134">**reject the message without notifying anyone**</span></span>

4. <span data-ttu-id="19fbc-135">Lorsque vous avez terminé, cliquez sur **Enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="19fbc-135">When you're finished, click **Save**.</span></span> <span data-ttu-id="19fbc-136">Votre règle de blocage des pièces jointes est en vigueur.</span><span class="sxs-lookup"><span data-stu-id="19fbc-136">Your attachment blocking rule is now in force.</span></span>

## <a name="use-powershell-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a><span data-ttu-id="19fbc-137">Utiliser PowerShell pour créer une règle qui bloque les messages avec des pièces jointes exécutables</span><span class="sxs-lookup"><span data-stu-id="19fbc-137">Use PowerShell to create a rule that blocks messages with executable attachments</span></span>

<span data-ttu-id="19fbc-138">Utilisez la syntaxe suivante pour créer une règle qui bloque les messages qui contiennent des pièces jointes exécutables :</span><span class="sxs-lookup"><span data-stu-id="19fbc-138">Use the following syntax to create a rule to blocks messages that contain executable attachments:</span></span>

```powershell
New-TransportRule -Name "<UniqueName>" -AttachmentHasExecutableContent $true [-RejectMessageEnhancedStatusCode <5.7.1 | 5.7.900 to 5.7.999>] [-RejectMessageReasonText "<Text>"] [-DeleteMessage $true]
```

<span data-ttu-id="19fbc-139">**Remarques** :</span><span class="sxs-lookup"><span data-stu-id="19fbc-139">**Notes**:</span></span>

- <span data-ttu-id="19fbc-140">Si vous utilisez le paramètre _RejectMessageEnhancedStatusCode_ sans le paramètre _RejectMessageReasonText_ , le texte par défaut est : remise non autorisée, message refusé.</span><span class="sxs-lookup"><span data-stu-id="19fbc-140">If you use the _RejectMessageEnhancedStatusCode_ parameter without the _RejectMessageReasonText_ parameter, the default text is: Delivery not authorized, message refused.</span></span>

- <span data-ttu-id="19fbc-141">Si vous utilisez le paramètre _RejectMessageReasonText_ sans le paramètre _RejectMessageEnhancedStatusCode_ , le code par défaut est 5.7.1.</span><span class="sxs-lookup"><span data-stu-id="19fbc-141">If you use the _RejectMessageReasonText_ parameter without the _RejectMessageEnhancedStatusCode_ parameter, the default code is 5.7.1.</span></span>

<span data-ttu-id="19fbc-142">Cet exemple crée une règle nommée bloquer les pièces jointes exécutables qui supprime silencieusement les messages qui contiennent des pièces jointes exécutables.</span><span class="sxs-lookup"><span data-stu-id="19fbc-142">This example creates a new rule named Block Executable Attachments that silently deletes messages that contain executable attachments.</span></span>

```powershell
New-TransportRule -Name "Block Executable Attachments" -AttachmentHasExecutableContent $true -DeleteMessage $true
```

<span data-ttu-id="19fbc-143">Pour obtenir des informations détaillées sur la syntaxe et les paramètres, voir [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/new-transportrule).</span><span class="sxs-lookup"><span data-stu-id="19fbc-143">For detailed syntax and parameter information, see [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/new-transportrule).</span></span>

## <a name="how-do-you-know-this-worked"></a><span data-ttu-id="19fbc-144">Comment savoir si cela a fonctionné ?</span><span class="sxs-lookup"><span data-stu-id="19fbc-144">How do you know this worked?</span></span>

<span data-ttu-id="19fbc-145">Pour vérifier que vous avez bien créé une règle de flux de messagerie pour bloquer les messages qui contiennent des pièces jointes exécutables, effectuez l’une des opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="19fbc-145">To verify that you've successfully create a mail flow rule to block messages that contain executable attachments, do any of the following steps:</span></span>

- <span data-ttu-id="19fbc-146">Dans le centre d’administration Exchange, accédez à règles de **flux de messagerie** \> **Rules** \> Sélectionnez la règle \> , cliquez sur **modifier** ![ l’icône d’édition ](../../media/ITPro-EAC-EditIcon.png) et vérifiez les paramètres.</span><span class="sxs-lookup"><span data-stu-id="19fbc-146">In the EAC, go to **Mail flow** \> **Rules** \> select the rule \> click **Edit** ![Edit icon](../../media/ITPro-EAC-EditIcon.png), and verify the settings.</span></span>

- <span data-ttu-id="19fbc-147">Dans PowerShell, exécutez la commande suivante pour vérifier les paramètres :</span><span class="sxs-lookup"><span data-stu-id="19fbc-147">In PowerShell, run the following command to verify the settings:</span></span>

  ```powershell
  Get-TransportRule -Identity "<Rule Name>" | Format-List Name,AttachmentHasExecutableContent,RejectMessage*,DeleteMessage
  ```
