---
title: Utiliser des règles de flux de messagerie pour bloquer les messages avec des pièces jointes exécutables
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
localization_priority: Normal
ms.assetid: c4fb4a86-b772-49d0-8773-e8ee897e175d
ms.custom:
- seo-marvel-apr2020
description: Les administrateurs peuvent apprendre à créer des règles de flux de messagerie (règles de transport) pour bloquer les messages qui contiennent des pièces jointes exécutables.
ms.technology: mdo
ms.prod: m365-security
ms.openlocfilehash: 2145698f4268e592582024114216902fdab4c76d
ms.sourcegitcommit: a1846b1ee2e4fa397e39c1271c997fc4cf6d5619
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/09/2021
ms.locfileid: "50166890"
---
# <a name="use-mail-flow-rules-to-block-messages-with-executable-attachments-in-eop"></a><span data-ttu-id="ba846-103">Utiliser des règles de flux de courriers pour bloquer les messages avec des pièces jointes exécutables dans EOP</span><span class="sxs-lookup"><span data-stu-id="ba846-103">Use mail flow rules to block messages with executable attachments in EOP</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]

<span data-ttu-id="ba846-104">**S’applique à**</span><span class="sxs-lookup"><span data-stu-id="ba846-104">**Applies to**</span></span>
- [<span data-ttu-id="ba846-105">Exchange Online Protection</span><span class="sxs-lookup"><span data-stu-id="ba846-105">Exchange Online Protection</span></span>](https://go.microsoft.com/fwlink/?linkid=2148611)
- [<span data-ttu-id="ba846-106">Microsoft Defender pour Office 365 plan 1 et plan 2</span><span class="sxs-lookup"><span data-stu-id="ba846-106">Microsoft Defender for Office 365 plan 1 and plan 2</span></span>](https://go.microsoft.com/fwlink/?linkid=2148715)
- [<span data-ttu-id="ba846-107">Microsoft 365 Defender</span><span class="sxs-lookup"><span data-stu-id="ba846-107">Microsoft 365 Defender</span></span>](https://go.microsoft.com/fwlink/?linkid=2118804)

<span data-ttu-id="ba846-108">Dans les organisations Microsoft 365 avec des boîtes aux lettres dans Exchange Online ou des organisations Exchange Online Protection autonomes (EOP) sans boîtes aux lettres Exchange Online, EOP utilise des stratégies anti-programme malveillant pour bloquer les messages dangereux, y compris les messages avec des pièces jointes exécutables.</span><span class="sxs-lookup"><span data-stu-id="ba846-108">In Microsoft 365 organizations with mailboxes in Exchange Online or standalone Exchange Online Protection (EOP) organizations without Exchange Online mailboxes, EOP uses anti-malware policies to block harmful messages, including messages with executable attachments.</span></span> <span data-ttu-id="ba846-109">Pour plus d’informations, voir [Protection contre les programmes malveillants dans EOP.](anti-malware-protection.md)</span><span class="sxs-lookup"><span data-stu-id="ba846-109">For more information, see [Anti-malware protection in EOP](anti-malware-protection.md).</span></span>

<span data-ttu-id="ba846-110">Pour renforcer la protection, vous pouvez utiliser des règles de flux de messagerie (également appelées règles de transport) pour identifier et bloquer les messages qui contiennent des pièces jointes exécutables, comme décrit dans cet article.</span><span class="sxs-lookup"><span data-stu-id="ba846-110">To further enhance protection, you can use mail flow rules (also known as transport rules) to identify and block messages that contain executable attachments as described in this article.</span></span>

<span data-ttu-id="ba846-111">Par exemple, suite à une attaque de programmes malveillants, une société peut appliquer cette règle avec une limite de temps afin que les utilisateurs concernés peuvent revenir à l’envoi de pièces jointes après une durée spécifiée.</span><span class="sxs-lookup"><span data-stu-id="ba846-111">For example, following a malware outbreak, a company could apply this rule with a time limit so that affected users can get back to sending attachments after a specified length of time.</span></span>

## <a name="what-do-you-need-to-know-before-you-begin"></a><span data-ttu-id="ba846-112">Ce qu'il faut savoir avant de commencer</span><span class="sxs-lookup"><span data-stu-id="ba846-112">What do you need to know before you begin?</span></span>

- <span data-ttu-id="ba846-113">Des autorisations doivent vous être attribuées dans Exchange Online ou Exchange Online Protection avant de pouvoir suivre les procédures de cet article.</span><span class="sxs-lookup"><span data-stu-id="ba846-113">You need to be assigned permissions in Exchange Online or Exchange Online Protection before you can do the procedures in this article.</span></span> <span data-ttu-id="ba846-114">Plus précisément, vous avez besoin du rôle Règles de  **transport,**  qui est attribué aux groupes de rôles Gestion de l’organisation, Gestion de la conformité et Gestion des enregistrements par défaut.</span><span class="sxs-lookup"><span data-stu-id="ba846-114">Specifically, you need the **Transport Rules** role, which is assigned to the **Organization Management**, **Compliance Management**, and **Records Management** role groups by default.</span></span>

  <span data-ttu-id="ba846-115">Pour plus d’informations, voir les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="ba846-115">For more information, see the following topics:</span></span>

  - [<span data-ttu-id="ba846-116">Autorisations dans Exchange Online</span><span class="sxs-lookup"><span data-stu-id="ba846-116">Permissions in Exchange Online</span></span>](https://docs.microsoft.com/exchange/permissions-exo/permissions-exo)
  - [<span data-ttu-id="ba846-117">Autorisations dans EOP autonome</span><span class="sxs-lookup"><span data-stu-id="ba846-117">Permissions in standalone EOP</span></span>](feature-permissions-in-eop.md)
  - [<span data-ttu-id="ba846-118">Utiliser le EAC pour modifier la liste des membres dans les groupes de rôles</span><span class="sxs-lookup"><span data-stu-id="ba846-118">Use the EAC modify the list of members in role groups</span></span>](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups)

- <span data-ttu-id="ba846-119">Pour ouvrir le Centre d’administration Exchange (EAC) dans Exchange Online, consultez le [Centre d’administration Exchange dans Exchange Online.](https://docs.microsoft.com/Exchange/exchange-admin-center)</span><span class="sxs-lookup"><span data-stu-id="ba846-119">To open the EAC in Exchange Online, see [Exchange admin center in Exchange Online](https://docs.microsoft.com/Exchange/exchange-admin-center).</span></span> <span data-ttu-id="ba846-120">Pour ouvrir le CAE dans EOP autonome, consultez le Centre d’administration [Exchange dans EOP autonome.](exchange-admin-center-in-exchange-online-protection-eop.md)</span><span class="sxs-lookup"><span data-stu-id="ba846-120">To open the EAC in standalone EOP, see [Exchange admin center in standalone EOP](exchange-admin-center-in-exchange-online-protection-eop.md).</span></span>

- <span data-ttu-id="ba846-121">Pour vous connecter à Exchange Online PowerShell, voir [Connexion à Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell).</span><span class="sxs-lookup"><span data-stu-id="ba846-121">To connect to Exchange Online PowerShell, see [Connect to Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell).</span></span> <span data-ttu-id="ba846-122">Pour vous connecter à un service Exchange Online Protection PowerShell autonome, voir [Se connecter à Exchange Online Protection PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).</span><span class="sxs-lookup"><span data-stu-id="ba846-122">To connect to standalone EOP PowerShell, see [Connect to Exchange Online Protection PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).</span></span>

- <span data-ttu-id="ba846-123">Pour plus d’informations sur les règles de flux de messagerie dans Exchange Online et EOP autonome, consultez les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="ba846-123">For more information about mail flow rules in Exchange Online and standalone EOP, see the following topics:</span></span>

  - [<span data-ttu-id="ba846-124">Règles de flux de messagerie (règles de transport) dans Exchange Online</span><span class="sxs-lookup"><span data-stu-id="ba846-124">Mail flow rules (transport rules) in Exchange Online</span></span>](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rules)

  - [<span data-ttu-id="ba846-125">Conditions de règle de flux de messagerie et exceptions (prédicats) dans Exchange Online</span><span class="sxs-lookup"><span data-stu-id="ba846-125">Mail flow rule conditions and exceptions (predicates) in Exchange Online</span></span>](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions)

  - [<span data-ttu-id="ba846-126">Actions de règle de flux de courrier dans Exchange Online</span><span class="sxs-lookup"><span data-stu-id="ba846-126">Mail flow rule actions in Exchange Online</span></span>](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rule-actions)

## <a name="use-the-eac-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a><span data-ttu-id="ba846-127">Utiliser le EAC pour créer une règle qui bloque les messages avec des pièces jointes exécutables</span><span class="sxs-lookup"><span data-stu-id="ba846-127">Use the EAC to create a rule that blocks messages with executable attachments</span></span>

1. <span data-ttu-id="ba846-128">Dans le CAE, accédez à **Flux de messagerie** \> **Règles**.</span><span class="sxs-lookup"><span data-stu-id="ba846-128">In the EAC, go to **Mail flow** \> **Rules**.</span></span>

2. <span data-ttu-id="ba846-129">Cliquez **sur Ajouter** une icône ![ ](../../media/ITPro-EAC-AddIcon.png) Ajouter, puis **sélectionnez Créer une règle.**</span><span class="sxs-lookup"><span data-stu-id="ba846-129">Click **Add** ![Add icon](../../media/ITPro-EAC-AddIcon.png) and then select **Create a new rule**.</span></span>

3. <span data-ttu-id="ba846-130">Dans la page **Nouvelle règle** qui s'ouvre, configurez les paramètres suivants :</span><span class="sxs-lookup"><span data-stu-id="ba846-130">In the **New rule** page that opens, configure the following settings:</span></span>

   - <span data-ttu-id="ba846-131">**Nom**: entrez un nom unique et descriptif pour la règle.</span><span class="sxs-lookup"><span data-stu-id="ba846-131">**Name**: Enter a unique, descriptive name for the rule.</span></span>

   - <span data-ttu-id="ba846-132">Cliquez sur **Autres options**.</span><span class="sxs-lookup"><span data-stu-id="ba846-132">Click **More Options**.</span></span>

   - <span data-ttu-id="ba846-133">**Appliquez cette règle si**: Select **Any attachment** \> **has executable content**.</span><span class="sxs-lookup"><span data-stu-id="ba846-133">**Apply this rule if**: Select **Any attachment** \> **has executable content**.</span></span>

   - <span data-ttu-id="ba846-134">**Pour ce faire,** **sélectionnez Bloquer le message,** puis choisissez l’action de votre choix :</span><span class="sxs-lookup"><span data-stu-id="ba846-134">**Do the following**: Select **Block the message** and then choose the action you want:</span></span>

     - <span data-ttu-id="ba846-135">**rejeter** le message et inclure  une explication : dans la boîte de dialogue Spécifier la raison du rejet qui s’affiche, entrez le texte que vous souhaitez voir apparaître dans la rapport d’in remise (également appelé une rapport de non-remise ou de non-remise).</span><span class="sxs-lookup"><span data-stu-id="ba846-135">**reject the message and include an explanation**: In the **Specify reject reason** dialog that appears, enter the text you want to appear in the non-delivery report (also known as an NDR or bounce message).</span></span> <span data-ttu-id="ba846-136">Le code d’état étendu utilisé par défaut est 5.7.1.</span><span class="sxs-lookup"><span data-stu-id="ba846-136">The default enhanced status code that's used is 5.7.1.</span></span>

     - <span data-ttu-id="ba846-137">**rejeter le message** avec le code d’état amélioré de : Dans la boîte de dialogue Entrer le **code** d’état amélioré qui s’affiche, entrez le code d’état amélioré que vous souhaitez voir apparaître dans la NDR.</span><span class="sxs-lookup"><span data-stu-id="ba846-137">**reject the message with the enhanced status code of**:  In the **Enter enhanced status code** dialog that appears, enter the enhanced status code that you want to appear in the NDR.</span></span> <span data-ttu-id="ba846-138">Les valeurs valides sont 5.7.1 ou une valeur de 5.7.900 à 5.7.999.</span><span class="sxs-lookup"><span data-stu-id="ba846-138">Valid values are 5.7.1 or a value from 5.7.900 to 5.7.999.</span></span> <span data-ttu-id="ba846-139">Le texte de rejet par défaut est : Remise non autorisée, message refusé.</span><span class="sxs-lookup"><span data-stu-id="ba846-139">The default rejection text is: Delivery not authorized, message refused.</span></span>

     - <span data-ttu-id="ba846-140">**rejeter le message sans avertir personne**</span><span class="sxs-lookup"><span data-stu-id="ba846-140">**reject the message without notifying anyone**</span></span>

4. <span data-ttu-id="ba846-141">Lorsque vous avez terminé, cliquez sur **Enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="ba846-141">When you're finished, click **Save**.</span></span> <span data-ttu-id="ba846-142">Votre règle de blocage des pièces jointes est en vigueur.</span><span class="sxs-lookup"><span data-stu-id="ba846-142">Your attachment blocking rule is now in force.</span></span>

## <a name="use-powershell-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a><span data-ttu-id="ba846-143">Utiliser PowerShell pour créer une règle qui bloque les messages avec des pièces jointes exécutables</span><span class="sxs-lookup"><span data-stu-id="ba846-143">Use PowerShell to create a rule that blocks messages with executable attachments</span></span>

<span data-ttu-id="ba846-144">Utilisez la syntaxe suivante pour créer une règle pour bloquer les messages qui contiennent des pièces jointes exécutables :</span><span class="sxs-lookup"><span data-stu-id="ba846-144">Use the following syntax to create a rule to blocks messages that contain executable attachments:</span></span>

```powershell
New-TransportRule -Name "<UniqueName>" -AttachmentHasExecutableContent $true [-RejectMessageEnhancedStatusCode <5.7.1 | 5.7.900 to 5.7.999>] [-RejectMessageReasonText "<Text>"] [-DeleteMessage $true]
```

<span data-ttu-id="ba846-145">**Remarques** :</span><span class="sxs-lookup"><span data-stu-id="ba846-145">**Notes**:</span></span>

- <span data-ttu-id="ba846-146">Si vous utilisez le paramètre _RejectMessageEnhancedStatusCode_ sans le paramètre _RejectMessageReasonText,_ le texte par défaut est : Remise non autorisée, message refusé.</span><span class="sxs-lookup"><span data-stu-id="ba846-146">If you use the _RejectMessageEnhancedStatusCode_ parameter without the _RejectMessageReasonText_ parameter, the default text is: Delivery not authorized, message refused.</span></span>

- <span data-ttu-id="ba846-147">Si vous utilisez le paramètre _RejectMessageReasonText_ sans le paramètre _RejectMessageEnhancedStatusCode,_ le code par défaut est 5.7.1.</span><span class="sxs-lookup"><span data-stu-id="ba846-147">If you use the _RejectMessageReasonText_ parameter without the _RejectMessageEnhancedStatusCode_ parameter, the default code is 5.7.1.</span></span>

<span data-ttu-id="ba846-148">Cet exemple crée une règle nommée Bloquer les pièces jointes exécutables qui supprime silencieusement les messages qui contiennent des pièces jointes exécutables.</span><span class="sxs-lookup"><span data-stu-id="ba846-148">This example creates a new rule named Block Executable Attachments that silently deletes messages that contain executable attachments.</span></span>

```powershell
New-TransportRule -Name "Block Executable Attachments" -AttachmentHasExecutableContent $true -DeleteMessage $true
```

<span data-ttu-id="ba846-149">Pour obtenir des informations détaillées sur la syntaxe et les paramètres, voir [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/new-transportrule).</span><span class="sxs-lookup"><span data-stu-id="ba846-149">For detailed syntax and parameter information, see [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/new-transportrule).</span></span>

## <a name="how-do-you-know-this-worked"></a><span data-ttu-id="ba846-150">Comment savoir si cela a fonctionné ?</span><span class="sxs-lookup"><span data-stu-id="ba846-150">How do you know this worked?</span></span>

<span data-ttu-id="ba846-151">Pour vérifier que vous avez bien créé une règle de flux de messagerie pour bloquer les messages qui contiennent des pièces jointes exécutables, exécutez l’une des étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="ba846-151">To verify that you've successfully create a mail flow rule to block messages that contain executable attachments, do any of the following steps:</span></span>

- <span data-ttu-id="ba846-152">Dans le EAC, sélectionnez Règles de **flux** de messagerie et sélectionnez l’icône Modifier, puis \>  \> \> vérifiez les  ![ ](../../media/ITPro-EAC-EditIcon.png) paramètres.</span><span class="sxs-lookup"><span data-stu-id="ba846-152">In the EAC, go to **Mail flow** \> **Rules** \> select the rule \> click **Edit** ![Edit icon](../../media/ITPro-EAC-EditIcon.png), and verify the settings.</span></span>

- <span data-ttu-id="ba846-153">Dans PowerShell, exécutez la commande suivante pour vérifier les paramètres :</span><span class="sxs-lookup"><span data-stu-id="ba846-153">In PowerShell, run the following command to verify the settings:</span></span>

  ```powershell
  Get-TransportRule -Identity "<Rule Name>" | Format-List Name,AttachmentHasExecutableContent,RejectMessage*,DeleteMessage
  ```
