---
title: Utiliser des règles de flux de messagerie pour bloquer les messages avec des pièces jointes exécutables
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
localization_priority: Normal
ms.assetid: c4fb4a86-b772-49d0-8773-e8ee897e175d
ms.custom:
- seo-marvel-apr2020
description: Les administrateurs peuvent apprendre à créer des règles de flux de messagerie (règles de transport) pour bloquer les messages qui contiennent des pièces jointes exécutables.
ms.technology: mdo
ms.prod: m365-security
ms.openlocfilehash: 012557b2e0e34cdafd33c2d4a8291283dbd5e35c
ms.sourcegitcommit: dcb97fbfdae52960ae62b6faa707a05358193ed5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/25/2021
ms.locfileid: "51204728"
---
# <a name="use-mail-flow-rules-to-block-messages-with-executable-attachments-in-eop"></a>Utiliser des règles de flux de courriers pour bloquer les messages avec des pièces jointes exécutables dans EOP

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]

**S’applique à**
- [Exchange Online Protection](exchange-online-protection-overview.md)
- [Microsoft Defender pour Office 365 : offre 1 et offre 2](defender-for-office-365.md)
- [Microsoft 365 Defender](../defender/microsoft-365-defender.md)

Dans les organisations Microsoft 365 avec des boîtes aux lettres dans Exchange Online ou des organisations Exchange Online Protection autonomes (EOP) sans boîtes aux lettres Exchange Online, EOP utilise des stratégies anti-programme malveillant pour bloquer les messages dangereux, y compris les messages avec des pièces jointes exécutables. Pour plus d’informations, voir [Protection contre les programmes malveillants dans EOP.](anti-malware-protection.md)

Pour renforcer la protection, vous pouvez utiliser des règles de flux de messagerie (également appelées règles de transport) pour identifier et bloquer les messages qui contiennent des pièces jointes exécutables, comme décrit dans cet article.

Par exemple, suite à une attaque de programmes malveillants, une société peut appliquer cette règle avec une limite de temps afin que les utilisateurs concernés peuvent revenir à l’envoi de pièces jointes après une durée spécifiée.

## <a name="what-do-you-need-to-know-before-you-begin"></a>Ce qu'il faut savoir avant de commencer

- Des autorisations doivent vous être attribuées dans Exchange Online ou Exchange Online Protection avant de pouvoir suivre les procédures de cet article. Plus précisément, vous avez besoin du rôle Règles de  **transport,**  qui est attribué aux groupes de rôles Gestion de l’organisation, Gestion de la conformité et Gestion des enregistrements par défaut.

  Pour plus d’informations, voir les rubriques suivantes :

  - [Autorisations dans Exchange Online](/exchange/permissions-exo/permissions-exo)
  - [Autorisations dans EOP autonome](feature-permissions-in-eop.md)
  - [Utiliser le EAC pour modifier la liste des membres dans les groupes de rôles](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups)

- Pour ouvrir le Centre d’administration Exchange (EAC) dans Exchange Online, consultez le [Centre d’administration Exchange dans Exchange Online.](/Exchange/exchange-admin-center) Pour ouvrir le CAE dans EOP autonome, consultez le Centre [d’administration Exchange dans EOP autonome.](exchange-admin-center-in-exchange-online-protection-eop.md)

- Pour vous connecter à Exchange Online PowerShell, voir [Connexion à Exchange Online PowerShell](/powershell/exchange/connect-to-exchange-online-powershell). Pour vous connecter à un service Exchange Online Protection PowerShell autonome, voir [Se connecter à Exchange Online Protection PowerShell](/powershell/exchange/connect-to-exchange-online-protection-powershell).

- Pour plus d’informations sur les règles de flux de messagerie dans Exchange Online et EOP autonome, consultez les rubriques suivantes :

  - [Règles de flux de messagerie (règles de transport) dans Exchange Online](/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rules)

  - [Conditions de règle de flux de messagerie et exceptions (prédicats) dans Exchange Online](/Exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions)

  - [Actions de règle de flux de courrier dans Exchange Online](/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rule-actions)

## <a name="use-the-eac-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>Utiliser le EAC pour créer une règle qui bloque les messages avec des pièces jointes exécutables

1. Dans le CAE, accédez à **Flux de messagerie** \> **Règles**.

2. Cliquez **sur Ajouter** une icône ![ ](../../media/ITPro-EAC-AddIcon.png) Ajouter, puis **sélectionnez Créer une règle.**

3. Dans la page **Nouvelle règle** qui s'ouvre, configurez les paramètres suivants :

   - **Nom**: entrez un nom unique et descriptif pour la règle.

   - Cliquez sur **Autres options**.

   - **Appliquez cette règle si**: Select **Any attachment** \> **has executable content**.

   - **Pour ce faire,** **sélectionnez Bloquer le message,** puis choisissez l’action de votre choix :

     - **rejeter** le message et inclure  une explication : dans la boîte de dialogue Spécifier la raison du rejet qui s’affiche, entrez le texte que vous souhaitez voir apparaître dans la rapport d’in remise (également appelé une rapport de non-remise ou une non-remise). Le code d’état étendu utilisé par défaut est 5.7.1.

     - **rejeter le message** avec le code d’état amélioré de : Dans la boîte de dialogue Entrer le **code** d’état amélioré qui s’affiche, entrez le code d’état amélioré que vous souhaitez voir apparaître dans la NDR. Les valeurs valides sont 5.7.1 ou une valeur de 5.7.900 à 5.7.999. Le texte de rejet par défaut est : Remise non autorisée, message refusé.

     - **rejeter le message sans avertir personne**

4. Lorsque vous avez terminé, cliquez sur **Enregistrer**. Votre règle de blocage des pièces jointes est en vigueur.

## <a name="use-powershell-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>Utiliser PowerShell pour créer une règle qui bloque les messages avec des pièces jointes exécutables

Utilisez la syntaxe suivante pour créer une règle pour bloquer les messages qui contiennent des pièces jointes exécutables :

```powershell
New-TransportRule -Name "<UniqueName>" -AttachmentHasExecutableContent $true [-RejectMessageEnhancedStatusCode <5.7.1 | 5.7.900 to 5.7.999>] [-RejectMessageReasonText "<Text>"] [-DeleteMessage $true]
```

**Remarques** :

- Si vous utilisez le paramètre _RejectMessageEnhancedStatusCode_ sans le paramètre _RejectMessageReasonText,_ le texte par défaut est : Remise non autorisée, message refusé.

- Si vous utilisez le paramètre _RejectMessageReasonText_ sans le paramètre _RejectMessageEnhancedStatusCode,_ le code par défaut est 5.7.1.

Cet exemple crée une règle nommée Bloquer les pièces jointes exécutables qui supprime silencieusement les messages qui contiennent des pièces jointes exécutables.

```powershell
New-TransportRule -Name "Block Executable Attachments" -AttachmentHasExecutableContent $true -DeleteMessage $true
```

Pour obtenir des informations détaillées sur la syntaxe et les paramètres, voir [New-TransportRule](/powershell/module/exchange/new-transportrule).

## <a name="how-do-you-know-this-worked"></a>Comment savoir si cela a fonctionné ?

Pour vérifier que vous avez bien créé une règle de flux de messagerie pour bloquer les messages qui contiennent des pièces jointes exécutables, exécutez l’une des étapes suivantes :

- Dans le EAC, sélectionnez Règles de **flux** de messagerie et sélectionnez l’icône Modifier, puis \>  \> \> vérifiez les  ![ ](../../media/ITPro-EAC-EditIcon.png) paramètres.

- Dans PowerShell, exécutez la commande suivante pour vérifier les paramètres :

  ```powershell
  Get-TransportRule -Identity "<Rule Name>" | Format-List Name,AttachmentHasExecutableContent,RejectMessage*,DeleteMessage
  ```