---
title: Utiliser des règles de flux de messagerie pour bloquer les messages avec des pièces jointes exécutables
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
ms.assetid: c4fb4a86-b772-49d0-8773-e8ee897e175d
ms.custom:
- seo-marvel-apr2020
description: Les administrateurs peuvent apprendre à créer des règles de flux de messagerie (règles de transport) pour bloquer les messages qui contiennent des pièces jointes exécutables.
ms.openlocfilehash: 4f25af9dc6595201c98a9e89875772bc7192d9dc
ms.sourcegitcommit: 40ec697e27b6c9a78f2b679c6f5a8875dacde943
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/23/2020
ms.locfileid: "44350994"
---
# <a name="use-mail-flow-rules-to-block-messages-with-executable-attachments-in-eop"></a>Utiliser des règles de flux de courrier pour bloquer les messages avec des pièces jointes exécutables dans EOP

Dans les organisations Microsoft 365 avec des boîtes aux lettres dans Exchange Online ou des organisations Exchange Online Protection (EOP) autonomes sans boîte aux lettres Exchange Online, EOP utilise des stratégies de protection contre les programmes malveillants pour bloquer les messages nuisibles, y compris les messages avec pièces jointes exécutables. Pour plus d’informations, consultez la rubrique [protection contre les programmes malveillants dans EOP](anti-malware-protection.md).

Pour améliorer davantage la protection, vous pouvez utiliser des règles de flux de messagerie (également appelées règles de transport) pour identifier et bloquer les messages qui contiennent des pièces jointes exécutables, comme décrit dans cette rubrique.

Par exemple, après une attaque de programme malveillant, une société peut appliquer cette règle avec une limite de temps pour permettre aux utilisateurs concernés de revenir à l’envoi de pièces jointes après un laps de temps spécifié.

## <a name="what-do-you-need-to-know-before-you-begin"></a>Ce qu'il faut savoir avant de commencer

- Pour pouvoir effectuer ces procédures, vous devez disposer des autorisations suivantes :

  - Dans Exchange Online, consultez l’entrée « flux de messagerie » dans [autorisations des fonctionnalités dans Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/feature-permissions).
  
  - Dans EOP autonome, vous avez besoin du rôle de règles de transport, qui est affecté par défaut aux rôles OrganizationManagement, ComplianceManagement et RecordsManagement. Pour plus d’informations, consultez la rubrique [autorisations dans EOP autonome](feature-permissions-in-eop.md) et utiliser le centre d’administration Exchange pour [modifier la liste des membres dans les groupes de rôles](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups).

- Pour ouvrir le centre d’administration Exchange dans Exchange Online, consultez la rubrique [Exchange Admin Center in Exchange Online](https://docs.microsoft.com/Exchange/exchange-admin-center). Pour ouvrir le centre d’administration Exchange en mode autonome EOP, consultez la rubrique [Exchange Admin Center in standalone EOP](exchange-admin-center-in-exchange-online-protection-eop.md).

- Pour vous connecter à Exchange Online PowerShell, voir [Connexion à Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/connect-to-exchange-online-powershell). Pour vous connecter à un service Exchange Online Protection PowerShell autonome, voir [Se connecter à Exchange Online Protection PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-eop/connect-to-exchange-online-protection-powershell).

- Pour plus d’informations sur les règles de flux de messagerie dans Exchange Online et dans la version autonome d’EOP, consultez les rubriques suivantes :

  - [Règles de flux de messagerie (règles de transport) dans Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rules)

  - [Conditions de règle de flux de messagerie et exceptions (prédicats) dans Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions)

  - [Actions de règle de flux de messagerie dans Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rule-actions)

## <a name="use-the-eac-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>Utiliser le centre d’administration Exchange pour créer une règle qui bloque les messages avec des pièces jointes exécutables

1. Dans le CAE, accédez à **Flux de messagerie** \> **Règles**.

2. Cliquez sur **Ajouter** ![ une icône Ajouter ](../../media/ITPro-EAC-AddIcon.png) , puis sélectionnez **créer une nouvelle règle**.

3. Dans la page **Nouvelle règle** qui s'ouvre, configurez les paramètres suivants :

   - **Nom**: entrez un nom unique et descriptif pour la règle.

   - Cliquez sur **Autres options**.

   - **Appliquer cette règle si**: sélectionnez **une pièce jointe** \> **a un contenu exécutable**.

   - **Procédez comme suit**: sélectionnez **bloquer le message** , puis sélectionnez l’action souhaitée :

     - **rejeter le message et inclure une explication**: dans la boîte de dialogue **spécifier la raison du rejet** qui s’affiche, entrez le texte que vous souhaitez voir apparaître dans la notification d’échec de remise (également appelée notification de non-remise). Le code d’état étendu utilisé par défaut est 5.7.1.

     - **rejeter le message avec le code d’état étendu**: dans la boîte de dialogue **Entrez le code d’état étendu** qui s’affiche, entrez le code d’état étendu que vous souhaitez voir apparaître dans la notification d’état de remise. Les valeurs valides sont 5.7.1 ou une valeur comprise entre 5.7.900 et 5.7.999. Le texte de rejet par défaut est : remise non autorisée, message refusé.

     - **rejeter le message sans avertir personne**

4. Lorsque vous avez terminé, cliquez sur **Enregistrer**. Votre règle de blocage des pièces jointes est en vigueur.

## <a name="use-powershell-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>Utiliser PowerShell pour créer une règle qui bloque les messages avec des pièces jointes exécutables

Utilisez la syntaxe suivante pour créer une règle qui bloque les messages qui contiennent des pièces jointes exécutables :

```powershell
New-TransportRule -Name "<UniqueName>" -AttachmentHasExecutableContent $true [-RejectMessageEnhancedStatusCode <5.7.1 | 5.7.900 to 5.7.999>] [-RejectMessageReasonText "<Text>"] [-DeleteMessage $true]
```

**Remarques** :

- Si vous utilisez le paramètre _RejectMessageEnhancedStatusCode_ sans le paramètre _RejectMessageReasonText_ , le texte par défaut est : remise non autorisée, message refusé.

- Si vous utilisez le paramètre _RejectMessageReasonText_ sans le paramètre _RejectMessageEnhancedStatusCode_ , le code par défaut est 5.7.1.

Cet exemple crée une règle nommée bloquer les pièces jointes exécutables qui supprime silencieusement les messages qui contiennent des pièces jointes exécutables.

```powershell
New-TransportRule -Name "Block Executable Attachments" -AttachmentHasExecutableContent $true -DeleteMessage $true
```

Pour obtenir des informations détaillées sur la syntaxe et les paramètres, voir [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/new-transportrule).

## <a name="how-do-you-know-this-worked"></a>Comment savoir si cela a fonctionné ?

Pour vérifier que vous avez bien créé une règle de flux de messagerie pour bloquer les messages qui contiennent des pièces jointes exécutables, effectuez l’une des opérations suivantes :

- Dans le centre d’administration Exchange, accédez à règles de **flux de messagerie** \> **Rules** \> Sélectionnez la règle \> , cliquez sur **modifier** ![ l’icône d’édition ](../../media/ITPro-EAC-EditIcon.png) et vérifiez les paramètres.

- Dans PowerShell, exécutez la commande suivante pour vérifier les paramètres :

  ```powershell
  Get-TransportRule -Identity "<Rule Name>" | Format-List Name,AttachmentHasExecutableContent,RejectMessage*,DeleteMessage
  ```
