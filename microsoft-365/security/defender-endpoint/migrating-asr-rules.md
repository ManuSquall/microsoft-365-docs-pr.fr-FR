---
title: Migration d’un hips tiers vers des règles asr
description: Décrit comment aborder une migration d’une solution hips (Host Intrusion Prevention System) tierce vers des règles asr.
keywords: Règles de réduction de la surface d’attaque, règles asr, règles d’attaque, système de prévention des intrusions hôtes, règles de protection, anti-attaque, attaque, prévention des infections, Microsoft Defender pour point de terminaison, Microsoft Defender ATP
search.product: eADQiWindows 10XVcnh
ms.topic: article
ms.prod: m365-security
ms.mktglfcycl: manage
ms.sitesec: library
ms.pagetype: security
ms.localizationpriority: medium
audience: ITPro
author: lovina-saldanha
ms.author: v-lsaldanha
manager: dansimp
ms.custom: asr
ms.technology: mde
ms.openlocfilehash: ced969fdd3e8b63136f8bd3f043272e76d99bc5e
ms.sourcegitcommit: 7b8104015a76e02bc215e1cf08069979c70650ae
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/31/2021
ms.locfileid: "51476518"
---
# <a name="migrating-from-a-third-party-hips-to-asr-rules"></a>Migration d’un hips tiers vers des règles asr

Cet article vous aide à ma cartographier des règles communes à Microsoft Defender pour endpoint. Le tableau suivant présente les questions et scénarios courants lors de la migration d’un produit HIPS tiers vers des règles asr.

|Étendue et action|Processus|Opération|Exemples de fichiers/dossiers, clés/valeurs de Registre, processus, services|Règles de réduction de la surface d’attaque|Autres fonctionnalités recommandées|
|:--|:--|:--|:--|:--|:--|
|Tous les processus : bloquer la création de fichiers et de clés de Registre spécifiques||Création de fichiers|*.zepto, *.odin, *.locky, *.jaff, *.lukitus, *.wnry, *.krab|Les règles de la asr bloquent les techniques d’attaque et non les indicateurs de compromis (IOC). Le blocage d’une extension de fichier spécifique n’est pas toujours utile, car il n’empêche pas un appareil de compromettre. Elle ne déjoue que partiellement une attaque jusqu’à ce que les attaquants créent un nouveau type d’extension pour la charge utile.|Il est vivement recommandé d’activer l’Antivirus Microsoft Defender, ainsi que l’analyse du comportement et de la protection cloud. Nous vous recommandons d’utiliser d’autres préventions, telles que la règle asr « Utiliser une protection avancée contre les ransomware ». Cela offre un niveau de protection plus élevé contre les attaques par ransomware. En outre, plusieurs de ces clés de Registre sont surveillées par Microsoft Defender pour endpoint, telles que les techniques ASEP, qui déclenchent des alertes spécifiques. Les clés de Registre utilisées nécessitent un minimum de privilèges d’administrateur local ou de programme d’installation approuvé pour pouvoir être modifiées. L’utilisation d’un environnement verrouillé, avec des comptes ou des droits d’administration minimaux, est recommandée. D’autres configurations système peuvent être activées, notamment « Désactiver SeDebug pour les rôles non requis » qui font partie de nos recommandations de sécurité plus larges.|
|Tous les processus : bloquer la création de fichiers et de clés de Registre spécifiques||Modifications du Registre|*\Software \* ,HKCU\Environment\UserInitMprLogonScript,HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Accessibility\ATs \* \StartExe, HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options \* \Debugger,HKEY_CURRENT_USER\Software\Microsoft\HtmlHelp Author\location,HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit \* \MonitorProcessProcess|Les règles de la asr bloquent les techniques d’attaque et non les indicateurs de compromis (IOC). Le blocage d’une extension de fichier spécifique n’est pas toujours utile, car il n’empêche pas un appareil de compromettre. Elle ne déjoue que partiellement une attaque jusqu’à ce que les attaquants créent un nouveau type d’extension pour la charge utile.|Il est vivement recommandé d’activer l’Antivirus Microsoft Defender, ainsi que l’analyse du comportement et de la protection cloud. Nous vous recommandons d’utiliser une prévention supplémentaire, telle que la règle asr « Utiliser une protection avancée contre les ransomware ». Cela offre un niveau de protection plus élevé contre les attaques par ransomware. En outre, plusieurs de ces clés de Registre sont surveillées par Microsoft Defender pour endpoint, telles que les techniques ASEP, qui déclenchent des alertes spécifiques. De plus, les clés de Registre utilisées nécessitent un minimum de privilèges d’administrateur local ou de programme d’installation approuvé pour pouvoir être modifiées. L’utilisation d’un environnement verrouillé, avec des comptes ou des droits d’administration minimaux, est recommandée. D’autres configurations système peuvent être activées, notamment « Désactiver SeDebug pour les rôles non requis » qui font partie de nos recommandations de sécurité plus larges.|
|Programmes nontrus à partir du port USB : empêcher les programmes nontrus de s’exécutent à partir de lecteurs amovibles|*|Exécution de processus|*|Les règles asr ont une règle intégrée pour empêcher le lancement de programmes non signés et non signés à partir de lecteurs amovibles : « Bloquer les processus non signés et non signés qui s’exécutent à partir du port USB », GUID « b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4 ».|Découvrez d’autres contrôles pour les périphériques USB et autres supports amovibles à l’aide de Microsoft Defender pour le point de terminaison : découvrez comment contrôler les périphériques USB et autres supports amovibles à l’aide de Microsoft Defender pour le point de [terminaison.](https://docs.microsoft.com/windows/security/threat-protection/device-control/control-usb-devices-using-intune) |
|Mshta : empêcher Mshta de lancer certains processus enfants|mshta.exe|Exécution de processus|powershell.exe, cmd.exe, regsvr32.exe|Les règles asr ne contiennent aucune règle spécifique pour empêcher les processus enfants de « mshta.exe ». Ce contrôle est dans le cadre des missions d’Exploit Protection Windows Defender Application Control.|Activez Windows Defender contrôle d’application pour empêcher mshta.exe'exécution. Si votre organisation a besoin de « mshta.exe » pour les applications métier, configurez une règle Windows Defender Exploit Protection spécifique, afin d’empêcher mshta.exe de lancer des processus enfants.|
|Outlook : empêcher Outlook de lancer des processus enfants|outlook.exe|Exécution de processus|powershell.exe|Les règles asr ont une règle intégrée pour empêcher les applications de communication Office (Outlook, Skype et Teams) de lancer des processus enfants : « Empêcher l’application de communication Office de créer des processus enfants », GUID « 26190899-1602-49e8-8b27-eb1d0a1ce869 ».|Nous vous recommandons d’activer le mode de langue contrainte PowerShell, afin de réduire la surface d’attaque à partir de PowerShell.|
|Office : empêcher les applications Office de lancer des processus enfants et de créer du contenu exécutable|winword.exe, powerpnt.exe, excel.exe|Exécution de processus|powershell.exe, cmd.exe, wscript.exe, mshta.exe, EQNEDT32.EXE, regsrv32.exe|Les règles asr ont une règle intégrée pour empêcher les applications Office de lancer des processus enfants : « Empêcher toutes les applications Office de créer des processus enfants », GUID « D4F940AB-401B-4EFC-AADC-AD5F3C50688A ».|S/O|
|Office : empêcher les applications Office de lancer des processus enfants et de créer du contenu exécutable|winword.exe, powerpnt.exe, excel.exe|Création de fichiers|C:\Users \* \AppData \* *\* .exe, C:\ProgramData \** \* .exe, C:\ProgramData \* *\* .com, C:\Users \* \* AppData\Local\Temp* \* .com, C:\Users \* *\Downloads \** \* .exe, C:\Users \* \AppData \* *\* .scf, C:\ProgramData \** \* .scf, C:\Users\Public \* .exe, C:\Users \* \Desktop \* * \* .exe|S/O|
|Wscript : empêcher Wscript de lire certains types de fichiers|wscript.exe|Lecture de fichier|C:\Users \* \AppData \* *\* .js*, C:\Users \* \Downloads \* *\* .js*|En raison de problèmes de fiabilité et de performances, les règles DER n’ont pas la possibilité d’empêcher un processus spécifique de lire un certain type de fichier de script. Nous avons une règle pour empêcher les vecteurs d’attaque qui peuvent provenir de ces scénarios. Le nom de la règle est « Empêcher JavaScript ou VBScript de lancer le contenu exécutable téléchargé » (GUID " D3E037E1-3EB8-44C8-A917-5792794759 6D ») et « Bloquer l’exécution de scripts potentiellement obscurcis » (GUID " 5BEB7EFE-FD9A-4556-801D-275E5FFC04CC »)|Bien qu’il existe des règles asr spécifiques qui atténuent certains vecteurs d’attaque dans ces scénarios, il est important de mentionner que l’antivirus est en mesure par défaut d’inspecter les scripts (PowerShell, l’hôte de script Windows, JavaScript, VBScript, et bien plus encore) en temps réel, via l’interface AMSI (Antimalware Scan Interface). Plus d’informations sont disponibles ici : Interface d’analyse [anti-programme malveillant (AMSI).](https://docs.microsoft.com/windows/win32/amsi/antimalware-scan-interface-portal) |
|Adobe Acrobat : bloquer le lancement des processus enfants|AcroRd32.exe, Acrobat.exe|Exécution de processus|cmd.exe, powershell.exe, wscript.exe|Les règles de la asr permettent d’empêcher Adobe Reader de lancer des processus enfants. Le nom de la règle est « Empêcher Adobe Reader de créer des processus enfants », GUID « 7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c ».|S/O|
|CertUtil : bloquer le téléchargement ou la création de contenu exécutable|certutil.exe|Création de fichiers|*.exe|Les règles de la asr ne peuvent pas prendre en charge ces scénarios, car elles font partie de la protection de l’Antivirus Microsoft Defender.|L’Antivirus Microsoft Defender empêche CertUtil de créer ou de télécharger du contenu exécutable.|
|Tous les processus : empêcher les processus d’arrêter les composants système critiques|*|Arrêt du processus|MsSense.exe, MsMpEng.exe, NisSrv.exe, svchost.exe*, services.exe, csrss.exe, smss.exe, wininit.exe, etc.|Les règles asr ne sont pas en charge dans ces scénarios, car elles sont protégées par les protections de sécurité intégrées à Windows 10.|ELAM (logiciel anti-programme malveillant à lancement précoce), PPL (Protection Process Light), PPL AntiMalware Light et System Guard.|
|Processus spécifiques : bloquer une tentative de processus de lancement spécifique|« Nommez votre processus »|Exécution de processus|tor.exe, bittorrent.exe, cmd.exe, powershell.exe, etc.|Dans l’ensemble, les règles de asr ne sont pas conçues pour fonctionner en tant que gestionnaire d’applications.|Pour empêcher les utilisateurs de lancer des processus ou des programmes spécifiques, il est recommandé d’utiliser Windows Defender contrôle d’application. Les indicateurs Microsoft Defender for Endpoint File et Cert peuvent être utilisés dans un scénario de réponse aux incidents (ne doivent pas être considérés comme un mécanisme de contrôle d’application).|
|Tous les processus : bloquer les modifications non autorisées apportées aux configurations av MDATP|*|Modifications du Registre|HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiSpyware, HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Policy Manager\AllowRealTimeMonitoring, etc.|Les règles asr ne couvrent pas ces types de scénarios, car elles font partie de la protection intégrée de Microsoft Defender for Endpoint.|La protection contre la falsification (opt-in, gérée à partir d’Intune) empêche les modifications non autorisées apportées aux clés de Registre DisableAntiVirus, DisableAntiSpyware, DisableRealtimeMonitoring, DisableOnAccessProtection, DisableBehaviorMonitoring et DisableIOAVProtection (et bien plus encore). |



Voir aussi

- [FAQ sur la réduction de la surface d’attaque](attack-surface-reduction-faq.md).
- [Activer les règles de réduction de la surface d’attaque](enable-attack-surface-reduction.md)
- [Évaluer les règles de réduction de la surface d’attaque](evaluate-attack-surface-reduction.md)
