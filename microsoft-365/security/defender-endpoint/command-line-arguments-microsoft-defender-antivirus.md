---
title: Utiliser la ligne de commande pour gérer les Antivirus Microsoft Defender
description: Exécutez Antivirus Microsoft Defender analyse et configurez la protection nouvelle génération avec un utilitaire de ligne de commande dédié.
keywords: exécuter l’analyse windows defender, exécuter l’analyse antivirus à partir de la ligne de commande, exécuter l’analyse windows defender à partir de la ligne de commande, mpcmdrun, defender
search.product: eADQiWindows 10XVcnh
ms.prod: m365-security
ms.mktglfcycl: manage
ms.sitesec: library
localization_priority: Normal
author: denisebmsft
ms.author: deniseb
ms.custom: nextgen
ms.reviewer: ksarens
manager: dansimp
ms.date: 05/24/2021
ms.technology: mde
ms.topic: how-to
ms.openlocfilehash: efeb49b2741bdc45f7924032c2deb8a27458ca29
ms.sourcegitcommit: 4886457c0d4248407bddec56425dba50bb60d9c4
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/03/2021
ms.locfileid: "53289414"
---
# <a name="configure-and-manage-microsoft-defender-antivirus-with-the-mpcmdrunexe-command-line-tool"></a><span data-ttu-id="59af2-104">Configurer et gérer les Antivirus Microsoft Defender l’outil mpcmdrun.exe ligne de commande</span><span class="sxs-lookup"><span data-stu-id="59af2-104">Configure and manage Microsoft Defender Antivirus with the mpcmdrun.exe command-line tool</span></span>

<span data-ttu-id="59af2-105">**S’applique à :**</span><span class="sxs-lookup"><span data-stu-id="59af2-105">**Applies to:**</span></span>

- [<span data-ttu-id="59af2-106">Microsoft Defender pour point de terminaison</span><span class="sxs-lookup"><span data-stu-id="59af2-106">Microsoft Defender for Endpoint</span></span>](/microsoft-365/security/defender-endpoint/)

<span data-ttu-id="59af2-107">Vous pouvez effectuer différentes fonctions dans Antivirus Microsoft Defender à l’aide de l’outil en ligne de commande **dédiémpcmdrun.exe**.</span><span class="sxs-lookup"><span data-stu-id="59af2-107">You can perform various functions in Microsoft Defender Antivirus using the dedicated command-line tool **mpcmdrun.exe**.</span></span> <span data-ttu-id="59af2-108">Cet utilitaire est utile lorsque vous souhaitez automatiser Antivirus Microsoft Defender tâches.</span><span class="sxs-lookup"><span data-stu-id="59af2-108">This utility is useful when you want to automate Microsoft Defender Antivirus tasks.</span></span> <span data-ttu-id="59af2-109">Vous pouvez trouver l’utilitaire dans `%ProgramFiles%\Windows Defender\MpCmdRun.exe` .</span><span class="sxs-lookup"><span data-stu-id="59af2-109">You can find the utility in `%ProgramFiles%\Windows Defender\MpCmdRun.exe`.</span></span> <span data-ttu-id="59af2-110">Exécutez-le à partir d’une invite de commandes.</span><span class="sxs-lookup"><span data-stu-id="59af2-110">Run it from a command prompt.</span></span>

> [!TIP]
> <span data-ttu-id="59af2-111">Vous devrez peut-être ouvrir une version de niveau administrateur de l’invite de commandes.</span><span class="sxs-lookup"><span data-stu-id="59af2-111">You might need to open an administrator-level version of the command prompt.</span></span> <span data-ttu-id="59af2-112">Lorsque vous recherchez **l’invite de** commandes sur le menu Démarrer, choisissez **Exécuter en tant qu’administrateur.**</span><span class="sxs-lookup"><span data-stu-id="59af2-112">When you search for **Command Prompt** on the Start menu, choose **Run as administrator**.</span></span> <span data-ttu-id="59af2-113">Si vous exécutez une version mise à jour de la plateforme Microsoft Defender, exécutez-la à `MpCmdRun` partir de l’emplacement suivant : `C:\ProgramData\Microsoft\Windows Defender\Platform\<antimalware platform version>`</span><span class="sxs-lookup"><span data-stu-id="59af2-113">If you're running an updated Microsoft Defender Platform version, run `MpCmdRun` from the following location: `C:\ProgramData\Microsoft\Windows Defender\Platform\<antimalware platform version>`.</span></span> <span data-ttu-id="59af2-114">Pour plus d’informations sur la plateforme anti-programme malveillant, voir Antivirus Microsoft Defender mises à jour [et les lignes de base.](manage-updates-baselines-microsoft-defender-antivirus.md)</span><span class="sxs-lookup"><span data-stu-id="59af2-114">For more information about the antimalware platform, see [Microsoft Defender Antivirus updates and baselines](manage-updates-baselines-microsoft-defender-antivirus.md).</span></span>

<span data-ttu-id="59af2-115">L’utilitaire MpCmdRun utilise la syntaxe suivante :</span><span class="sxs-lookup"><span data-stu-id="59af2-115">The MpCmdRun utility uses the following syntax:</span></span>

```console
MpCmdRun.exe [command] [-options]
```

<span data-ttu-id="59af2-116">Voici un exemple :</span><span class="sxs-lookup"><span data-stu-id="59af2-116">Here's an example:</span></span>

```console
MpCmdRun.exe -Scan -ScanType 2
``` 

<span data-ttu-id="59af2-117">Dans notre exemple, l’utilitaire MpCmdRun démarre une analyse antivirus complète sur l’appareil.</span><span class="sxs-lookup"><span data-stu-id="59af2-117">In our example, the MpCmdRun utility starts a full antivirus scan on the device.</span></span>

## <a name="commands"></a><span data-ttu-id="59af2-118">Commandes</span><span class="sxs-lookup"><span data-stu-id="59af2-118">Commands</span></span>

| <span data-ttu-id="59af2-119">Command</span><span class="sxs-lookup"><span data-stu-id="59af2-119">Command</span></span>  | <span data-ttu-id="59af2-120">Description</span><span class="sxs-lookup"><span data-stu-id="59af2-120">Description</span></span>   |
|:----|:----|
| <span data-ttu-id="59af2-121">`-?` **ou** `-h`</span><span class="sxs-lookup"><span data-stu-id="59af2-121">`-?` **or** `-h`</span></span>   | <span data-ttu-id="59af2-122">Affiche toutes les options disponibles pour l’outil MpCmdRun</span><span class="sxs-lookup"><span data-stu-id="59af2-122">Displays all available options for the MpCmdRun tool</span></span> |
| `-Scan [-ScanType [<value>]] [-File <path> [-DisableRemediation] [-BootSectorScan] [-CpuThrottling]] [-Timeout <days>] [-Cancel]` | <span data-ttu-id="59af2-123">Recherche les logiciels malveillants.</span><span class="sxs-lookup"><span data-stu-id="59af2-123">Scans for malicious software.</span></span> <span data-ttu-id="59af2-124">Les valeurs **de ScanType** sont :</span><span class="sxs-lookup"><span data-stu-id="59af2-124">Values for **ScanType** are:</span></span><p><span data-ttu-id="59af2-125">**0 Par** défaut, en fonction de votre configuration</span><span class="sxs-lookup"><span data-stu-id="59af2-125">**0** Default, according to your configuration</span></span><p><span data-ttu-id="59af2-126">**1 Analyse** rapide</span><span class="sxs-lookup"><span data-stu-id="59af2-126">**1** Quick scan</span></span><p><span data-ttu-id="59af2-127">**2 Analyse** complète</span><span class="sxs-lookup"><span data-stu-id="59af2-127">**2** Full scan</span></span><p><span data-ttu-id="59af2-128">**3 Analyse** personnalisée de fichier et d’annuaire.</span><span class="sxs-lookup"><span data-stu-id="59af2-128">**3** File and directory custom scan.</span></span><p><span data-ttu-id="59af2-129">CpuThrottling s’exécute en fonction des configurations de stratégie</span><span class="sxs-lookup"><span data-stu-id="59af2-129">CpuThrottling runs according to policy configurations</span></span> |
| `-Trace [-Grouping #] [-Level #]` | <span data-ttu-id="59af2-130">Démarre le suivi des diagnostics</span><span class="sxs-lookup"><span data-stu-id="59af2-130">Starts diagnostic tracing</span></span> |
| `-GetFiles [-SupportLogLocation <path>]` | <span data-ttu-id="59af2-131">Collecte des informations de support.</span><span class="sxs-lookup"><span data-stu-id="59af2-131">Collects support information.</span></span> <span data-ttu-id="59af2-132">Voir «[Collecte des données de diagnostic](collect-diagnostic-data.md)»</span><span class="sxs-lookup"><span data-stu-id="59af2-132">See '[collecting diagnostic data](collect-diagnostic-data.md)'</span></span>  |
| `-GetFilesDiagTrack`  | <span data-ttu-id="59af2-133">Identique à `-GetFiles` , mais sorties dans le dossier DiagTrack temporaire</span><span class="sxs-lookup"><span data-stu-id="59af2-133">Same as `-GetFiles`, but outputs to temporary DiagTrack folder</span></span> |
| `-RemoveDefinitions [-All]` | <span data-ttu-id="59af2-134">Restaure l’intelligence de sécurité installée sur une copie de sauvegarde précédente ou sur l’ensemble par défaut d’origine</span><span class="sxs-lookup"><span data-stu-id="59af2-134">Restores the installed Security intelligence to a previous backup copy or to the original default set</span></span> |
| `-RemoveDefinitions [-DynamicSignatures]` | <span data-ttu-id="59af2-135">Supprime uniquement l’intelligence de sécurité téléchargée dynamiquement</span><span class="sxs-lookup"><span data-stu-id="59af2-135">Removes only the dynamically downloaded Security intelligence</span></span> |
| `-RemoveDefinitions [-Engine]` | <span data-ttu-id="59af2-136">Restaure le moteur installé précédent</span><span class="sxs-lookup"><span data-stu-id="59af2-136">Restores the previous installed engine</span></span> |
| `-SignatureUpdate [-UNC \| -MMPC]` | <span data-ttu-id="59af2-137">Recherche les nouvelles mises à jour de l’intelligence de la sécurité</span><span class="sxs-lookup"><span data-stu-id="59af2-137">Checks for new Security intelligence updates</span></span> |
| `-Restore  [-ListAll \| [[-Name <name>] [-All] \| [-FilePath <filePath>]] [-Path <path>]]` | <span data-ttu-id="59af2-138">Restaure ou répertorie les éléments mis en quarantaine</span><span class="sxs-lookup"><span data-stu-id="59af2-138">Restores or lists quarantined item(s)</span></span> |
| `-AddDynamicSignature [-Path]` | <span data-ttu-id="59af2-139">Charge l’intelligence de sécurité dynamique</span><span class="sxs-lookup"><span data-stu-id="59af2-139">Loads dynamic Security intelligence</span></span> |
| `-ListAllDynamicSignatures` | <span data-ttu-id="59af2-140">Répertorie l’intelligence de sécurité dynamique chargée</span><span class="sxs-lookup"><span data-stu-id="59af2-140">Lists the loaded dynamic Security intelligence</span></span> |
| `-RemoveDynamicSignature [-SignatureSetID]` | <span data-ttu-id="59af2-141">Supprime l’intelligence de sécurité dynamique</span><span class="sxs-lookup"><span data-stu-id="59af2-141">Removes dynamic Security intelligence</span></span> |
| `-CheckExclusion -path <path>` | <span data-ttu-id="59af2-142">Vérifie si un chemin d’accès est exclu</span><span class="sxs-lookup"><span data-stu-id="59af2-142">Checks whether a path is excluded</span></span> |
| `-ValidateMapsConnection` | <span data-ttu-id="59af2-143">Vérifie que votre réseau peut communiquer avec le service Antivirus Microsoft Defender cloud.</span><span class="sxs-lookup"><span data-stu-id="59af2-143">Verifies that your network can communicate with the Microsoft Defender Antivirus cloud service.</span></span> <span data-ttu-id="59af2-144">Cette commande ne fonctionne que sur Windows 10 version 1703 ou supérieure.</span><span class="sxs-lookup"><span data-stu-id="59af2-144">This command will only work on Windows 10, version 1703 or higher.</span></span>|

## <a name="common-errors-in-running-commands-via-mpcmdrunexe"></a><span data-ttu-id="59af2-145">Erreurs courantes lors de l’exécution de commandes via mpcmdrun.exe</span><span class="sxs-lookup"><span data-stu-id="59af2-145">Common errors in running commands via mpcmdrun.exe</span></span> 

<span data-ttu-id="59af2-146">Le tableau suivant répertorie les erreurs courantes qui peuvent se produire lors de l’utilisation de l’outil MpCmdRun.</span><span class="sxs-lookup"><span data-stu-id="59af2-146">The following table lists common errors that can occur while using the MpCmdRun tool.</span></span>

|<span data-ttu-id="59af2-147">Message d’erreur</span><span class="sxs-lookup"><span data-stu-id="59af2-147">Error message</span></span> | <span data-ttu-id="59af2-148">Raison possible</span><span class="sxs-lookup"><span data-stu-id="59af2-148">Possible reason</span></span> |
|:----|:----|
| <span data-ttu-id="59af2-149">**ValidateMapsConnection a échoué (800106BA)** **ou 0x800106BA**</span><span class="sxs-lookup"><span data-stu-id="59af2-149">**ValidateMapsConnection failed (800106BA)** or **0x800106BA**</span></span> | <span data-ttu-id="59af2-150">Le service Antivirus Microsoft Defender est désactivé.</span><span class="sxs-lookup"><span data-stu-id="59af2-150">The Microsoft Defender Antivirus service is disabled.</span></span> <span data-ttu-id="59af2-151">Activez le service et essayez à nouveau.</span><span class="sxs-lookup"><span data-stu-id="59af2-151">Enable the service and try again.</span></span> <span data-ttu-id="59af2-152">Si vous avez besoin d’aide pour réactiver Antivirus Microsoft Defender, voir [Réinstaller/activer Antivirus Microsoft Defender sur vos points de terminaison.](switch-to-microsoft-defender-setup.md#reinstallenable-microsoft-defender-antivirus-on-your-endpoints)</span><span class="sxs-lookup"><span data-stu-id="59af2-152">If you need help re-enabling Microsoft Defender Antivirus, see [Reinstall/enable Microsoft Defender Antivirus on your endpoints](switch-to-microsoft-defender-setup.md#reinstallenable-microsoft-defender-antivirus-on-your-endpoints).</span></span><p> <span data-ttu-id="59af2-153">**CONSEIL**: dans Windows 10 1909 ou plus, et Windows Server 2019 ou plus ancien, le service était auparavant appelé *Antivirus Windows Defender*.</span><span class="sxs-lookup"><span data-stu-id="59af2-153">**TIP**: In Windows 10 1909 or older, and Windows Server 2019 or older, the service was formerly called *Windows Defender Antivirus*.</span></span> |
| <span data-ttu-id="59af2-154">**0x80070667**</span><span class="sxs-lookup"><span data-stu-id="59af2-154">**0x80070667**</span></span> | <span data-ttu-id="59af2-155">Vous exécutez la commande à partir d’un ordinateur qui Windows 10 version 1607 ou antérieure, ou qui `-ValidateMapsConnection` Windows Server 2016 ou une version antérieure.</span><span class="sxs-lookup"><span data-stu-id="59af2-155">You're running the `-ValidateMapsConnection` command from a computer that is Windows 10 version 1607 or older, or Windows Server 2016 or older.</span></span> <span data-ttu-id="59af2-156">Exécutez la commande à partir d’un ordinateur Windows 10 version 1703 ou plus récente, ou Windows Server 2019 ou version plus récente.</span><span class="sxs-lookup"><span data-stu-id="59af2-156">Run the command from a machine that is Windows 10 version 1703 or newer, or Windows Server 2019 or newer.</span></span>|
| <span data-ttu-id="59af2-157">**MpCmdRun n’est pas reconnu comme une commande interne ou externe, un programme opérable ou un fichier de commandes.**</span><span class="sxs-lookup"><span data-stu-id="59af2-157">**MpCmdRun is not recognized as an internal or external command, operable program, or batch file.**</span></span> | <span data-ttu-id="59af2-158">L’outil doit être exécuté à partir de l’un ou de l’autre (où il peut être différent puisque les mises à jour de plateforme `%ProgramFiles%\Windows Defender` `C:\ProgramData\Microsoft\Windows Defender\Platform\4.18.2012.4-0` sont `2012.4-0` mensuelles à l’exception de mars)</span><span class="sxs-lookup"><span data-stu-id="59af2-158">The tool must be run from either `%ProgramFiles%\Windows Defender` or `C:\ProgramData\Microsoft\Windows Defender\Platform\4.18.2012.4-0` (where `2012.4-0` might differ since platform updates are monthly except for March)</span></span>|
| <span data-ttu-id="59af2-159">**ValidateMapsConnection n’a pas pu établir de connexion à MAPS (hr=80070005 httpcode=450)**</span><span class="sxs-lookup"><span data-stu-id="59af2-159">**ValidateMapsConnection failed to establish a connection to MAPS (hr=80070005 httpcode=450)**</span></span> | <span data-ttu-id="59af2-160">La commande a été tentée à l’aide de privilèges insuffisants.</span><span class="sxs-lookup"><span data-stu-id="59af2-160">The command was attempted using insufficient privileges.</span></span> <span data-ttu-id="59af2-161">Utilisez l’invite de commandes (cmd.exe) en tant qu’administrateur.</span><span class="sxs-lookup"><span data-stu-id="59af2-161">Use the command prompt (cmd.exe) as an administrator.</span></span>|
| <span data-ttu-id="59af2-162">**ValidateMapsConnection n’a pas pu établir de connexion à MAPS (hr=80070006 httpcode=451)**</span><span class="sxs-lookup"><span data-stu-id="59af2-162">**ValidateMapsConnection failed to establish a connection to MAPS (hr=80070006 httpcode=451)**</span></span> | <span data-ttu-id="59af2-163">Le pare-feu bloque la connexion ou effectue une inspection SSL.</span><span class="sxs-lookup"><span data-stu-id="59af2-163">The firewall is blocking the connection or conducting SSL inspection.</span></span> |
| <span data-ttu-id="59af2-164">**ValidateMapsConnection n’a pas pu établir de connexion à MAPS (hr=80004005 httpcode=450)**</span><span class="sxs-lookup"><span data-stu-id="59af2-164">**ValidateMapsConnection failed to establish a connection to MAPS (hr=80004005 httpcode=450)**</span></span> | <span data-ttu-id="59af2-165">Problèmes éventuels liés au réseau, tels que les problèmes de résolution de noms</span><span class="sxs-lookup"><span data-stu-id="59af2-165">Possible network-related issues, like name resolution problems</span></span>|
| <span data-ttu-id="59af2-166">**ValidateMapsConnection n’a pas pu établir de connexion à MAPS (hr=0x80508015**</span><span class="sxs-lookup"><span data-stu-id="59af2-166">**ValidateMapsConnection failed to establish a connection to MAPS (hr=0x80508015**</span></span> | <span data-ttu-id="59af2-167">Le pare-feu bloque la connexion ou effectue une inspection SSL.</span><span class="sxs-lookup"><span data-stu-id="59af2-167">The firewall is blocking the connection or conducting SSL inspection.</span></span> |
| <span data-ttu-id="59af2-168">**ValidateMapsConnection n’a pas pu établir de connexion à MAPS (hr=800722F0D**</span><span class="sxs-lookup"><span data-stu-id="59af2-168">**ValidateMapsConnection failed to establish a connection to MAPS (hr=800722F0D**</span></span> | <span data-ttu-id="59af2-169">Le pare-feu bloque la connexion ou effectue une inspection SSL.</span><span class="sxs-lookup"><span data-stu-id="59af2-169">The firewall is blocking the connection or conducting SSL inspection.</span></span> |
| <span data-ttu-id="59af2-170">**ValidateMapsConnection n’a pas pu établir de connexion à MAPS (hr=80072EE7 httpcode=451)**</span><span class="sxs-lookup"><span data-stu-id="59af2-170">**ValidateMapsConnection failed to establish a connection to MAPS (hr=80072EE7 httpcode=451)**</span></span> | <span data-ttu-id="59af2-171">Le pare-feu bloque la connexion ou effectue une inspection SSL.</span><span class="sxs-lookup"><span data-stu-id="59af2-171">The firewall is blocking the connection or conducting SSL inspection.</span></span> |

## <a name="see-also"></a><span data-ttu-id="59af2-172">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="59af2-172">See also</span></span>

- [<span data-ttu-id="59af2-173">Configurer les fonctionnalités antivirus Microsoft Defender</span><span class="sxs-lookup"><span data-stu-id="59af2-173">Configure Microsoft Defender Antivirus features</span></span>](configure-microsoft-defender-antivirus-features.md)
- [<span data-ttu-id="59af2-174">Configurer et valider les connexions réseau à un antivirus Microsoft Defender</span><span class="sxs-lookup"><span data-stu-id="59af2-174">Configure and validate Microsoft Defender Antivirus network connections</span></span>](configure-network-connections-microsoft-defender-antivirus.md)
- [<span data-ttu-id="59af2-175">Rubriques de référence pour les outils de gestion et de configuration</span><span class="sxs-lookup"><span data-stu-id="59af2-175">Reference topics for management and configuration tools</span></span>](configuration-management-reference-microsoft-defender-antivirus.md)
