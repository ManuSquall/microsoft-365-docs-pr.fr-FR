---
title: Isolation du client dans Microsoft 365 Search
ms.author: robmazz
author: robmazz
manager: laurawi
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.collection:
- Strat_O365_IP
- M365-security-compliance
f1.keywords:
- NOCSH
description: Dans cet article, trouvez une explication du fonctionnement de l’isolation des clients pour séparer les données client dans Microsoft 365 recherche.
ms.custom: seo-marvel-apr2020
ms.openlocfilehash: 3416afdeceaa7000b516ec89b4a2a1e59d8708d0
ms.sourcegitcommit: c029834c8a914b4e072de847fc4c3a3dde7790c5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/02/2020
ms.locfileid: "47332399"
---
# <a name="tenant-isolation-in-microsoft-365-search"></a><span data-ttu-id="bafbe-103">Isolation du client dans Microsoft 365 Search</span><span class="sxs-lookup"><span data-stu-id="bafbe-103">Tenant Isolation in Microsoft 365 Search</span></span>

<span data-ttu-id="bafbe-104">SharePoint La recherche en ligne utilise un modèle de séparation des clients qui équilibre l’efficacité des structures de données partagées avec la protection contre la fuite d’informations entre les clients.</span><span class="sxs-lookup"><span data-stu-id="bafbe-104">SharePoint Online search uses a tenant separation model that balances the efficiency of shared data structures with protection against information leaking between tenants.</span></span> <span data-ttu-id="bafbe-105">Avec ce modèle, nous empêchons les fonctionnalités de recherche de :</span><span class="sxs-lookup"><span data-stu-id="bafbe-105">With this model, we prevent the Search features from:</span></span>

- <span data-ttu-id="bafbe-106">Renvoi des résultats de requête qui contiennent des documents provenant d’autres locataires</span><span class="sxs-lookup"><span data-stu-id="bafbe-106">Returning query results that contain documents from other tenants</span></span>
- <span data-ttu-id="bafbe-107">Exposition d’informations suffisantes dans les résultats de requête qu’un utilisateur compétent peut déduire des informations sur d’autres locataires</span><span class="sxs-lookup"><span data-stu-id="bafbe-107">Exposing sufficient information in query results that a skilled user could infer information about other tenants</span></span>
- <span data-ttu-id="bafbe-108">Affichage du schéma ou des paramètres d’un autre client</span><span class="sxs-lookup"><span data-stu-id="bafbe-108">Showing schema or settings from another tenant</span></span>
- <span data-ttu-id="bafbe-109">La combinaison d’informations de traitement de l’analyse entre les clients ou le magasin entraîne la mauvaise relation client</span><span class="sxs-lookup"><span data-stu-id="bafbe-109">Mixing analytics processing information between tenants or store results in the wrong tenant</span></span>
- <span data-ttu-id="bafbe-110">Utilisation d’entrées de dictionnaire d’un autre client</span><span class="sxs-lookup"><span data-stu-id="bafbe-110">Using dictionary entries from another tenant</span></span>

<span data-ttu-id="bafbe-111">Pour chaque type de données client, nous utilisons une ou plusieurs couches de protection dans le code pour éviter toute fuite accidentelle d’informations.</span><span class="sxs-lookup"><span data-stu-id="bafbe-111">For each type of tenant data, we use one or more layers of protection in the code to prevent accidental leaking of information.</span></span> <span data-ttu-id="bafbe-112">Les données les plus critiques disposent du plus grand nombre de couches de protection pour s’assurer qu’un seul défaut ne se produit pas de fuite d’informations réelle ou perçue.</span><span class="sxs-lookup"><span data-stu-id="bafbe-112">The most critical data has the most layers of protection to make sure that a single defect doesn't result in actual or perceived information leakage.</span></span>

## <a name="tenant-separation-for-the-search-index"></a><span data-ttu-id="bafbe-113">Séparation des locataires pour l’index de recherche</span><span class="sxs-lookup"><span data-stu-id="bafbe-113">Tenant Separation for the Search Index</span></span>

<span data-ttu-id="bafbe-114">L’index de recherche est stocké sur disque sur les serveurs hébergeant les composants d’index et les clients partagent les fichiers d’index.</span><span class="sxs-lookup"><span data-stu-id="bafbe-114">The search index is stored on disk in the servers hosting the index components and the tenants share the index files.</span></span> <span data-ttu-id="bafbe-115">Les documents indexés d’un client sont visibles uniquement pour les requêtes de ce client.</span><span class="sxs-lookup"><span data-stu-id="bafbe-115">A tenant's indexed documents are visible only for queries for that tenant.</span></span> <span data-ttu-id="bafbe-116">Trois mécanismes indépendants empêchent la fuite d’informations :</span><span class="sxs-lookup"><span data-stu-id="bafbe-116">Three independent mechanisms prevent information leakage:</span></span>

- <span data-ttu-id="bafbe-117">Filtrage des ID de client</span><span class="sxs-lookup"><span data-stu-id="bafbe-117">Tenant ID filtering</span></span>
- <span data-ttu-id="bafbe-118">Préfixe de terme d’ID de client</span><span class="sxs-lookup"><span data-stu-id="bafbe-118">Tenant ID term prefixing</span></span>
- <span data-ttu-id="bafbe-119">Vérifications ACL</span><span class="sxs-lookup"><span data-stu-id="bafbe-119">ACL checks</span></span>

<span data-ttu-id="bafbe-120">Les trois mécanismes doivent échouer pour que la recherche retourne des documents au mauvais client.</span><span class="sxs-lookup"><span data-stu-id="bafbe-120">All three mechanisms would have to fail for Search to return documents to the wrong tenant.</span></span>

## <a name="tenant-id-filtering-and-tenant-id-term-prefixing"></a><span data-ttu-id="bafbe-121">Filtrage des ID de client et préfixe des termes de l’ID de locataire</span><span class="sxs-lookup"><span data-stu-id="bafbe-121">Tenant ID Filtering and Tenant ID Term Prefixing</span></span>

<span data-ttu-id="bafbe-122">La recherche préfixe chaque terme indexé dans l’index de texte intégral avec l’ID client.</span><span class="sxs-lookup"><span data-stu-id="bafbe-122">Search prefixes every term that is indexed in the full-text index with the tenant ID.</span></span> <span data-ttu-id="bafbe-123">Par exemple, lorsque le terme «*foo*» est indexé pour un client dont l’ID est «*123*», l’entrée dans l’index de texte intégral est «*123foo.*»</span><span class="sxs-lookup"><span data-stu-id="bafbe-123">For example, when the term "*foo*" is indexed for a tenant with an ID of "*123*", the entry in the full-text index is "*123foo.*"</span></span>

<span data-ttu-id="bafbe-124">Chaque requête est convertie pour inclure l’ID de client à l’aide d’un processus appelé filtrage d’ID de client.</span><span class="sxs-lookup"><span data-stu-id="bafbe-124">Every query is converted to include the tenant ID using a process called tenant ID filtering.</span></span> <span data-ttu-id="bafbe-125">Par exemple, la requête « foo » est *convertie* en « <*guid*>. *foo* AND *tenantID*:<*guid*> », où <*guid*> représente le client qui exécute la requête.</span><span class="sxs-lookup"><span data-stu-id="bafbe-125">For example, the query "*foo*" is converted to "<*guid*>.*foo* AND *tenantID*:<*guid*>", where <*guid*> represents the tenant performing the query.</span></span> <span data-ttu-id="bafbe-126">Cette conversion de requête se produit dans chaque nœud d’index et ni la requête ni le traitement du contenu ne peuvent l’influencer.</span><span class="sxs-lookup"><span data-stu-id="bafbe-126">This query conversion occurs within each index node and neither query nor content processing can influence it.</span></span> <span data-ttu-id="bafbe-127">Étant donné que l’ID de client est ajouté à chaque requête, la fréquence d’un terme dans d’autres locataires ne peut pas être déduite en regardant le meilleur classement des correspondances dans un client.</span><span class="sxs-lookup"><span data-stu-id="bafbe-127">Because the tenant ID is added to every query, the frequency of a term in other tenants can't be inferred by looking at best match ranking in one tenant.</span></span>

<span data-ttu-id="bafbe-128">Le préfixe de terme de l’ID client se produit uniquement dans l’index de texte intégral.</span><span class="sxs-lookup"><span data-stu-id="bafbe-128">Tenant ID term prefixing occurs only in the full-text index.</span></span> <span data-ttu-id="bafbe-129">Les recherches sur le terrain, telles que «*title:foo*», sont dans un index de recherche synthétique dans lequel les termes ne sont pas précédés de l’ID de locataire.</span><span class="sxs-lookup"><span data-stu-id="bafbe-129">Fielded searches, such as "*title:foo*", go to a synthetic search index where terms aren't prefixed by tenant ID.</span></span> <span data-ttu-id="bafbe-130">Au lieu de cela, les recherches dans les champs sont précédées du nom du champ.</span><span class="sxs-lookup"><span data-stu-id="bafbe-130">Instead, fielded searches are prefixed with the field name.</span></span> <span data-ttu-id="bafbe-131">Par exemple, la requête «*title:foo*» est convertie en «*fields.title:foo AND fields.tenantID*:<*guid*> ».</span><span class="sxs-lookup"><span data-stu-id="bafbe-131">For example, the query "*title:foo*" is converted to "*fields.title:foo AND fields.tenantID*:<*guid*>."</span></span> <span data-ttu-id="bafbe-132">Étant donné que la fréquence d’un terme n’influence pas le classement des occurrences dans l’index de recherche synthétique, il n’est pas nécessaire de séparer le client par préfixe de termes.</span><span class="sxs-lookup"><span data-stu-id="bafbe-132">Because the frequency of a term doesn't influence ranking of hits in the synthetic search index, there's no need for tenant separation by term prefixing.</span></span> <span data-ttu-id="bafbe-133">Pour une recherche sur le champ telle que «*title:foo*», la séparation du contenu du client dépend du filtrage de l’ID client par conversion de requête.</span><span class="sxs-lookup"><span data-stu-id="bafbe-133">For a fielded search like "*title:foo*", tenant content separation depends on tenant ID filtering by query conversion.</span></span>

## <a name="document-access-control-list-checks"></a><span data-ttu-id="bafbe-134">Vérifications des listes de contrôle d’accès aux documents</span><span class="sxs-lookup"><span data-stu-id="bafbe-134">Document Access Control List Checks</span></span>

<span data-ttu-id="bafbe-135">La recherche contrôle l’accès aux documents via des ACA enregistrées dans l’index de recherche.</span><span class="sxs-lookup"><span data-stu-id="bafbe-135">Search controls access to documents through ACLs that are saved in the search index.</span></span> <span data-ttu-id="bafbe-136">Chaque élément est indexé avec un ensemble de termes dans un champ ACL spécial.</span><span class="sxs-lookup"><span data-stu-id="bafbe-136">Every item is indexed with a set of terms in a special ACL field.</span></span> <span data-ttu-id="bafbe-137">Le champ ACL contient un terme par groupe ou utilisateur qui peut afficher le document.</span><span class="sxs-lookup"><span data-stu-id="bafbe-137">The ACL field contains one term per group or user that can view the document.</span></span> <span data-ttu-id="bafbe-138">Chaque requête est complétée par une liste de termes ACE (Access Control Entry), un pour chaque groupe auquel appartient l’utilisateur authentifié.</span><span class="sxs-lookup"><span data-stu-id="bafbe-138">Every query is augmented with a list of access control entry (ACE) terms, one for each group to which the authenticated user belongs.</span></span>

<span data-ttu-id="bafbe-139">Par exemple, une requête telle que « <*guid*>. *foo AND tenantID*:<*guid*> » devient : « <*guid*>. *foo AND tenantID*:<*guid* >  *AND* (*docACL:* < *ace1* >  *OR docACL*:<*ace2* >  *OR docACL*:<*ace3* >  *...*) »</span><span class="sxs-lookup"><span data-stu-id="bafbe-139">For example, a query like "<*guid*>.*foo AND tenantID*:<*guid*>" becomes: "<*guid*>.*foo AND tenantID*:<*guid*> *AND* (*docACL:*<*ace1*> *OR docACL*:<*ace2*> *OR docACL*:<*ace3*> *...*)"</span></span>

<span data-ttu-id="bafbe-140">Étant donné que les identificateurs d’utilisateur et de groupe et donc les entrées de contrôle d’accès sont uniques, cela offre un niveau de sécurité supplémentaire entre les clients pour les documents qui ne sont visibles que par certains utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="bafbe-140">Because user and group identifiers and hence ACEs are unique, this provides an extra level of security between tenants for documents that are only visible to some users.</span></span> <span data-ttu-id="bafbe-141">Il en va de même pour l’ace spéciale « Tout le monde sauf les utilisateurs externes » qui accorde l’accès aux utilisateurs réguliers dans le client.</span><span class="sxs-lookup"><span data-stu-id="bafbe-141">The same is the case for the special "Everyone except external users" ACE that grants access to regular users in the tenant.</span></span> <span data-ttu-id="bafbe-142">Toutefois, étant donné que les ace pour « Tout le monde » sont identiques pour tous les locataires, la séparation des locataires pour les documents publics dépend du filtrage des ID de client.</span><span class="sxs-lookup"><span data-stu-id="bafbe-142">But since ACEs for "Everyone" are the same for all tenants, tenant separation for public documents depends on tenant ID filtering.</span></span> <span data-ttu-id="bafbe-143">Les aces de refus sont également pris en charge.</span><span class="sxs-lookup"><span data-stu-id="bafbe-143">Deny ACEs are also supported.</span></span> <span data-ttu-id="bafbe-144">L’augmentation de requête ajoute une clause qui supprime un document du résultat lorsqu’il existe une correspondance avec une ace de refus.</span><span class="sxs-lookup"><span data-stu-id="bafbe-144">The query augmentation adds a clause that removes a document from the result when there is a match with a deny ACE.</span></span>

<span data-ttu-id="bafbe-145">Dans Exchange Online recherche, l’index est partitionn sur l’ID de boîte aux lettres des boîtes aux lettres d’un utilisateur individuel au lieu de l’ID de client (ID d’abonnement) comme dans SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="bafbe-145">In Exchange Online search, the index is partitioned on mailbox ID for individual user's mailboxes instead of tenant ID (subscription ID) as in SharePoint Online.</span></span> <span data-ttu-id="bafbe-146">Le mécanisme de partitionnement est identique à SharePoint Online, mais il n’existe pas de filtrage ACL.</span><span class="sxs-lookup"><span data-stu-id="bafbe-146">The partitioning mechanism is the same as SharePoint Online, but there is no ACL filtering.</span></span>
